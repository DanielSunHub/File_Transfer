prompt,response
昨天的销售额是多少？, SELECT sum(sales_amt)  as '销售额'FROM vw_dwd_fact_store_order_detail WHERE business_date = curdate() - interval 1 day
5月9号的销售额是多少？,select sum(sales_amt)  as '销售额' from vw_dwd_fact_store_order_detail where  business_date='2024-05-09'  
华南区昨天的销售额是多少？,"SELECT sum(sales_amt)  as '销售额'FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_store AS dsON od.store_id = ds.store_idWHERE business_date=date_sub(current_date(),1) and ds.area_name='华南区'"
深圳XXX路店昨天的销售额是多少？,"SELECT sum(sales_amt)  as '销售额'FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_store AS dsON od.store_id = ds.store_idWHERE business_date=date_sub(current_date(),1) and ds.store_name='深圳XXX路店'"
深圳XXX路店婴儿用品品类昨天的销售额是多少？,"SELECT sum(od.sales_amt)  as '销售额'FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_store AS dsON od.store_id = ds.store_idJOIN vw_dwd_dim_item AS diON od.item_id = di.item_idWHERE od.business_date=date_sub(current_date(),1) and ds.store_name='深圳XXX路店' and di.category_name_level1='婴儿用品'"
上个月的销售额是多少？," SELECT sum(sales_amt)  as '销售额'FROM vw_dwd_fact_store_order_detail WHERE year(business_date)=year(date_sub(curdate(), interval 1 month)) and month(business_date)=month(date_sub(curdate(), interval 1 month))"
上个月每个区域的销售额分别是多少？,"SELECT ds.area_name  as '区域名称', sum(od.sales_amt)  as '销售额'FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_store AS dsON od.store_id = ds.store_idWHERE year(business_date)=year(date_sub(curdate(), interval 1 month)) and month(business_date)=month(date_sub(curdate(), interval 1 month))GROUP BY ds.area_name"
3月每个区域的销售额分别是多少？,"SELECT ds.area_name  as '区域名称', sum(od.sales_amt)  as '销售额'FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_store AS dsON od.store_id = ds.store_idWHERE year(business_date)=2024 and month(business_date)=3GROUP BY ds.area_name"
3月份每天的销售额如何？,"SELECT business_date  as '销售日期' , sum(sales_amt)  as '销售额'FROM vw_dwd_fact_store_order_detailWHERE year(business_date)=2024 and month(business_date)=3GROUP BY business_dateORDER BY business_date"
上个月每天的销售额如何？,"SELECT business_date  as '销售日期' , sum(sales_amt)  as '销售额'FROM vw_dwd_fact_store_order_detailWHERE year(business_date)=year(date_sub(curdate(), interval 1 month)) and month(business_date)=month(date_sub(curdate(), interval 1 month))GROUP BY business_dateORDER BY business_date"
华南区3月份每天的销售额如何？,"SELECT od.business_date  as '销售日期' , sum(od.sales_amt)  as '销售额'FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_store AS dsON od.store_id = ds.store_idWHERE ds.area_name='华南区' and year(od.business_date)=2024 and month(od.business_date)=3GROUP BY od.business_dateORDER BY od.business_date"
深圳XXX路店3月份每天的销售额如何？,"SELECT od.business_date  as '销售日期' , sum(od.sales_amt)  as '销售额'FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_store AS dsON od.store_id = ds.store_idWHERE ds.store_name='深圳XXX路店' and year(od.business_date)=2024 and month(od.business_date)=3GROUP BY od.business_dateORDER BY od.business_date"
深圳XXX路店婴儿用品品类3月份每天的销售额如何？,"SELECT od.business_date  as '销售日期' , sum(od.sales_amt)  as '销售额'FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_store AS dsON od.store_id = ds.store_idJOIN vw_dwd_dim_item AS diON od.item_id = di.item_idWHERE ds.store_name='深圳XXX路店' and di.category_name_level1='婴儿用品' and year(od.business_date)=2024 and month(od.business_date)=3GROUP BY od.business_dateORDER BY od.business_date"
本季度到目前为止，深圳XXX路店和广州XXX路店各自的销售额是多少？,"SELECT ds.store_name  as '门店名称' , sum(od.sales_amt)  as '销售额'FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_store AS dsON od.store_id = ds.store_idWHERE ds.store_name in ('深圳XXX路店', '广州XXX路店') and year(od.business_date)=year(now()) and quarter(od.business_date)=quarter(now())GROUP BY ds.store_name"
去年，婴儿用品品类的销售额是多少？,SELECT sum(od.sales_amt)  as '销售额'FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS diON od.item_id = di.item_idWHERE di.category_name_level1='婴儿用品' and year(od.business_date)=2023
去年，华南区婴儿用品品类的销售额是多少？,SELECT sum(od.sales_amt)   as '销售额'FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS diON od.item_id = di.item_idJOIN vw_dwd_dim_store AS ds ON od.store_id = ds.store_idWHERE di.category_name_level1='婴儿用品' and ds.area_name='华南区' and year(od.business_date)=2023
去年，深圳XXX路店婴儿用品品类的销售额是多少？,SELECT sum(od.sales_amt)   as '销售额'FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS diON od.item_id = di.item_idJOIN vw_dwd_dim_store AS ds ON od.store_id = ds.store_idWHERE di.category_name_level1='婴儿用品' and ds.store_name='深圳XXX路店' and year(od.business_date)=2023
今年到目前为止，销售额最高的5个商品是什么，它们各自的销售额是多少？,"SELECT di.item_name  as '商品名称' , sum(od.sales_amt)   as '销售额'FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS diON od.item_id = di.item_idWHERE year(od.business_date)=2024GROUP BY di.item_nameORDER BY sum(od.sales_amt) DESCLIMIT 5"
今年到目前为止，婴儿用品品类销售额最高的5个商品是什么，它们各自的销售额是多少？,"SELECT di.item_name  as '商品名称' , sum(od.sales_amt)  as '销售额'FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS diON od.item_id = di.item_idWHERE di.category_name_level1='婴儿用品' and year(od.business_date)=2024GROUP BY di.item_nameORDER BY sum(od.sales_amt) DESCLIMIT 5"
今年到目前为止，华南区销售额最高的5个商品是什么，它们各自的销售额是多少？,"SELECT di.item_name  as '商品名称' , sum(od.sales_amt)   as '销售额'FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS diON od.item_id = di.item_idJOIN vw_dwd_dim_store AS ds ON od.store_id = ds.store_idWHERE ds.area_name='华南区' and year(od.business_date)=2024GROUP BY di.item_nameORDER BY sum(od.sales_amt) DESCLIMIT 5"
今年到目前为止，深圳XXX路店销售额最高的5个商品是什么，它们各自的销售额是多少？,"SELECT di.item_name  as '商品名称' , sum(od.sales_amt)   as '销售额'FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS diON od.item_id = di.item_idJOIN vw_dwd_dim_store AS ds ON od.store_id = ds.store_idWHERE ds.store_name='深圳XXX路店' and year(od.business_date)=2024GROUP BY di.item_nameORDER BY sum(od.sales_amt) DESCLIMIT 5"
今年到目前为止，深圳XXX路店婴儿用品品类销售额最高的5个商品是什么，它们各自的销售额是多少？,"SELECT di.item_name  as '商品名称' , sum(od.sales_amt)  as '销售额'FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS diON od.item_id = di.item_idJOIN vw_dwd_dim_store AS dsON od.store_id = ds.store_idWHERE di.category_name_level1='婴儿用品' and ds.store_name='深圳XXX路店' and year(od.business_date)=2024GROUP BY di.item_nameORDER BY sum(od.sales_amt) DESCLIMIT 5"
上周，线上渠道的总销售额是多少？,"SELECT sum(a.sales_amt)   as '销售额'FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as b on a.channel_id = b.channel_idWHERE year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week))and b.channel_name = '线上'"
上周，华南区线上渠道的总销售额是多少？,"SELECT sum(a.sales_amt)   as '销售额'FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as b on a.channel_id = b.channel_idJOIN vw_dwd_dim_store as c on a.store_id = c.store_idWHERE year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week))    and b.channel_name = '线上'    and c.area_name = '华南区'"
上周，深圳XXX路店线上渠道的总销售额是多少？,"SELECT sum(a.sales_amt)   as '销售额'FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as b on a.channel_id = b.channel_idJOIN vw_dwd_dim_store as c on a.store_id = c.store_idWHERE year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week))    and b.channel_name = '线上'    and c.store_name = '深圳XXX路店'"
上周，深圳XXX路店饮料品类线上渠道的总销售额是多少？,"SELECT sum(a.sales_amt)   as '销售额'FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as b on a.channel_id = b.channel_idJOIN vw_dwd_dim_store as c on a.store_id = c.store_idJOIN vw_dwd_dim_item as d on a.item_id = d.item_idWHERE  year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week))    and b.channel_name = '线上'    and c.store_name = '深圳XXX路店'    and d.category_name_level1 = '饮料'"
上个月各区域各品类的销售额是多少？,"SELECT ds.area_name  as '区域名称', di.category_name_level1  as '大类名称' , sum(od.sales_amt)   as '销售额'FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS diON od.item_id = di.item_idJOIN vw_dwd_dim_store AS ds ON od.store_id = ds.store_idWHERE year(od.business_date)=year(date_sub(curdate(), interval 1 month)) and month(od.business_date)=month(date_sub(curdate(), interval 1 month))GROUP BY ds.area_name, di.category_name_level1"
上个月各品类各区域的销售额是多少？,"SELECT di.category_name_level1  as '大类名称' , ds.area_name  as '区域名称', sum(od.sales_amt)   as '销售额'FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS diON od.item_id = di.item_idJOIN vw_dwd_dim_store AS ds ON od.store_id = ds.store_idWHERE year(od.business_date)=year(date_sub(curdate(), interval 1 month)) and month(od.business_date)=month(date_sub(curdate(), interval 1 month))GROUP BY di.category_name_level1, ds.area_name"
上个月华南区各门店各品类的销售额是多少？,"SELECT ds.store_name  as '门店名称' , di.category_name_level1  as '大类名称' , sum(od.sales_amt)   as '销售额'FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS diON od.item_id = di.item_idJOIN vw_dwd_dim_store AS ds ON od.store_id = ds.store_idWHERE ds.area_name='华南区' and year(od.business_date)=year(date_sub(curdate(), interval 1 month)) and month(od.business_date)=month(date_sub(curdate(), interval 1 month))GROUP BY ds.store_name, di.category_name_level1"
在上个月，工作日的平均销售额是多少？,"SELECT avg(sum_sales_amt)  as '平均销售额'FROM (  SELECT business_date, sum(sales_amt) as sum_sales_amt  FROM vw_dwd_fact_store_order_detail   WHERE year(business_date)=year(date_sub(curdate(), interval 1 month)) and month(business_date)=month(date_sub(curdate(), interval 1 month)) and dayofweek(business_date) between 2 and 6  GROUP BY business_date) as t"
今年的总计划销售额是多少？,SELECT SUM(budget_sale_amt)  as '计划销售额' FROM vw_dwd_fact_store_budget WHERE year_id=year(CURDATE())
这个月的计划销售额是多少？,"SELECT SUM(budget_sale_amt)  as '计划销售额' FROM vw_dwd_fact_store_budget WHERE year_id=year(CURDATE()) AND month_id=date_format(CURDATE(), '%Y%m') "
这个月华南区的计划销售额是多少？,"SELECT SUM(budget.budget_sale_amt)   as '计划销售额'FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE year_id=year(CURDATE()) AND month_id=date_format(CURDATE(), '%Y%m') AND store.area_name='华南区'"
这个月婴儿用品品类的计划销售额是多少？,"SELECT SUM(budget.budget_sale_amt)   as '计划销售额'FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_id WHERE year_id=year(CURDATE()) AND month_id=date_format(CURDATE(), '%Y%m') AND category.category_name='婴儿用品'"
这个月各个区域的计划销售额是多少？,"SELECT store.area_name  as '区域名称', SUM(budget.budget_sale_amt)   as '计划销售额'FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE year_id=year(CURDATE()) AND month_id=date_format(CURDATE(), '%Y%m')GROUP BY store.area_nameORDER BY '计划销售额'"
这个月各个品类的计划销售额是多少？,"SELECT category.category_name  as '大类名称' , SUM(budget.budget_sale_amt)   as '计划销售额'FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_id WHERE year_id=year(CURDATE()) AND month_id=date_format(CURDATE(), '%Y%m')GROUP BY category.category_name"
上个月销售额达成率,"SELECT SUM(sale_amt)/SUM(budget_sale_amt) *100  as '销售额达成率'  FROM vw_dwd_fact_store_budget WHERE year_id=year(CURDATE()) AND month_id=date_format(CURDATE(), '%Y%m')"
华南区上个月销售额达成率,"SELECT SUM(budget.sale_amt)/SUM(budget.budget_sale_amt)*100   as '销售额达成率' FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=year(CURDATE()) AND budget.month_id=date_format(CURDATE(), '%Y%m') AND store.area_name='华南区'"
婴儿用品品类上个月销售额达成率,"SELECT SUM(budget.sale_amt)/SUM(budget.budget_sale_amt)*100   as '销售额达成率' FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_id WHERE budget.year_id=year(CURDATE()) AND budget.month_id=date_format(CURDATE(), '%Y%m') AND category.category_name='婴儿用品'"
深圳XXX路店上个月销售额达成率,"SELECT SUM(budget.sale_amt)/SUM(budget.budget_sale_amt) *100  as '销售额达成率' FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=year(CURDATE()) AND budget.month_id=date_format(CURDATE(), '%Y%m') AND store.store_name = '深圳XXX路店'"
深圳XXX路店婴儿用品品类上个月销售额达成率,"SELECT SUM(budget.sale_amt)/SUM(budget.budget_sale_amt)*100   as '销售额达成率'  FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_id JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=year(CURDATE()) AND budget.month_id=date_format(CURDATE(), '%Y%m') AND category.category_name='婴儿用品' AND store.store_name='深圳XXX路店'"
上个月各区域各品类的销售额达成率是多少？,"SELECT store.area_name  as '区域名称' , category.category_name  as '大类名称' , SUM(budget.sale_amt)/SUM(budget.budget_sale_amt) *100  as '销售额达成率' FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_id JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=year(date_sub(curdate(), interval 1 month)) AND budget.month_id=date_format(date_sub(curdate(), interval 1 month), '%Y%m') GROUP BY store.area_name, category.category_nameORDER BY '销售额达成率' DESC"
与上个月相比，本月份的销售额达成率有何变化？,"SELECT  t1.achievement_rate*100 as '本月销售额达成率',t2.achievement_rate*100  as '上个月销售额达成率',(t1.achievement_rate-t2.achievement_rate) as '差额'FROM(SELECT     SUM(budget.sale_amt)/SUM(budget.budget_sale_amt) AS achievement_rateFROM vw_dwd_fact_store_budget budgetWHERE budget.year_id=year(CURDATE()) AND budget.month_id=date_format(CURDATE(), '%Y%m'))t1,(SELECT     SUM(budget.sale_amt)/SUM(budget.budget_sale_amt) AS achievement_rateFROM vw_dwd_fact_store_budget budgetWHERE budget.year_id=year(date_sub(curdate(), interval 1 month)) AND budget.month_id=date_format(date_sub(curdate(), interval 1 month), '%Y%m'))t2"
与上个月相比，婴儿用品品类本月份的销售额达成率有何变化？,"SELECT     t1.achievement_rate*100 as '本月销售额达成率',t2.achievement_rate*100  as '上个月销售额达成率',(t1.achievement_rate-t2.achievement_rate) as '差额'FROM(SELECT     SUM(budget.sale_amt)/SUM(budget.budget_sale_amt) AS achievement_rateFROM vw_dwd_fact_store_budget budgetJOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_idWHERE budget.year_id=year(CURDATE()) AND budget.month_id=date_format(CURDATE(), '%Y%m') AND category.category_name='婴儿用品')t1,(SELECT     SUM(budget.sale_amt)/SUM(budget.budget_sale_amt) AS achievement_rateFROM vw_dwd_fact_store_budget budgetJOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_idWHERE budget.year_id=year(date_sub(curdate(), interval 1 month)) AND budget.month_id=date_format(date_sub(curdate(), interval 1 month), '%Y%m') AND category.category_name='婴儿用品')t2"
与上个月相比，华南区本月份的销售额达成率有何变化？,"SELECT     t1.achievement_rate*100 as '本月销售额达成率',t2.achievement_rate*100  as '上个月销售额达成率',(t1.achievement_rate-t2.achievement_rate) as '差额'FROM(SELECT     SUM(budget.sale_amt)/SUM(budget.budget_sale_amt) AS achievement_rateFROM vw_dwd_fact_store_budget budgetJOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_idWHERE budget.year_id=year(CURDATE()) AND budget.month_id=date_format(CURDATE(), '%Y%m') AND store.area_name = '华南区')t1,(SELECT     SUM(budget.sale_amt)/SUM(budget.budget_sale_amt) AS achievement_rateFROM vw_dwd_fact_store_budget budgetJOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_idWHERE budget.year_id=year(date_sub(curdate(), interval 1 month)) AND budget.month_id=date_format(date_sub(curdate(), interval 1 month), '%Y%m') AND store.area_name = '华南区')t2"
与上个月相比，深圳XXX路店本月份的销售额达成率有何变化？,"SELECT     t1.achievement_rate*100 as '本月销售额达成率',t2.achievement_rate*100  as '上个月销售额达成率',(t1.achievement_rate-t2.achievement_rate) as '差额'FROM(SELECT     SUM(budget.sale_amt)/SUM(budget.budget_sale_amt) AS achievement_rateFROM vw_dwd_fact_store_budget budgetJOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_idWHERE budget.year_id=year(CURDATE()) AND budget.month_id=date_format(CURDATE(), '%Y%m') AND store.store_name='深圳XXX路店')t1,(SELECT     SUM(budget.sale_amt)/SUM(budget.budget_sale_amt) AS achievement_rateFROM vw_dwd_fact_store_budget budgetJOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_idWHERE budget.year_id=year(date_sub(curdate(), interval 1 month)) AND budget.month_id=date_format(date_sub(curdate(), interval 1 month), '%Y%m') AND store.store_name='深圳XXX路店')t2"
与上个月相比，深圳XXX路店婴儿用品品类本月份的销售额达成率有何变化？,"SELECT     t1.achievement_rate*100 as '本月销售额达成率',t2.achievement_rate*100  as '上个月销售额达成率',(t1.achievement_rate-t2.achievement_rate) as '差额'FROM(SELECT     SUM(budget.sale_amt)/SUM(budget.budget_sale_amt) AS achievement_rateFROM vw_dwd_fact_store_budget budgetJOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_idJOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_idWHERE budget.year_id=year(CURDATE()) AND budget.month_id=date_format(CURDATE(), '%Y%m') AND category.category_name='婴儿用品' AND store.store_name='深圳XXX路店')t1,(SELECT     SUM(budget.sale_amt)/SUM(budget.budget_sale_amt) AS achievement_rateFROM vw_dwd_fact_store_budget budgetJOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_idJOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_idWHERE budget.year_id=year(date_sub(curdate(), interval 1 month)) AND budget.month_id=date_format(date_sub(curdate(), interval 1 month), '%Y%m') AND category.category_name='婴儿用品' AND store.store_name='深圳XXX路店')t2"
上个月，哪些区域的销售额达成率表现最佳？,"SELECT store.area_name  as '区域名称' , SUM(budget.sale_amt)/SUM(budget.budget_sale_amt) *100  as '销售额达成率' FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=year(date_sub(curdate(), interval 1 month)) AND budget.month_id=date_format(date_sub(curdate(), interval 1 month), '%Y%m')GROUP BY store.area_nameORDER BY '销售额达成率' DESCLIMIT 10"
今年至今，哪些门店的销售额达成率最差？,"SELECT store.store_name  as '门店名称' , SUM(budget.sale_amt)/SUM(budget.budget_sale_amt) *100  as '销售额达成率' FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=year(CURDATE())GROUP BY store.store_nameORDER BY '销售额达成率' ascLIMIT 10"
今年至今，华南区哪些门店的销售额达成率最差？,"SELECT store.store_name  as '门店名称' , SUM(budget.sale_amt)/SUM(budget.budget_sale_amt) *100 as '销售额达成率' FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=year(CURDATE()) AND area_name = '华南区'GROUP BY store.store_nameORDER BY '销售额达成率' ascLIMIT 10"
上个月，在所有门店中，北京XXX路店的销售额达成率排第几名？,"SELECT sale_achievement_rate_rank  as '销售达成率排名' FROM (SELECT store.store_name, SUM(sale_amt)/SUM(budget_sale_amt)  AS sale_achievement_rate,ROW_NUMBER() OVER (ORDER BY SUM(sale_amt)/SUM(budget_sale_amt) DESC) AS sale_achievement_rate_rankFROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND budget.month_id=date_format(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m')GROUP BY store.store_name ) t1 WHERE t1.store_name='北京XXX路店'"
上个月，在华南区所有门店中，深圳XXX路店的销售额达成率排第几名？,"SELECT sale_achievement_rate_rank  as '销售达成率排名' FROM (SELECT store.store_name, SUM(sale_amt)/SUM(budget_sale_amt)  AS sale_achievement_rate,ROW_NUMBER() OVER (ORDER BY SUM(sale_amt)/SUM(budget_sale_amt) DESC) AS sale_achievement_rate_rankFROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND budget.month_id=date_format(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m') AND store.area_name='华南区'GROUP BY store.store_name ) t1 WHERE t1.store_name='深圳XXX路店'"
上个月，哪个品类的销售额达成率最高？,"SELECT category.category_name  as '大类名称' , IFNULL(SUM(sale_amt)/SUM(budget_sale_amt),0) *100   as '销售额达成率' FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_idWHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND budget.month_id=date_format(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m') GROUP BY category.category_nameORDER BY '销售额达成率' DESCLIMIT 1"
上个月，华南区哪个品类的销售额达成率最高？,"SELECT category.category_name  as '大类名称' , IFNULL(SUM(sale_amt)/SUM(budget_sale_amt),0) *100   as '销售额达成率' FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_idWHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND budget.month_id=date_format(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m') AND store.area_name='华南区'GROUP BY category.category_nameORDER BY '销售额达成率' DESCLIMIT 1"
上个月，深圳XXX路店哪个品类的销售额达成率最高？,"SELECT  category.category_name  as '大类名称' , IFNULL(SUM(sale_amt)/SUM(budget_sale_amt),0) *100   as '销售额达成率' FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_idWHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND budget.month_id=date_format(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m') AND store.store_name = '深圳XXX路店'GROUP BY category.category_nameORDER BY '销售额达成率' DESCLIMIT 1"
去年全年，销售额达成率呈现什么趋势？,"SELECT budget.month_id  as '月份' , IFNULL(SUM(sale_amt)/SUM(budget_sale_amt),0)*100     as '销售额达成率' FROM vw_dwd_fact_store_budget AS budget WHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 YEAR))GROUP BY budget.month_idORDER BY budget.month_id"
去年全年，华南区销售额达成率呈现什么趋势？,"SELECT budget.month_id  as '月份' , IFNULL(SUM(sale_amt)/SUM(budget_sale_amt),0) *100    as '销售额达成率' FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 YEAR)) AND store.area_name='华南区'GROUP BY budget.month_idORDER BY budget.month_id"
去年全年，深圳XXX路店销售额达成率呈现什么趋势？,"SELECT budget.month_id  as '月份' , IFNULL(SUM(sale_amt)/SUM(budget_sale_amt),0) *100    as '销售额达成率' FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 YEAR)) AND store.store_name = '深圳XXX路店'GROUP BY budget.month_idORDER BY budget.month_id"
去年全年，婴儿用品品类销售额达成率呈现什么趋势？,"SELECT budget.month_id  as '月份' , IFNULL(SUM(sale_amt)/SUM(budget_sale_amt),0)*100     as '销售额达成率' FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_idWHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 YEAR)) AND category.category_name='婴儿用品'GROUP BY budget.month_idORDER BY budget.month_id"
去年全年，深圳XXX路店婴儿用品品类的销售额达成率呈现什么趋势？,"SELECT budget.month_id  as '月份' , IFNULL(SUM(sale_amt)/SUM(budget_sale_amt),0) *100    as '销售额达成率' FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_idWHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 YEAR)) AND store.store_name = '深圳XXX路店' AND category.category_name='婴儿用品'GROUP BY budget.month_idORDER BY budget.month_id"
今年到目前为止，与去年同期相比，销售额达成率有什么变化？,"SELECT (t1.sale_achievement_rate-t2.sale_achievement_rate)/t2.sale_achievement_rate*100  as '同比变化' FROM (SELECT IFNULL(SUM(sale_amt)/SUM(budget_sale_amt),0)  AS sale_achievement_rateFROM vw_dwd_fact_store_budget AS budget WHERE budget.year_id=YEAR(CURDATE()) AND budget.month_id<=date_format(CURDATE(), '%Y%m')) t1,(SELECT IFNULL(SUM(sale_amt)/SUM(budget_sale_amt),0)  AS sale_achievement_rateFROM vw_dwd_fact_store_budget AS budget WHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 YEAR)) AND budget.month_id<=date_format(DATE_SUB(CURDATE(), INTERVAL 1 YEAR), '%Y%m')) t2"
今年到目前为止，与去年同期相比，华南区的销售额达成率有什么变化？,"SELECT  (t1.sale_achievement_rate-t2.sale_achievement_rate)/t2.sale_achievement_rate*100  as '同比变化' FROM (SELECT IFNULL(SUM(sale_amt)/SUM(budget_sale_amt),0)  AS sale_achievement_rateFROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(CURDATE()) AND budget.month_id<=date_format(CURDATE(), '%Y%m')  AND store.area_name='华南区') t1,(SELECT IFNULL(SUM(sale_amt)/SUM(budget_sale_amt),0)  AS sale_achievement_rateFROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 YEAR)) AND budget.month_id<=date_format(DATE_SUB(CURDATE(), INTERVAL 1 YEAR), '%Y%m')  AND store.area_name='华南区') t2"
今年到目前为止，与去年同期相比，深圳XXX路店的销售额达成率有什么变化？,"SELECT  (t1.sale_achievement_rate-t2.sale_achievement_rate)/t2.sale_achievement_rate*100  as '同比变化' FROM (SELECT IFNULL(SUM(sale_amt)/SUM(budget_sale_amt),0)  AS sale_achievement_rateFROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(CURDATE()) AND budget.month_id<=date_format(CURDATE(), '%Y%m')  AND store.store_name = '深圳XXX路店') t1,(SELECT IFNULL(SUM(sale_amt)/SUM(budget_sale_amt),0)  AS sale_achievement_rateFROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 YEAR)) AND budget.month_id<=date_format(DATE_SUB(CURDATE(), INTERVAL 1 YEAR), '%Y%m')  AND store.store_name = '深圳XXX路店') t2"
上个月的销售额、销售额达成率、差额是多少？,"SELECT SUM(sale_amt)   as '销售额'  ,IFNULL(SUM(sale_amt)/SUM(budget_sale_amt),0)*100    as '销售额达成率' ,SUM(budget_sale_amt) -SUM(sale_amt)  as '差额' FROM vw_dwd_fact_store_budget AS budget WHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND budget.month_id=date_format(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m')"
上个月各区域的销售额、销售额达成率、差额是多少？按销售额达成率排序,"SELECT store.area_name  as '区域名称' ,SUM(sale_amt)   as '销售额'  ,IFNULL(SUM(sale_amt)/SUM(budget_sale_amt),0) *100   as '销售额达成率' ,SUM(budget_sale_amt)-SUM(sale_amt)   as '差额' FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND budget.month_id=date_format(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m')GROUP BY store.area_nameORDER BY '销售额达成率' DESC"
上个月各区域的销售额、销售额达成率、差额是多少？按差额排序,"SELECT store.area_name  as '区域名称' ,SUM(sale_amt)   as '销售额'  ,IFNULL(SUM(sale_amt)/SUM(budget_sale_amt),0)*100    as '销售额达成率' ,SUM(budget_sale_amt)-SUM(sale_amt)   as '差额'FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND budget.month_id=date_format(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m')GROUP BY store.area_nameORDER BY  '差额' DESC"
上个月华南区的销售额、销售额达成率、差额是多少？,"SELECT SUM(sale_amt)   as '销售额'  ,SUM(sale_amt)/SUM(budget_sale_amt)*100    as '销售额达成率' ,SUM(budget_sale_amt)-SUM(sale_amt)   as '差额' FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND budget.month_id=date_format(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m') AND store.area_name='华南区'"
上个月深圳XXX路店的销售额、销售额达成率、差额是多少？,"SELECT SUM(sale_amt)   as '销售额'  ,SUM(sale_amt)/SUM(budget_sale_amt)*100    as '销售额达成率' ,SUM(budget_sale_amt)-SUM(sale_amt)   as '差额' FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND budget.month_id=date_format(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m') AND store.store_name = '深圳XXX路店'"
上个月各品类各区域的销售额、销售额达成率、差额是多少？,"SELECT category.category_name  as '大类名称' ,store.area_name as '区域名称',SUM(sale_amt) as '销售额' ,IFNULL(SUM(sale_amt)/SUM(budget_sale_amt),0)*100 as '销售额达成率' ,SUM(budget_sale_amt)-SUM(sale_amt) as '差额'  FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_idWHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND budget.month_id=date_format(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m')GROUP BY category.category_name,store.area_nameORDER BY category.category_name,store.area_name, '差额'  DESC"
上个月华南区各门店各品类的销售额、销售额达成率、差额是多少？,"SELECT store.store_name as '门店名称' ,category.category_name as '大类名称' ,SUM(sale_amt) as '销售额' ,IFNULL(SUM(sale_amt)/SUM(budget_sale_amt),0)*100 as '销售额达成率' ,SUM(budget_sale_amt)-SUM(sale_amt) as '差额' FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_idWHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND budget.month_id=date_format(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m') AND store.area_name='华南区'GROUP BY store.store_name,category.category_nameORDER BY store.store_name,category.category_name, '差额' DESC"
昨天的销售额同比,"SELECT t1.yesterday_sales  as '昨天销售额'  , t2.last_year_sales  as '去年同期销售额'  ,t1.yesterday_sales - t2.last_year_sales  as '同比差额'  ,(t1.yesterday_sales - t2.last_year_sales) / t2.last_year_sales*100    as '同比变化率'  FROM(  SELECT sum(sales_amt) as yesterday_sales   FROM vw_dwd_fact_store_order_detail   WHERE business_date = date_sub(curdate(), interval 1 day)) AS t1,(  SELECT sum(sales_amt) as last_year_sales   FROM vw_dwd_fact_store_order_detail   WHERE business_date = date_sub(date_sub(curdate(), interval 1 day), interval 1 year)) AS t2"
华南区昨天的销售额同比,"SELECT  t1.yesterday_sales  as '昨天销售额'  , t2.last_year_sales  as '去年同期销售额'  ,t1.yesterday_sales - t2.last_year_sales  as '同比差额'  ,(t1.yesterday_sales - t2.last_year_sales) / t2.last_year_sales*100    as '同比变化率'  FROM(  SELECT sum(sales_amt) as yesterday_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE business_date = date_sub(curdate(), interval 1 day) and ds.area_name='华南区') AS t1,(  SELECT sum(sales_amt) as last_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE business_date = date_sub(date_sub(curdate(), interval 1 day), interval 1 year) and ds.area_name='华南区') AS t2"
婴儿用品品类昨天的销售额同比,"SELECT  t1.yesterday_sales  as '昨天销售额'  , t2.last_year_sales  as '去年同期销售额'  ,t1.yesterday_sales - t2.last_year_sales  as '同比差额'  ,(t1.yesterday_sales - t2.last_year_sales) / t2.last_year_sales*100    as '同比变化率'  FROM(  SELECT sum(sales_amt) as yesterday_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  WHERE business_date = date_sub(curdate(), interval 1 day) and di.category_name_level1='婴儿用品') AS t1,(  SELECT sum(sales_amt) as last_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  WHERE business_date = date_sub(date_sub(curdate(), interval 1 day), interval 1 year) and di.category_name_level1='婴儿用品') AS t2"
华南区婴儿用品品类昨天的销售额同比,"SELECT  t1.yesterday_sales  as '昨天销售额'  , t2.last_year_sales  as '去年同期销售额'  ,t1.yesterday_sales - t2.last_year_sales  as '同比差额'  ,(t1.yesterday_sales - t2.last_year_sales) / t2.last_year_sales*100    as '同比变化率'  FROM(  SELECT sum(sales_amt) as yesterday_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE business_date = date_sub(curdate(), interval 1 day) and di.category_name_level1='婴儿用品' and ds.area_name='华南区') AS t1,(  SELECT sum(sales_amt) as last_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE business_date = date_sub(date_sub(curdate(), interval 1 day), interval 1 year) and di.category_name_level1='婴儿用品' and ds.area_name='华南区') AS t2"
深圳XXX路店昨天的销售额同比,"SELECT  t1.yesterday_sales  as '昨天销售额'  , t2.last_year_sales  as '去年同期销售额'  ,t1.yesterday_sales - t2.last_year_sales  as '同比差额'  ,(t1.yesterday_sales - t2.last_year_sales) / t2.last_year_sales*100    as '同比变化率'  FROM(  SELECT sum(sales_amt) as yesterday_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE business_date = date_sub(curdate(), interval 1 day) and ds.store_name='深圳XXX路店') AS t1,(  SELECT sum(sales_amt) as last_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE business_date = date_sub(date_sub(curdate(), interval 1 day), interval 1 year) and ds.store_name='深圳XXX路店') AS t2"
上周的销售额同比,"SELECT t1.last_week_sales  as '上周销售额'   , t2.last_year_sales  as '去年同期销售额'  ,t1.last_week_sales - t2.last_year_sales  as '同比差额'  ,(t1.last_week_sales - t2.last_year_sales) / t2.last_year_sales*100  as '同比变化率'  FROM(SELECT sum(sales_amt) as last_week_salesFROM vw_dwd_fact_store_order_detailWHERE year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week))) AS t1,(SELECT sum(sales_amt) as last_year_salesFROM vw_dwd_fact_store_order_detailWHERE year(business_date)=year(date_sub(date_sub(curdate(), interval 1 week), interval 1 year)) and weekofyear(business_date) = weekofyear(date_sub(date_sub(curdate(), interval 1 week), interval 1 year))) AS t2"
华南区上周的销售额同比,"SELECT  t1.last_week_sales  as '上周销售额'   , t2.last_year_sales  as '去年同期销售额'  ,t1.last_week_sales - t2.last_year_sales  as '同比差额' ,(t1.last_week_sales - t2.last_year_sales) / t2.last_year_sales*100  as '同比变化率'  FROM(  SELECT sum(sales_amt) as last_week_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and ds.area_name='华南区') AS t1,(  SELECT sum(sales_amt) as last_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date)=year(date_sub(date_sub(curdate(), interval 1 week), interval 1 year)) and weekofyear(business_date) = weekofyear(date_sub(date_sub(curdate(), interval 1 week), interval 1 year)) and ds.area_name='华南区') AS t2"
婴儿用品品类上周的销售额同比,"SELECT  t1.last_week_sales  as '上周销售额'   , t2.last_year_sales  as '去年同期销售额'  ,t1.last_week_sales - t2.last_year_sales  as '同比差额' ,(t1.last_week_sales - t2.last_year_sales) / t2.last_year_sales*100  as '同比变化率'  FROM(  SELECT sum(sales_amt) as last_week_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  WHERE year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and di.category_name_level1='婴儿用品') AS t1,(  SELECT sum(sales_amt) as last_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  WHERE year(business_date)=year(date_sub(date_sub(curdate(), interval 1 week), interval 1 year)) and weekofyear(business_date) = weekofyear(date_sub(date_sub(curdate(), interval 1 week), interval 1 year)) and di.category_name_level1='婴儿用品') AS t2"
华南区婴儿用品品类上周的销售额同比,"SELECT  t1.last_week_sales  as '上周销售额'   , t2.last_year_sales  as '去年同期销售额'  ,t1.last_week_sales - t2.last_year_sales  as '同比差额' ,(t1.last_week_sales - t2.last_year_sales) / t2.last_year_sales*100  as '同比变化率'  FROM(  SELECT sum(sales_amt) as last_week_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and di.category_name_level1='婴儿用品' and ds.area_name='华南区') AS t1,(  SELECT sum(sales_amt) as last_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date)=year(date_sub(date_sub(curdate(), interval 1 week), interval 1 year)) and weekofyear(business_date) = weekofyear(date_sub(date_sub(curdate(), interval 1 week), interval 1 year)) and di.category_name_level1='婴儿用品' and ds.area_name='华南区') AS t2"
深圳XXX路店上周的销售额同比,"SELECT  t1.last_week_sales  as '上周销售额'   , t2.last_year_sales  as '去年同期销售额'  ,t1.last_week_sales - t2.last_year_sales  as '同比差额'  ,(t1.last_week_sales - t2.last_year_sales) / t2.last_year_sales*100  as '同比变化率'  FROM(  SELECT sum(sales_amt) as last_week_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and ds.store_name='深圳XXX路店') AS t1,(  SELECT sum(sales_amt) as last_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date)=year(date_sub(date_sub(curdate(), interval 1 week), interval 1 year)) and weekofyear(business_date) = weekofyear(date_sub(date_sub(curdate(), interval 1 week), interval 1 year)) and ds.store_name='深圳XXX路店') AS t2"
今年3月份的销售额同比增长,"SELECT t1.this_year_sales   as '今年销售额'  , t2.last_year_sales  as '去年同期销售额'   ,t1.this_year_sales - t2.last_year_sales  as '同比差额' ,(t1.this_year_sales - t2.last_year_sales) / t2.last_year_sales*100  as '同比变化率'  FROM(  SELECT sum(sales_amt) as this_year_sales   FROM vw_dwd_fact_store_order_detail   WHERE year(business_date) = year(curdate()) and month(business_date) = 3) AS t1,(  SELECT sum(sales_amt) as last_year_sales   FROM vw_dwd_fact_store_order_detail   WHERE year(business_date) = year(curdate()) - 1 and month(business_date) = 3) AS t2"
华南区今年3月份的销售额同比增长,"SELECT t1.this_year_sales   as '今年销售额'  , t2.last_year_sales  as '去年同期销售额'   ,t1.this_year_sales - t2.last_year_sales  as '同比差额' , (t1.this_year_sales - t2.last_year_sales) / t2.last_year_sales*100  as '同比变化率'  FROM(  SELECT sum(sales_amt) as this_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date) = year(curdate()) and month(business_date) = 3 and ds.area_name='华南区') AS t1,(  SELECT sum(sales_amt) as last_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date) = year(curdate()) - 1 and month(business_date) = 3 and ds.area_name='华南区') AS t2"
婴儿用品品类今年3月份的销售额同比增长,"SELECT t1.this_year_sales   as '今年销售额'  , t2.last_year_sales  as '去年同期销售额'   ,t1.this_year_sales - t2.last_year_sales  as '同比差额' , (t1.this_year_sales - t2.last_year_sales) / t2.last_year_sales*100  as '同比变化率'  FROM(  SELECT sum(sales_amt) as this_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  WHERE year(business_date) = year(curdate()) and month(business_date) = 3 and di.category_name_level1='婴儿用品') AS t1,(  SELECT sum(sales_amt) as last_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  WHERE year(business_date) = year(curdate()) - 1 and month(business_date) = 3 and di.category_name_level1='婴儿用品') AS t2"
深圳XXX路店婴儿用品品类今年3月份的销售额同比增长,"SELECT t1.this_year_sales   as '今年销售额'  , t2.last_year_sales  as '去年同期销售额'   ,t1.this_year_sales - t2.last_year_sales  as '同比差额' , (t1.this_year_sales - t2.last_year_sales) / t2.last_year_sales*100  as '同比变化率'  FROM(  SELECT sum(sales_amt) as this_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date) = year(curdate()) and month(business_date) = 3 and di.category_name_level1='婴儿用品' and ds.store_name='深圳XXX路店') AS t1,(  SELECT sum(sales_amt) as last_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date) = year(curdate()) - 1 and month(business_date) = 3 and di.category_name_level1='婴儿用品' and ds.store_name='深圳XXX路店') AS t2"
深圳XXX路店今年3月份的销售额同比增长,"SELECT t1.this_year_sales   as '今年销售额'  , t2.last_year_sales  as '去年同期销售额'   ,t1.this_year_sales - t2.last_year_sales  as '同比差额' , (t1.this_year_sales - t2.last_year_sales) / t2.last_year_sales*100  as '同比变化率'  FROM(  SELECT sum(sales_amt) as this_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date) = year(curdate()) and month(business_date) = 3 and ds.store_name='深圳XXX路店') AS t1,(  SELECT sum(sales_amt) as last_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date) = year(curdate()) - 1 and month(business_date) = 3 and ds.store_name='深圳XXX路店') AS t2"
上个月各区域的销售额同比增长率,"SELECT ds.area_name, t1.this_year_sales   as '上个月销售额'  , t2.last_year_sales  as '去年同期销售额'   ,t1.this_year_sales - t2.last_year_sales  as '同比差额' , (t1.this_year_sales - t2.last_year_sales) / t2.last_year_sales*100  as '同比变化率' FROM(  SELECT store_id, sum(sales_amt) as this_year_sales   FROM vw_dwd_fact_store_order_detail  WHERE year(business_date) = year(curdate()) and month(business_date) = month(date_sub(curdate(), interval 1 month))  GROUP BY store_id) AS t1JOIN(  SELECT store_id, sum(sales_amt) as last_year_sales   FROM vw_dwd_fact_store_order_detail  WHERE year(business_date) = year(date_sub(curdate(), interval 1 month))-1 and month(business_date) = month(date_sub(curdate(), interval 1 month))  GROUP BY store_id) AS t2ON t1.store_id = t2.store_idJOIN vw_dwd_dim_store AS ds ON t1.store_id = ds.store_id"
今年到目前为止，深圳XXX路店的销售额同比增长了多少？,"SELECT t1.this_year_sales   as '今年销售额'  , t2.last_year_sales  as '去年同期销售额'   ,t1.this_year_sales - t2.last_year_sales  as '同比差额' , (t1.this_year_sales - t2.last_year_sales) / t2.last_year_sales*100  as '同比变化率'  FROM(  SELECT sum(sales_amt) as this_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date) = year(curdate()) and ds.store_name='深圳XXX路店') AS t1,(  SELECT sum(sales_amt) as last_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE (year(business_date) = year(curdate()) - 1 and business_date<date_sub(curdate(), interval 1 year)) and ds.store_name='深圳XXX路店') AS t2"
上个月婴儿用品品类的销售额同比增长了多少？,"SELECT t1.this_year_sales   as '上个月销售额'  , t2.last_year_sales  as '去年同期销售额'   ,t1.this_year_sales - t2.last_year_sales  as '同比差额' , (t1.this_year_sales - t2.last_year_sales) / t2.last_year_sales*100  as '同比变化率'  FROM(  SELECT sum(sales_amt) as this_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  WHERE year(business_date) = year(date_sub(curdate(), interval 1 month)) and month(business_date) = month(date_sub(curdate(), interval 1 month)) and di.category_name_level1='婴儿用品') AS t1,(  SELECT sum(sales_amt) as last_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  WHERE year(business_date) = year(date_sub(curdate(), interval 1 month)) - 1 and month(business_date) = month(date_sub(curdate(), interval 1 month)) and di.category_name_level1='婴儿用品') AS t2"
华南区上个月婴儿用品品类的销售额同比增长了多少？,"SELECT t1.this_year_sales   as '上个月销售额'  , t2.last_year_sales  as '去年同期销售额'   ,t1.this_year_sales - t2.last_year_sales  as '同比差额' , (t1.this_year_sales - t2.last_year_sales) / t2.last_year_sales*100  as '同比变化率'  FROM(  SELECT sum(sales_amt) as this_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date) = year(date_sub(curdate(), interval 1 month)) and month(business_date) = month(date_sub(curdate(), interval 1 month)) and di.category_name_level1='婴儿用品' and ds.area_name='华南区') AS t1,(  SELECT sum(sales_amt) as last_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date) = year(date_sub(curdate(), interval 1 month)) - 1 and month(business_date) = month(date_sub(curdate(), interval 1 month)) and di.category_name_level1='婴儿用品' and ds.area_name='华南区') AS t2"
深圳XXX路店上个月婴儿用品品类的销售额同比增长了多少？,"SELECT t1.this_year_sales   as '上个月销售额'  , t2.last_year_sales  as '去年同期销售额'   ,t1.this_year_sales - t2.last_year_sales  as '同比差额' , (t1.this_year_sales - t2.last_year_sales) / t2.last_year_sales*100  as '同比变化率'  FROM(  SELECT sum(sales_amt) as this_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date) = year(date_sub(curdate(), interval 1 month)) and month(business_date) = month(date_sub(curdate(), interval 1 month)) and di.category_name_level1='婴儿用品' and ds.store_name='深圳XXX路店') AS t1,(  SELECT sum(sales_amt) as last_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date) = year(date_sub(curdate(), interval 1 month)) - 1 and month(business_date) = month(date_sub(curdate(), interval 1 month)) and di.category_name_level1='婴儿用品' and ds.store_name='深圳XXX路店') AS t2"
上周鲜鸡蛋销售额同比增长了多少？,"SELECT t1.this_year_sales   as '上周销售额'  , t2.last_year_sales  as '去年同期销售额'   ,t1.this_year_sales - t2.last_year_sales  as '同比差额' , (t1.this_year_sales - t2.last_year_sales) / t2.last_year_sales*100  as '同比变化率'  FROM(  SELECT sum(sales_amt) as this_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  WHERE year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and di.item_name='鲜鸡蛋') AS t1,(  SELECT sum(sales_amt) as last_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  WHERE year(business_date)= year(business_date)=year(date_sub(date_sub(curdate(), interval 1 week), interval 1 year)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and di.item_name='鲜鸡蛋') AS t2"
上周华南区鲜鸡蛋销售额同比增长了多少？,"SELECT  t1.this_year_sales   as '上周销售额'  , t2.last_year_sales  as '去年同期销售额'   ,t1.this_year_sales - t2.last_year_sales  as '同比差额' , (t1.this_year_sales - t2.last_year_sales) / t2.last_year_sales*100  as '同比变化率'  FROM(  SELECT sum(sales_amt) as this_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and di.item_name='鲜鸡蛋' and ds.area_name='华南区') AS t1,(  SELECT sum(sales_amt) as last_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date)=year(date_sub(date_sub(curdate(), interval 1 week), interval 1 year)) and weekofyear(business_date) = weekofyear(date_sub(date_sub(curdate(), interval 1 week), interval 1 year))  and di.item_name='鲜鸡蛋' and ds.area_name='华南区') AS t2"
上周深圳XXX路店鲜鸡蛋销售额同比增长了多少？,"SELECT   t1.this_year_sales   as '上周销售额'  , t2.last_year_sales  as '去年同期销售额'   ,t1.this_year_sales - t2.last_year_sales  as '同比差额' , (t1.this_year_sales - t2.last_year_sales) / t2.last_year_sales*100  as '同比变化率'  FROM(  SELECT sum(sales_amt) as this_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and di.item_name='鲜鸡蛋' and ds.store_name='深圳XXX路店') AS t1,(  SELECT sum(sales_amt) as last_year_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date)=year(date_sub(date_sub(curdate(), interval 1 week), interval 1 year)) and weekofyear(business_date) = weekofyear(date_sub(date_sub(curdate(), interval 1 week), interval 1 year)) and di.item_name='鲜鸡蛋' and ds.store_name='深圳XXX路店') AS t2"
上个月线上渠道的销售额同比,"SELECT t.sales_amt as '上个月销售额'  , t1.sales_amt  as '去年同期销售额' ,t.sales_amt - t1.sales_amt  as '同比差额' ,(t.sales_amt - t1.sales_amt) / t1.sales_amt*100  as '同比变化率'  from(SELECT sum(a.sales_amt) as sales_amtFROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idWHERE year(business_date)=year(date_sub(curdate(), interval 1 month)) and month(business_date) = month(date_sub(curdate(), interval 1 month)) and c.channel_name = '线上') tjoin(SELECT sum(a.sales_amt) as sales_amtFROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idWHERE year(business_date)=year(date_sub(curdate(), interval 1 month))-1 and month(business_date) = month(date_sub(curdate(), interval 1 month)) and c.channel_name = '线上') t1 on 1=1"
上个月婴儿用品品类线上渠道的销售额同比,"SELECT t.sales_amt as '上个月销售额'  , t1.sales_amt  as '去年同期销售额' ,t.sales_amt - t1.sales_amt  as '同比差额' ,(t.sales_amt - t1.sales_amt) / t1.sales_amt*100  as '同比变化率' from(SELECT sum(a.sales_amt) as sales_amtFROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idJOIN vw_dwd_dim_item as d on a.item_id = d.item_idWHERE year(business_date)=year(date_sub(curdate(), interval 1 month)) and month(business_date) = month(date_sub(curdate(), interval 1 month)) and c.channel_name = '线上'and d.category_name_level1 = '婴儿用品') tjoin(SELECT sum(a.sales_amt) as sales_amtFROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idJOIN vw_dwd_dim_item as d on a.item_id = d.item_idWHERE year(business_date)=year(date_sub(curdate(), interval 1 month))-1 and month(business_date) = month(date_sub(curdate(), interval 1 month)) and c.channel_name = '线上'and d.category_name_level1 = '婴儿用品') t1 on 1=1"
上个月华南区线上渠道的销售额同比,"SELECT t.sales_amt as '上个月销售额'  , t1.sales_amt  as '去年同期销售额' ,t.sales_amt - t1.sales_amt  as '同比差额' ,(t.sales_amt - t1.sales_amt) / t1.sales_amt*100  as '同比变化率'  from(SELECT sum(a.sales_amt) as sales_amtFROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idJOIN vw_dwd_dim_store as e on a.store_id = e.store_idWHERE year(business_date)=year(date_sub(curdate(), interval 1 month)) and month(business_date) = month(date_sub(curdate(), interval 1 month)) and c.channel_name = '线上'and e.area_name = '华南区') tjoin(SELECT sum(a.sales_amt) as sales_amtFROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idJOIN vw_dwd_dim_store as e on a.store_id = e.store_idWHERE year(business_date)=year(date_sub(curdate(), interval 1 month))-1 and month(business_date) = month(date_sub(curdate(), interval 1 month)) and c.channel_name = '线上'and e.area_name = '华南区') t1 on 1=1"
上个月深圳XXX路店线上渠道的销售额同比,"SELECT t.sales_amt as '上个月销售额'  , t1.sales_amt  as '去年同期销售额' ,t.sales_amt - t1.sales_amt  as '同比差额' ,(t.sales_amt - t1.sales_amt) / t1.sales_amt*100  as '同比变化率'  from(SELECT sum(a.sales_amt) as sales_amtFROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idJOIN vw_dwd_dim_store as e on a.store_id = e.store_idWHERE year(business_date)=year(date_sub(curdate(), interval 1 month)) and month(business_date) = month(date_sub(curdate(), interval 1 month)) and c.channel_name = '线上'and e.store_name = '深圳XXX路店') tjoin(SELECT sum(a.sales_amt) as sales_amtFROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idJOIN vw_dwd_dim_store as e on a.store_id = e.store_idWHERE year(business_date)=year(date_sub(curdate(), interval 1 month))-1 and month(business_date) = month(date_sub(curdate(), interval 1 month)) and c.channel_name = '线上'and e.store_name = '深圳XXX路店') t1 on 1=1"
上个月深圳XXX路店婴儿用品品类线上渠道的销售额同比,"SELECT t.sales_amt as '上个月销售额'  , t1.sales_amt  as '去年同期销售额' ,t.sales_amt - t1.sales_amt  as '同比差额' ,(t.sales_amt - t1.sales_amt) / t1.sales_amt*100  as '同比变化率'  from(SELECT sum(a.sales_amt) as sales_amtFROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idJOIN vw_dwd_dim_item as d on a.item_id = d.item_idJOIN vw_dwd_dim_store as e on a.store_id = e.store_idWHERE year(business_date)=year(date_sub(curdate(), interval 1 month)) and month(business_date) = month(date_sub(curdate(), interval 1 month)) and c.channel_name = '线上'and d.category_name_level1 = '婴儿用品'and e.store_name = '深圳XXX路店') tjoin(SELECT sum(a.sales_amt) as sales_amtFROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idJOIN vw_dwd_dim_item as d on a.item_id = d.item_idJOIN vw_dwd_dim_store as e on a.store_id = e.store_idWHERE year(business_date)=year(date_sub(curdate(), interval 1 month))-1 and month(business_date) = month(date_sub(curdate(), interval 1 month)) and c.channel_name = '线上'and d.category_name_level1 = '婴儿用品'and e.store_name = '深圳XXX路店') t1 on 1=1"
昨天的销售额环比,"SELECT  t1.yesterday_sales   as '昨天销售额'  , t2.day_before_yesterday_sales  as '环比销售额' ,t1.yesterday_sales - t2.day_before_yesterday_sales  as '环比差额' ,(t1.yesterday_sales - t2.day_before_yesterday_sales) / t2.day_before_yesterday_sales*100  as '环比变化率' FROM(  SELECT sum(sales_amt) as yesterday_sales   FROM vw_dwd_fact_store_order_detail   WHERE business_date = date_sub(curdate(), interval 1 day)) AS t1,(  SELECT sum(sales_amt) as day_before_yesterday_sales   FROM vw_dwd_fact_store_order_detail   WHERE business_date = date_sub(curdate(), interval 2 day)) AS t2"
华南区昨天的销售额环比,"SELECT  t1.yesterday_sales   as '昨天销售额'  , t2.day_before_yesterday_sales  as '环比销售额' ,t1.yesterday_sales - t2.day_before_yesterday_sales  as '环比差额' ,(t1.yesterday_sales - t2.day_before_yesterday_sales) / t2.day_before_yesterday_sales*100  as '环比变化率' FROM(  SELECT sum(sales_amt) as yesterday_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE business_date = date_sub(curdate(), interval 1 day) and ds.area_name='华南区') AS t1,(  SELECT sum(sales_amt) as day_before_yesterday_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE business_date = date_sub(curdate(), interval 2 day) and ds.area_name='华南区') AS t2"
婴儿用品品类昨天的销售额环比,"SELECT  t1.yesterday_sales   as '昨天销售额'  , t2.day_before_yesterday_sales  as '环比销售额' ,t1.yesterday_sales - t2.day_before_yesterday_sales  as '环比差额' ,(t1.yesterday_sales - t2.day_before_yesterday_sales) / t2.day_before_yesterday_sales*100  as '环比变化率' FROM(  SELECT sum(sales_amt) as yesterday_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  WHERE business_date = date_sub(curdate(), interval 1 day) and di.category_name_level1='婴儿用品') AS t1,(  SELECT sum(sales_amt) as day_before_yesterday_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  WHERE business_date = date_sub(curdate(), interval 2 day) and di.category_name_level1='婴儿用品') AS t2"
华南区婴儿用品品类昨天的销售额环比,"SELECT  t1.yesterday_sales   as '昨天销售额'  , t2.day_before_yesterday_sales  as '环比销售额' ,t1.yesterday_sales - t2.day_before_yesterday_sales  as '环比差额' ,(t1.yesterday_sales - t2.day_before_yesterday_sales) / t2.day_before_yesterday_sales*100  as '环比变化率' FROM(  SELECT sum(sales_amt) as yesterday_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE business_date = date_sub(curdate(), interval 1 day) and di.category_name_level1='婴儿用品' and ds.area_name='华南区') AS t1,(  SELECT sum(sales_amt) as day_before_yesterday_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE business_date = date_sub(curdate(), interval 2 day) and di.category_name_level1='婴儿用品' and ds.area_name='华南区') AS t2"
深圳XXX路店昨天的销售额环比,"SELECT  t1.yesterday_sales   as '昨天销售额'  , t2.day_before_yesterday_sales  as '环比销售额' ,t1.yesterday_sales - t2.day_before_yesterday_sales  as '环比差额' ,(t1.yesterday_sales - t2.day_before_yesterday_sales) / t2.day_before_yesterday_sales*100  as '环比变化率' FROM(  SELECT sum(sales_amt) as yesterday_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE business_date = date_sub(curdate(), interval 1 day) and ds.store_name='深圳XXX路店') AS t1,(  SELECT sum(sales_amt) as day_before_yesterday_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE business_date = date_sub(curdate(), interval 2 day) and ds.store_name='深圳XXX路店') AS t2"
上周的销售额环比,"SELECT  t1.last_week_sales  as '上周销售额'   , t2.week_before_last_sales  as '环比销售额'  ,t1.last_week_sales - t2.week_before_last_sales  as '环比差额' ,(t1.last_week_sales - t2.week_before_last_sales) / t2.week_before_last_sales*100  as '环比变化率'  FROM(  SELECT sum(sales_amt) as last_week_sales   FROM vw_dwd_fact_store_order_detail  WHERE year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week))) AS t1,(  SELECT sum(sales_amt) as week_before_last_sales   FROM vw_dwd_fact_store_order_detail  WHERE year(business_date)=year(date_sub(curdate(), interval 2 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 2 week))) AS t2"
华南区上周的销售额环比,"SELECT  t1.last_week_sales  as '上周销售额'   , t2.week_before_last_sales  as '环比销售额'  ,t1.last_week_sales - t2.week_before_last_sales  as '环比差额' ,(t1.last_week_sales - t2.week_before_last_sales) / t2.week_before_last_sales*100  as '环比变化率'  FROM(  SELECT sum(sales_amt) as last_week_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and ds.area_name='华南区') AS t1,(  SELECT sum(sales_amt) as week_before_last_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date)=year(date_sub(curdate(), interval 2 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 2 week)) and ds.area_name='华南区') AS t2"
婴儿用品品类上周的销售额环比,"SELECT  t1.last_week_sales  as '上周销售额'   , t2.week_before_last_sales  as '环比销售额'  ,t1.last_week_sales - t2.week_before_last_sales  as '环比差额' ,(t1.last_week_sales - t2.week_before_last_sales) / t2.week_before_last_sales*100  as '环比变化率'  FROM(  SELECT sum(sales_amt) as last_week_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  WHERE year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and di.category_name_level1='婴儿用品') AS t1,(  SELECT sum(sales_amt) as week_before_last_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  WHERE year(business_date)=year(date_sub(curdate(), interval 2 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 2 week)) and di.category_name_level1='婴儿用品') AS t2"
华南区婴儿用品品类上周的销售额环比,"SELECT  t1.last_week_sales  as '上周销售额'   , t2.week_before_last_sales  as '环比销售额'  ,t1.last_week_sales - t2.week_before_last_sales  as '环比差额' ,(t1.last_week_sales - t2.week_before_last_sales) / t2.week_before_last_sales*100  as '环比变化率'  FROM(  SELECT sum(sales_amt) as last_week_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and di.category_name_level1='婴儿用品' and ds.area_name='华南区') AS t1,(  SELECT sum(sales_amt) as week_before_last_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date)=year(date_sub(curdate(), interval 2 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 2 week)) and di.category_name_level1='婴儿用品' and ds.area_name='华南区') AS t2"
深圳XXX路店上周的销售额环比,"SELECT  t1.last_week_sales  as '上周销售额'   , t2.week_before_last_sales  as '环比销售额'  ,t1.last_week_sales - t2.week_before_last_sales  as '环比差额' ,(t1.last_week_sales - t2.week_before_last_sales) / t2.week_before_last_sales*100  as '环比变化率'  FROM(  SELECT sum(sales_amt) as last_week_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and ds.store_name='深圳XXX路店') AS t1,(  SELECT sum(sales_amt) as week_before_last_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date)=year(date_sub(curdate(), interval 2 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 2 week)) and ds.store_name='深圳XXX路店') AS t2"
今年3月份的销售额环比增长,"SELECT t1.march_sales   as '销售额'  , t2.february_sales  as '环比销售额',t1.march_sales - t2.february_sales  as '环比差额' ,(t1.march_sales - t2.february_sales) / t2.february_sales*100  as '环比变化率' FROM(  SELECT sum(sales_amt) as march_sales   FROM vw_dwd_fact_store_order_detail  WHERE YEAR(business_date) = YEAR(curdate()) and MONTH(business_date) = 3) AS t1,(  SELECT sum(sales_amt) as february_sales   FROM vw_dwd_fact_store_order_detail  WHERE YEAR(business_date) = YEAR(curdate()) and MONTH(business_date) = 2) AS t2"
华南区今年3月份的销售额环比增长,"SELECT t1.march_sales   as '销售额'  , t2.february_sales  as '环比销售额',t1.march_sales - t2.february_sales  as '环比差额' ,(t1.march_sales - t2.february_sales) / t2.february_sales*100  as '环比变化率' FROM(  SELECT sum(sales_amt) as march_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE YEAR(business_date) = YEAR(curdate()) and MONTH(business_date) = 3 and ds.area_name='华南区') AS t1,(  SELECT sum(sales_amt) as february_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE YEAR(business_date) = YEAR(curdate()) and MONTH(business_date) = 2 and ds.area_name='华南区') AS t2"
婴儿用品品类今年3月份的销售额环比增长,"SELECT t1.march_sales   as '销售额'  , t2.february_sales  as '环比销售额',t1.march_sales - t2.february_sales  as '环比差额' ,(t1.march_sales - t2.february_sales) / t2.february_sales*100  as '环比变化率' FROM(  SELECT sum(sales_amt) as march_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  WHERE YEAR(business_date) = YEAR(curdate()) and MONTH(business_date) = 3 and di.category_name_level1='婴儿用品') AS t1,(  SELECT sum(sales_amt) as february_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  WHERE YEAR(business_date) = YEAR(curdate()) and MONTH(business_date) = 2 and di.category_name_level1='婴儿用品') AS t2"
深圳XXX路店婴儿用品品类今年3月份的销售额环比增长,"SELECT t1.march_sales   as '销售额'  , t2.february_sales  as '环比销售额',t1.march_sales - t2.february_sales  as '环比差额' ,(t1.march_sales - t2.february_sales) / t2.february_sales*100  as '环比变化率' FROM(  SELECT sum(sales_amt) as march_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE YEAR(business_date) = YEAR(curdate()) and MONTH(business_date) = 3 and di.category_name_level1='婴儿用品' and ds.store_name='深圳XXX路店') AS t1,(  SELECT sum(sales_amt) as february_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE YEAR(business_date) = YEAR(curdate()) and MONTH(business_date) = 2 and di.category_name_level1='婴儿用品' and ds.store_name='深圳XXX路店') AS t2"
深圳XXX路店今年3月份的销售额环比增长,"SELECT t1.march_sales   as '销售额'  , t2.february_sales  as '环比销售额',t1.march_sales - t2.february_sales  as '环比差额' ,(t1.march_sales - t2.february_sales) / t2.february_sales*100  as '环比变化率' FROM(  SELECT sum(sales_amt) as march_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE YEAR(business_date) = YEAR(curdate()) and MONTH(business_date) = 3 and ds.store_name='深圳XXX路店') AS t1,(  SELECT sum(sales_amt) as february_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE YEAR(business_date) = YEAR(curdate()) and MONTH(business_date) = 2 and ds.store_name='深圳XXX路店') AS t2"
上个月各区域的销售额环比增长率,"SELECT t1.area_name  as '区域名称' ,t1.sales_amt   as '上个月销售额' , t2.sales_amt   as '环比销售额'  ,t1.sales_amt - t2.sales_amt   as '环比差额'  ,(t1.sales_amt - t2.sales_amt) / t2.sales_amt*100   as '环比变化率'  FROM(  SELECT ds.area_name, sum(sales_amt) as sales_amt   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE YEAR(business_date) = YEAR(date_sub(curdate(), interval 1 month)) and MONTH(business_date) = MONTH(date_sub(curdate(), interval 1 month))  GROUP BY ds.area_name) AS t1,(  SELECT ds.area_name, sum(sales_amt) as sales_amt   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE YEAR(business_date) = YEAR(date_sub(curdate(), interval 2 month)) and MONTH(business_date) = MONTH(date_sub(curdate(), interval 2 month))  GROUP BY ds.area_name) AS t2WHERE t1.area_name = t2.area_name"
上个月婴儿用品品类的销售额环比增长了多少？,"SELECT t1.last_month_sales   as '上个月销售额', t2.previous_month_sales as '环比销售额',t1.last_month_sales - t2.previous_month_sales as '环比差额',  (t1.last_month_sales - t2.previous_month_sales) / t2.previous_month_sales*100 as '环比变化率'FROM(  SELECT sum(sales_amt) as last_month_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  WHERE YEAR(business_date) = YEAR(date_sub(curdate(), interval 1 month)) and MONTH(business_date) = MONTH(date_sub(curdate(), interval 1 month)) and di.category_name_level1='婴儿用品') AS t1,(  SELECT sum(sales_amt) as previous_month_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  WHERE YEAR(business_date) = YEAR(date_sub(curdate(), interval 2 month)) and MONTH(business_date) = MONTH(date_sub(curdate(), interval 2 month)) and di.category_name_level1='婴儿用品') AS t2"
华南区上个月婴儿用品品类的销售额环比增长了多少？,"SELECT t1.last_month_sales   as '上个月销售额', t2.previous_month_sales as '环比销售额',t1.last_month_sales - t2.previous_month_sales as '环比差额',  (t1.last_month_sales - t2.previous_month_sales) / t2.previous_month_sales*100 as '环比变化率'FROM(  SELECT sum(sales_amt) as last_month_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE YEAR(business_date) = YEAR(date_sub(curdate(), interval 1 month)) and MONTH(business_date) = MONTH(date_sub(curdate(), interval 1 month)) and di.category_name_level1='婴儿用品' and ds.area_name='华南区') AS t1,(  SELECT sum(sales_amt) as previous_month_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE YEAR(business_date) = YEAR(date_sub(curdate(), interval 2 month)) and MONTH(business_date) = MONTH(date_sub(curdate(), interval 2 month)) and di.category_name_level1='婴儿用品' and ds.area_name='华南区') AS t2"
深圳XXX路店上个月婴儿用品品类的销售额环比增长了多少？,"SELECT t1.last_month_sales   as '上个月销售额', t2.previous_month_sales as '环比销售额',t1.last_month_sales - t2.previous_month_sales as '环比差额',  (t1.last_month_sales - t2.previous_month_sales) / t2.previous_month_sales*100 as '环比变化率'FROM(  SELECT sum(sales_amt) as last_month_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE YEAR(business_date) = YEAR(date_sub(curdate(), interval 1 month)) and MONTH(business_date) = MONTH(date_sub(curdate(), interval 1 month)) and di.category_name_level1='婴儿用品' and ds.store_name='深圳XXX路店') AS t1,(  SELECT sum(sales_amt) as previous_month_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE YEAR(business_date) = YEAR(date_sub(curdate(), interval 2 month)) and MONTH(business_date) = MONTH(date_sub(curdate(), interval 2 month)) and di.category_name_level1='婴儿用品' and ds.store_name='深圳XXX路店') AS t2"
上周鲜鸡蛋销售额环比增长了多少？,"SELECT t1.last_week_sales  as '上周销售额'  , t2.previous_week_sales  as '环比销售额'  ,t1.last_week_sales - t2.previous_week_sales  as '环比差额'  ,(t1.last_week_sales - t2.previous_week_sales) / t2.previous_week_sales*100  as '环比变化率'  FROM(  SELECT sum(sales_amt) as last_week_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  WHERE year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and di.item_name='鲜鸡蛋') AS t1,(  SELECT sum(sales_amt) as previous_week_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  WHERE year(business_date)=year(date_sub(curdate(), interval 2 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 2 week)) and di.item_name='鲜鸡蛋') AS t2"
上周华南区鲜鸡蛋销售额环比增长了多少？,"SELECT t1.last_week_sales  as '上周销售额'  , t2.previous_week_sales  as '环比销售额'  ,t1.last_week_sales - t2.previous_week_sales  as '环比差额'  ,(t1.last_week_sales - t2.previous_week_sales) / t2.previous_week_sales*100  as '环比变化率'  FROM(  SELECT sum(sales_amt) as last_week_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and di.item_name='鲜鸡蛋' and ds.area_name='华南区') AS t1,(  SELECT sum(sales_amt) as previous_week_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date)=year(date_sub(curdate(), interval 2 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 2 week)) and di.item_name='鲜鸡蛋' and ds.area_name='华南区') AS t2"
上周深圳XXX路店鲜鸡蛋销售额环比增长了多少？,"SELECT t1.last_week_sales  as '上周销售额'  , t2.previous_week_sales  as '环比销售额'  ,t1.last_week_sales - t2.previous_week_sales  as '环比差额'  ,(t1.last_week_sales - t2.previous_week_sales) / t2.previous_week_sales*100  as '环比变化率'  FROM(  SELECT sum(sales_amt) as last_week_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and di.item_name='鲜鸡蛋' and ds.store_name='深圳XXX路店') AS t1,(  SELECT sum(sales_amt) as previous_week_sales   FROM vw_dwd_fact_store_order_detail AS od  JOIN vw_dwd_dim_item AS di   ON od.item_id = di.item_id  JOIN vw_dwd_dim_store AS ds   ON od.store_id = ds.store_id  WHERE year(business_date)=year(date_sub(curdate(), interval 2 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 2 week)) and di.item_name='鲜鸡蛋' and ds.store_name='深圳XXX路店') AS t2"
上个月线上渠道的销售额环比,"SELECT t.sales_amt  as '上个月销售额', t1.sales_amt  as '环比销售额',t.sales_amt - t1.sales_amt as '环比差额',(t.sales_amt - t1.sales_amt) / t1.sales_amt*100 as '环比变化率'from(SELECT sum(a.sales_amt) as sales_amtFROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idWHERE year(business_date)=year(date_sub(curdate(), interval 1 month)) and month(business_date) = month(date_sub(curdate(), interval 1 month)) and c.channel_name = '线上') tjoin(SELECT sum(a.sales_amt) as sales_amtFROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idWHERE year(business_date)=year(date_sub(curdate(), interval 2 month)) and month(business_date) = month(date_sub(curdate(), interval 2 month))  and c.channel_name = '线上') t1 on 1=1"
上个月婴儿用品品类线上渠道的销售额环比,"SELECT  t.sales_amt  as '上个月销售额', t1.sales_amt  as '环比销售额',t.sales_amt - t1.sales_amt as '环比差额',(t.sales_amt - t1.sales_amt) / t1.sales_amt*100 as '环比变化率'from(SELECT sum(a.sales_amt) as sales_amtFROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idJOIN vw_dwd_dim_item as d on a.item_id = d.item_idWHERE year(business_date)=year(date_sub(curdate(), interval 1 month)) and month(business_date) = month(date_sub(curdate(), interval 1 month)) and c.channel_name = '线上'and d.category_name_level1 = '婴儿用品') tjoin(SELECT sum(a.sales_amt) as sales_amtFROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idJOIN vw_dwd_dim_item as d on a.item_id = d.item_idWHERE year(business_date)=year(date_sub(curdate(), interval 2 month)) and month(business_date) = month(date_sub(curdate(), interval 2 month))  and c.channel_name = '线上'and d.category_name_level1 = '婴儿用品') t1 on 1=1"
上个月华南区线上渠道的销售额环比,"SELECT  t.sales_amt  as '上个月销售额', t1.sales_amt  as '环比销售额',t.sales_amt - t1.sales_amt as '环比差额',(t.sales_amt - t1.sales_amt) / t1.sales_amt*100 as '环比变化率'from(SELECT sum(a.sales_amt) as sales_amtFROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idJOIN vw_dwd_dim_store as e on a.store_id = e.store_idWHERE year(business_date)=year(date_sub(curdate(), interval 1 month)) and month(business_date) = month(date_sub(curdate(), interval 1 month)) and c.channel_name = '线上'and e.area_name = '华南区') tjoin(SELECT sum(a.sales_amt) as sales_amtFROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idJOIN vw_dwd_dim_store as e on a.store_id = e.store_idWHERE year(business_date)=year(date_sub(curdate(), interval 2 month)) and month(business_date) = month(date_sub(curdate(), interval 2 month))  and c.channel_name = '线上'and e.area_name = '华南区') t1 on 1=1"
上个月深圳XXX路店线上渠道的销售额环比,"SELECT  t.sales_amt  as '上个月销售额', t1.sales_amt  as '环比销售额',t.sales_amt - t1.sales_amt as '环比差额',(t.sales_amt - t1.sales_amt) / t1.sales_amt*100 as '环比变化率'from(SELECT sum(a.sales_amt) as sales_amtFROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idJOIN vw_dwd_dim_store as e on a.store_id = e.store_idWHERE year(business_date)=year(date_sub(curdate(), interval 1 month)) and month(business_date) = month(date_sub(curdate(), interval 1 month)) and c.channel_name = '线上'and e.store_name = '深圳XXX路店') tjoin(SELECT sum(a.sales_amt) as sales_amtFROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idJOIN vw_dwd_dim_store as e on a.store_id = e.store_idWHERE year(business_date)=year(date_sub(curdate(), interval 2 month)) and month(business_date) = month(date_sub(curdate(), interval 2 month))  and c.channel_name = '线上'and e.store_name = '深圳XXX路店') t1 on 1=1"
上个月在所有品类中，哪个品类的销售额贡献最大？,"SELECT di.category_name_level1  as '大类名称' , sum(od.sales_amt)   as '销售额'FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS di ON od.item_id = di.item_idWHERE YEAR(business_date) = YEAR(date_sub(curdate(), interval 1 month)) and MONTH(business_date) = MONTH(date_sub(curdate(), interval 1 month)) GROUP BY di.category_name_level1ORDER BY '销售额' DESCLIMIT 1"
上个月华南区所有品类中，哪个品类的销售额贡献最大？,"SELECT di.category_name_level1  as '大类名称' , sum(od.sales_amt)   as '销售额'FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS di ON od.item_id = di.item_idJOIN vw_dwd_dim_store AS ds ON od.store_id = ds.store_idWHERE YEAR(business_date) = YEAR(date_sub(curdate(), interval 1 month)) and MONTH(business_date) = MONTH(date_sub(curdate(), interval 1 month)) and ds.area_name='华南区'GROUP BY di.category_name_level1ORDER BY '销售额' DESCLIMIT 1"
上个月深圳XXX路店所有品类中，哪个品类的销售额贡献最大？,"SELECT di.category_name_level1  as '大类名称' , sum(od.sales_amt)   as '销售额'FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS di ON od.item_id = di.item_idJOIN vw_dwd_dim_store AS ds ON od.store_id = ds.store_idWHERE YEAR(business_date) = YEAR(date_sub(curdate(), interval 1 month)) and MONTH(business_date) = MONTH(date_sub(curdate(), interval 1 month)) and ds.store_name='深圳XXX路店'GROUP BY di.category_name_level1ORDER BY '销售额' DESCLIMIT 1"
上个月深圳XXX路店的生鲜品类中，哪个品类的销售额贡献最大？,"SELECT di.category_name_level1  as '大类名称' , sum(od.sales_amt)   as '销售额'FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS di ON od.item_id = di.item_idJOIN vw_dwd_dim_store AS ds ON od.store_id = ds.store_idWHERE YEAR(business_date) = YEAR(date_sub(curdate(), interval 1 month)) and MONTH(business_date) = MONTH(date_sub(curdate(), interval 1 month)) and ds.store_name='深圳XXX路店' and od.is_fresh_item='生鲜'GROUP BY di.category_name_level1ORDER BY '销售额' DESCLIMIT 1"
去年，哪些品类对总销售额的贡献最大？,"SELECT di.category_name_level1  as '大类名称' , sum(od.sales_amt)   as '销售额'FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS di ON od.item_id = di.item_idWHERE YEAR(business_date) = YEAR(date_sub(curdate(), interval 1 year))GROUP BY di.category_name_level1ORDER BY '销售额' DESCLIMIT 10"
华南区去年，哪些品类对总销售额的贡献最大？,"SELECT di.category_name_level1  as '大类名称' , sum(od.sales_amt)   as '销售额'FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS di ON od.item_id = di.item_idJOIN vw_dwd_dim_store AS ds ON od.store_id = ds.store_idWHERE YEAR(business_date) = YEAR(date_sub(curdate(), interval 1 year)) and ds.area_name='华南区'GROUP BY di.category_name_level1ORDER BY '销售额' DESCLIMIT 10"
深圳XXX路店去年，哪些品类对总销售额的贡献最大？,"SELECT di.category_name_level1  as '大类名称' , sum(od.sales_amt)   as '销售额'FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS di ON od.item_id = di.item_idJOIN vw_dwd_dim_store AS ds ON od.store_id = ds.store_idWHERE YEAR(business_date) = YEAR(date_sub(curdate(), interval 1 year)) and ds.store_name='深圳XXX路店'GROUP BY di.category_name_level1ORDER BY '销售额' DESCLIMIT 10"
上个月，哪些门店的销售贡献最高？,"SELECT ds.store_name  as '门店名称' , sum(od.sales_amt)   as '销售额'  FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_store AS ds ON od.store_id = ds.store_idWHERE YEAR(business_date) = YEAR(date_sub(curdate(), interval 1 month)) and MONTH(business_date) = MONTH(date_sub(curdate(), interval 1 month))GROUP BY ds.store_nameORDER BY '销售额' DESCLIMIT 10"
上个月，华南区哪些门店的销售贡献最高？,"SELECT ds.store_name  as '门店名称' , sum(od.sales_amt)   as '销售额'  FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_store AS ds ON od.store_id = ds.store_idWHERE YEAR(business_date) = YEAR(date_sub(curdate(), interval 1 month)) and MONTH(business_date) = MONTH(date_sub(curdate(), interval 1 month)) and ds.area_name='华南区'GROUP BY ds.store_nameORDER BY  '销售额'  DESCLIMIT 10"
上周，线上和线下渠道对销售的贡献分别是多少？,"SELECT c.channel_name  as '渠道名称'  , sum(a.sales_amt)   as '销售额'  FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idWHERE year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week))GROUP BY c.channel_name"
上周，华南区线上和线下渠道对销售的贡献分别是多少？,"SELECT  c.channel_name  as '渠道名称'  , sum(a.sales_amt)   as '销售额'  FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idJOIN vw_dwd_dim_store as e on a.store_id = e.store_idWHERE year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week))and e.area_name = '华南区'GROUP BY c.channel_name"
上周，深圳XXX路店线上和线下渠道对销售的贡献分别是多少？,"SELECT  c.channel_name  as '渠道名称'  , sum(a.sales_amt)   as '销售额'  FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idJOIN vw_dwd_dim_store as e on a.store_id = e.store_idWHERE year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week))and e.store_name = '深圳XXX路店'GROUP BY c.channel_name"
上周，深圳XXX路店婴儿用品品类线上和线下渠道对销售的贡献分别是多少？,"SELECT  c.channel_name  as '渠道名称'  , sum(a.sales_amt)   as '销售额'  FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idJOIN vw_dwd_dim_item as d on a.item_id = d.item_idJOIN vw_dwd_dim_store as e on a.store_id = e.store_idWHERE year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week))and d.category_name_level1 = '婴儿用品'and e.store_name = '深圳XXX路店'GROUP BY c.channel_name"
上个月，不同区域对整体销售额的贡献如何？,"SELECT ds.area_name  as '区域名称' , sum(od.sales_amt)   as '销售额'  FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_store AS ds ON od.store_id = ds.store_idWHERE YEAR(business_date) = YEAR(date_sub(curdate(), interval 1 month)) and MONTH(business_date) = MONTH(date_sub(curdate(), interval 1 month)) GROUP BY ds.area_nameORDER BY '销售额' DESC"
上个月，对整体销售额贡献最高的10个商品是哪些？,"SELECT di.item_name  as '商品名称' , sum(od.sales_amt)   as '销售额' FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS diON od.item_id = di.item_idWHERE YEAR(business_date) = YEAR(date_sub(curdate(), interval 1 month)) and MONTH(business_date) = MONTH(date_sub(curdate(), interval 1 month)) GROUP BY di.item_nameORDER BY  '销售额' DESCLIMIT 10"
上个月，对华南区销售额贡献最高的10个商品是哪些？,"SELECT di.item_name  as '商品名称' , sum(od.sales_amt)   as '销售额' FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS di ON od.item_id = di.item_idJOIN vw_dwd_dim_store AS ds ON od.store_id = ds.store_idWHERE YEAR(business_date) = YEAR(date_sub(curdate(), interval 1 month)) and MONTH(business_date) = MONTH(date_sub(curdate(), interval 1 month))  and ds.area_name='华南区'GROUP BY di.item_nameORDER BY  '销售额' DESCLIMIT 10"
上个月，对深圳XXX路店销售额贡献最高的10个商品是哪些？,"SELECT di.item_name  as '商品名称' , sum(od.sales_amt)   as '销售额'  FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS di ON od.item_id = di.item_idJOIN vw_dwd_dim_store AS ds ON od.store_id = ds.store_idWHERE YEAR(business_date) = YEAR(date_sub(curdate(), interval 1 month)) and MONTH(business_date) = MONTH(date_sub(curdate(), interval 1 month)) and ds.store_name='深圳XXX路店'GROUP BY di.item_nameORDER BY  '销售额' DESCLIMIT 10"
上个月，对深圳XXX路店婴儿用品品类销售额贡献最高的10个商品是哪些？,"SELECT di.item_name  as '商品名称' , sum(od.sales_amt)   as '销售额'  FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS di ON od.item_id = di.item_idJOIN vw_dwd_dim_store AS ds ON od.store_id = ds.store_idWHERE YEAR(business_date) = YEAR(date_sub(curdate(), interval 1 month)) and MONTH(business_date) = MONTH(date_sub(curdate(), interval 1 month)) and ds.store_name='深圳XXX路店' and di.category_name_level1='婴儿用品'GROUP BY di.item_nameORDER BY '销售额' DESCLIMIT 10"
上个月，对华南区婴儿用品品类销售额贡献最高的10个商品是哪些？,"SELECT di.item_name  as '商品名称' , sum(od.sales_amt)   as '销售额'  FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS di ON od.item_id = di.item_idJOIN vw_dwd_dim_store AS ds ON od.store_id = ds.store_idWHERE YEAR(business_date) = YEAR(date_sub(curdate(), interval 1 month)) and MONTH(business_date) = MONTH(date_sub(curdate(), interval 1 month)) and ds.area_name='华南区' and di.category_name_level1='婴儿用品'GROUP BY di.item_nameORDER BY '销售额' DESCLIMIT 10"
上个月，婴儿用品品类的销售占比比前一个月有何变化？,"select  t1.last_month_sales_ratio*100  as '上个月销售占比'  ,t2.pre_last_month_sales_ratio*100  as '前一个月销售占比'  ,t1.last_month_sales_ratio-t2.pre_last_month_sales_ratio  as '环比差额' ,(t1.last_month_sales_ratio-t2.pre_last_month_sales_ratio)/t2.pre_last_month_sales_ratio*100 as '环比变化率' from(select sum(case when b.category_name_level1 = '婴儿用品' then c.sales_amt else 0 end) / sum(c.sales_amt) as last_month_sales_ratiofrom     vw_dwd_dim_item bjoin     vw_dwd_fact_store_order_detail c on b.item_id = c.item_idwhere year(c.business_date)=year(date_sub(curdate(), interval 1 month)) and month(c.business_date) = month(date_sub(curdate(), interval 1 month)))t1,(select sum(case when b.category_name_level1 = '婴儿用品' then c.sales_amt else 0 end) / sum(c.sales_amt) as pre_last_month_sales_ratiofrom     vw_dwd_dim_item bjoin     vw_dwd_fact_store_order_detail c on b.item_id = c.item_idwhere year(c.business_date)=year(date_sub(curdate(), interval 2 month)) and month(c.business_date) = month(date_sub(curdate(), interval 2 month)))t2"
上个月，华南区婴儿用品品类的销售占比比前一个月有何变化？,"select  t1.last_month_sales_ratio*100  as '上个月销售占比'  ,t2.pre_last_month_sales_ratio*100  as '前一个月销售占比'  ,t1.last_month_sales_ratio-t2.pre_last_month_sales_ratio  as '环比差额' ,(t1.last_month_sales_ratio-t2.pre_last_month_sales_ratio)/t2.pre_last_month_sales_ratio*100 as '环比变化率' from(select sum(case when b.category_name_level1 = '婴儿用品' then c.sales_amt else 0 end) / sum(c.sales_amt) as last_month_sales_ratiofrom     vw_dwd_dim_item bjoin     vw_dwd_fact_store_order_detail c on b.item_id = c.item_idjoin 	vw_dwd_dim_store a on a.store_id = c.store_idwhere a.area_name = '华南区' and year(c.business_date)=year(date_sub(curdate(), interval 1 month)) and month(c.business_date) = month(date_sub(curdate(), interval 1 month)))t1,(select sum(case when b.category_name_level1 = '婴儿用品' then c.sales_amt else 0 end) / sum(c.sales_amt) as pre_last_month_sales_ratiofrom     vw_dwd_dim_item bjoin     vw_dwd_fact_store_order_detail c on b.item_id = c.item_idjoin 	vw_dwd_dim_store a on a.store_id = c.store_idwhere a.area_name = '华南区' and year(c.business_date)=year(date_sub(curdate(), interval 2 month)) and month(c.business_date) = month(date_sub(curdate(), interval 2 month)))t2"
上个月，深圳XXX路店婴儿用品品类的销售占比比前一个月有何变化？,"select  t1.last_month_sales_ratio*100  as '上个月销售占比'  ,t2.pre_last_month_sales_ratio*100  as '前一个月销售占比'  ,t1.last_month_sales_ratio-t2.pre_last_month_sales_ratio  as '环比差额' ,(t1.last_month_sales_ratio-t2.pre_last_month_sales_ratio)/t2.pre_last_month_sales_ratio*100 as '环比变化率' from(select sum(case when b.category_name_level1 = '婴儿用品' then c.sales_amt else 0 end) / sum(c.sales_amt) as last_month_sales_ratiofrom     vw_dwd_dim_item bjoin     vw_dwd_fact_store_order_detail c on b.item_id = c.item_idjoin 	vw_dwd_dim_store a on a.store_id = c.store_idwhere a.store_name = '深圳XXX路店' and year(c.business_date)=year(date_sub(curdate(), interval 1 month)) and month(c.business_date) = month(date_sub(curdate(), interval 1 month)))t1,(select sum(case when b.category_name_level1 = '婴儿用品' then c.sales_amt else 0 end) / sum(c.sales_amt) as pre_last_month_sales_ratiofrom     vw_dwd_dim_item bjoin     vw_dwd_fact_store_order_detail c on b.item_id = c.item_idjoin 	vw_dwd_dim_store a on a.store_id = c.store_idwhere a.store_name = '深圳XXX路店' and year(c.business_date)=year(date_sub(curdate(), interval 2 month)) and month(c.business_date) = month(date_sub(curdate(), interval 2 month)))t2"
昨天鲜鸡蛋的销量是多少？,"SELECT sum(qty)  as '销量' FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS diON od.item_id = di.item_idWHERE business_date = to_date(date_sub(curdate(),1)) and di.item_name = '鲜鸡蛋'"
昨天华南区鲜鸡蛋的销量是多少？,"SELECT sum(od.qty)   as '销量' FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS di ON od.item_id = di.item_idJOIN vw_dwd_dim_store AS dsON od.store_id = ds.store_idWHERE od.business_date = to_date(date_sub(curdate(),1)) and di.item_name = '鲜鸡蛋' and ds.area_name = '华南区'"
昨天深圳XXX路店鲜鸡蛋的销量是多少？,"SELECT sum(od.qty)   as '销量'  FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS di ON od.item_id = di.item_idJOIN vw_dwd_dim_store AS dsON od.store_id = ds.store_idWHERE od.business_date = to_date(date_sub(curdate(),1)) and di.item_name = '鲜鸡蛋' and ds.store_name = '深圳XXX路店'"
昨天片糖卖了多少斤？,"SELECT sum(od.qty)   as '销量' FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS di ON od.item_id = di.item_idWHERE od.business_date = to_date(date_sub(curdate(),1)) and di.item_name = '片糖'"
昨天各区域的片糖卖了多少斤？,"SELECT ds.area_name, sum(od.qty)  as '销量' FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS di ON od.item_id = di.item_idJOIN vw_dwd_dim_store AS dsON od.store_id = ds.store_idWHERE od.business_date = curdate() - interval 1 day and di.item_name = '片糖'GROUP BY ds.area_name"
昨天华南区片糖卖了多少斤？,"SELECT sum(od.qty)   as '销量' FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS di ON od.item_id = di.item_idJOIN vw_dwd_dim_store AS dsON od.store_id = ds.store_idWHERE od.business_date = to_date(date_sub(curdate(),1)) and di.item_name = '片糖' and ds.area_name = '华南区'"
昨天深圳XXX路店片糖卖了多少斤？,"SELECT sum(od.qty)   as '销量' FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS di ON od.item_id = di.item_idJOIN vw_dwd_dim_store AS dsON od.store_id = ds.store_idWHERE od.business_date = to_date(date_sub(curdate(),1)) and di.item_name = '片糖' and ds.store_name = '深圳XXX路店'"
上个月甜白菜卖了多少斤？,SELECT sum(od.qty)   as '销量' FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS di ON od.item_id = di.item_idWHERE year(od.business_date) = year(curdate() - interval 1 month) and month(od.business_date) = month(curdate() - interval 1 month) and di.item_name = '甜白菜'
上个月华南区甜白菜卖了多少斤？,SELECT sum(od.qty)  as '销量'  FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS di ON od.item_id = di.item_idJOIN vw_dwd_dim_store AS dsON od.store_id = ds.store_idWHERE year(od.business_date) = year(curdate() - interval 1 month) and month(od.business_date) = month(curdate() - interval 1 month) and di.item_name = '甜白菜' and ds.area_name = '华南区'
上个月深圳XXX路店甜白菜卖了多少斤？,SELECT sum(od.qty)   as '销量' FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS di ON od.item_id = di.item_idJOIN vw_dwd_dim_store AS dsON od.store_id = ds.store_idWHERE year(od.business_date) = year(curdate() - interval 1 month) and month(od.business_date) = month(curdate() - interval 1 month) and di.item_name = '甜白菜' and ds.store_name = '深圳XXX路店'
今年厨邦酱油的销量是多少？,SELECT sum(od.qty)   as '销量' FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS di ON od.item_id = di.item_idWHERE year(od.business_date) = year(curdate()) and di.item_name = '厨邦酱油'
今年华南区厨邦酱油的销量是多少？,SELECT sum(od.qty)   as '销量' FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS di ON od.item_id = di.item_idJOIN vw_dwd_dim_store AS dsON od.store_id = ds.store_idWHERE year(od.business_date) = year(curdate()) and di.item_name = '厨邦酱油' and ds.area_name = '华南区'
今年深圳XXX路店厨邦酱油的销量是多少？,SELECT sum(od.qty)   as '销量' FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS di ON od.item_id = di.item_idJOIN vw_dwd_dim_store AS dsON od.store_id = ds.store_idWHERE year(od.business_date) = year(curdate()) and di.item_name = '厨邦酱油' and ds.store_name = '深圳XXX路店'
今年旺旺糕点一共卖了多少盒？,SELECT sum(od.qty)   as '销量' FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS di ON od.item_id = di.item_idWHERE year(od.business_date) = year(curdate()) and di.item_name = '旺旺糕点'
今年华南区旺旺糕点一共卖了多少盒？,SELECT sum(od.qty)    as '销量' FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS di ON od.item_id = di.item_idJOIN vw_dwd_dim_store AS dsON od.store_id = ds.store_idWHERE year(od.business_date) = year(curdate()) and di.item_name = '旺旺糕点' and ds.area_name = '华南区'
今年深圳XXX路店旺旺糕点一共卖了多少盒？,SELECT sum(od.qty)   as '销量' FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS di ON od.item_id = di.item_idJOIN vw_dwd_dim_store AS dsON od.store_id = ds.store_idWHERE year(od.business_date) = year(curdate()) and di.item_name = '旺旺糕点' and ds.store_name = '深圳XXX路店'
上周芙蓉王(蓝)卖了多少包？,"SELECT sum(od.qty)  as '销量' FROM vw_dwd_fact_store_order_detail AS odJOIN vw_dwd_dim_item AS diON od.item_id = di.item_idWHERE year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and di.item_name = '芙蓉王(蓝)'"
上周华南区芙蓉王(蓝)卖了多少包？,"SELECT sum(qty)   as '销量' FROM vw_dwd_fact_store_order_detail AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idJOIN vw_dwd_dim_store AS c ON a.store_id = c.store_idWHERE b.item_name = '芙蓉王(蓝)'AND c.area_name = '华南区'AND year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week))"
上周深圳XXX路店芙蓉王(蓝)卖了多少包？,"SELECT sum(qty)   as '销量' FROM vw_dwd_fact_store_order_detail AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idJOIN vw_dwd_dim_store AS c ON a.store_id = c.store_idWHERE b.item_name = '芙蓉王(蓝)'AND c.store_name = '深圳XXX路店'AND year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week))"
本月基围虾卖了多少斤？,SELECT sum(qty)    as '销量' FROM vw_dwd_fact_store_order_detail AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idWHERE b.item_name = '基围虾'AND year(date(a.business_date)) = year(curdate())AND month(date(a.business_date)) = month(curdate())
本月华南区基围虾卖了多少斤？,SELECT sum(qty)   as '销量' FROM vw_dwd_fact_store_order_detail AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idJOIN vw_dwd_dim_store AS c ON a.store_id = c.store_idWHERE b.item_name = '基围虾'AND c.area_name = '华南区'AND year(date(a.business_date)) = year(curdate())AND month(date(a.business_date)) = month(curdate())
本月深圳XXX路店基围虾卖了多少斤？,SELECT sum(qty)   as '销量' FROM vw_dwd_fact_store_order_detail AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idJOIN vw_dwd_dim_store AS c ON a.store_id = c.store_idWHERE b.item_name = '基围虾'AND c.store_name = '深圳XXX路店'AND year(date(a.business_date)) = year(curdate())AND month(date(a.business_date)) = month(curdate())
本月鲜鸡蛋的销售趋势如何？,"SELECT date(business_date)   as '销售日期' , sum(qty)   as '销量' FROM vw_dwd_fact_store_order_detail AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idWHERE b.item_name = '鲜鸡蛋'AND year(date(a.business_date)) = year(curdate())AND month(date(a.business_date)) = month(curdate())GROUP BY date(business_date)ORDER BY date(business_date) ASC"
本月华南区鲜鸡蛋的销售趋势如何？,"SELECT date(business_date)   as '销售日期' , sum(qty)   as '销量' FROM vw_dwd_fact_store_order_detail AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idJOIN vw_dwd_dim_store AS c ON a.store_id = c.store_idWHERE b.item_name = '鲜鸡蛋'AND c.area_name = '华南区'AND year(date(a.business_date)) = year(curdate())AND month(date(a.business_date)) = month(curdate())GROUP BY date(business_date)ORDER BY date(business_date) ASC"
本月深圳XXX路店鲜鸡蛋的销售趋势如何？,"SELECT date(business_date)   as '销售日期' , sum(qty)   as '销量' FROM vw_dwd_fact_store_order_detail AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idJOIN vw_dwd_dim_store AS c ON a.store_id = c.store_idWHERE b.item_name = '鲜鸡蛋'AND c.store_name = '深圳XXX路店'AND year(date(a.business_date)) = year(curdate())AND month(date(a.business_date)) = month(curdate())GROUP BY date(business_date)ORDER BY date(business_date) ASC"
近7天芝麻酥糖的销售趋势怎样？,"SELECT date(business_date)   as '销售日期' , sum(qty)   as '销量' FROM vw_dwd_fact_store_order_detail AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idWHERE b.item_name = '芝麻酥糖'AND date(a.business_date) BETWEEN date_sub(curdate(), interval 7 day) AND curdate()GROUP BY date(business_date)ORDER BY date(business_date) ASC"
近7天华南区芝麻酥糖的销售趋势怎样？,"SELECT date(business_date)   as '销售日期' , sum(qty)   as '销量' FROM vw_dwd_fact_store_order_detail AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idJOIN vw_dwd_dim_store AS c ON a.store_id = c.store_idWHERE b.item_name = '芝麻酥糖'AND c.area_name = '华南区'AND date(a.business_date) BETWEEN date_sub(curdate(), interval 7 day) AND curdate()GROUP BY date(business_date)ORDER BY date(business_date) ASC"
近7天深圳XXX路店芝麻酥糖的销售趋势怎样？,"SELECT date(business_date)   as '销售日期' , sum(qty)   as '销量' FROM vw_dwd_fact_store_order_detail AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idJOIN vw_dwd_dim_store AS c ON a.store_id = c.store_idWHERE b.item_name = '芝麻酥糖'AND c.store_name = '深圳XXX路店'AND date(a.business_date) BETWEEN date_sub(curdate(), interval 7 day) AND curdate()GROUP BY date(business_date)ORDER BY date(business_date) ASC"
上个月粮油副食类销售最高的商品是哪些？,"SELECT b.item_name  as '商品名称' , sum(a.qty) as '销量' FROM vw_dwd_fact_store_order_detail AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idWHERE b.category_name_level1 = '粮油副食'AND year(a.business_date) = year(curdate() - interval 1 month)AND month(a.business_date) = month(curdate() - interval 1 month)GROUP BY b.item_nameORDER BY '销量'  DESCLIMIT 10"
上个月华南区粮油副食类销售最高的商品是哪些？,"SELECT b.item_name  as '商品名称' , sum(a.qty) as '销量'FROM vw_dwd_fact_store_order_detail AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idJOIN vw_dwd_dim_store AS c ON a.store_id = c.store_idWHERE b.category_name_level1 = '粮油副食'AND c.area_name = '华南区'AND year(a.business_date) = year(curdate() - interval 1 month)AND month(a.business_date) = month(curdate() - interval 1 month)GROUP BY b.item_nameORDER BY '销量' DESCLIMIT 10"
上个月深圳XXX路店粮油副食类销售最高的商品是哪些？,"SELECT b.item_name  as '商品名称' , sum(a.qty) as '销量'FROM vw_dwd_fact_store_order_detail AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idJOIN vw_dwd_dim_store AS c ON a.store_id = c.store_idWHERE b.category_name_level1 = '粮油副食'AND c.store_name = '深圳XXX路店'AND year(a.business_date) = year(curdate() - interval 1 month)AND month(a.business_date) = month(curdate() - interval 1 month)GROUP BY b.item_nameORDER BY '销量' DESCLIMIT 10"
昨天的客单数是多少？,"SELECT count(distinct order_id)   as '客单数' FROM vw_dwd_fact_store_order_detailWHERE date(business_date) = date_sub(curdate(), interval 1 day)"
今天华南区的客单数是多少？,SELECT count(distinct a.order_id)   as '客单数' FROM vw_dwd_fact_store_order_detail AS aJOIN vw_dwd_dim_store AS b ON a.store_id = b.store_idWHERE b.area_name = '华南区'AND date(a.business_date) = curdate()
今天深圳XXX路店的客单数是多少？,SELECT count(distinct order_id)   as '客单数' FROM vw_dwd_fact_store_order_detail AS aJOIN vw_dwd_dim_store AS b ON a.store_id = b.store_idWHERE b.store_name = '深圳XXX路店'AND date(a.business_date) = curdate()
本周与上周相比，客单数有何变化？,"select t1.this_week_customer_count  as '本周客单数'  ,t2.last_week_customer_count  as '上周客单数'  ,t1.this_week_customer_count-t2.last_week_customer_count  as '环比差额' ,(t1.this_week_customer_count-t2.last_week_customer_count)/t2.last_week_customer_count*100   as '环比变化率'from (select  count(distinct c.order_id) as this_week_customer_countfrom     vw_dwd_fact_store_order_detail cwhere year(c.business_date)=year(curdate()) and weekofyear(c.business_date) = weekofyear(curdate())) t1,(select  count(distinct c.order_id) as last_week_customer_countfrom     vw_dwd_fact_store_order_detail cwhere year(c.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(c.business_date) = weekofyear(date_sub(curdate(), interval 1 week))) t2"
本周与上周相比，华南区客单数有何变化？,"select t1.this_week_customer_count  as '本周客单数'  ,t2.last_week_customer_count  as '上周客单数'  ,t1.this_week_customer_count-t2.last_week_customer_count  as '环比差额' ,(t1.this_week_customer_count-t2.last_week_customer_count)/t2.last_week_customer_count*100   as '环比变化率'from (select count(distinct c.order_id) as this_week_customer_countfrom     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id=c.store_idwhere a.area_name = '华南区' andyear(c.business_date)=year(curdate()) and weekofyear(c.business_date) = weekofyear(curdate())) t1,(select count(distinct c.order_id) as last_week_customer_countfrom     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id=c.store_idwhere a.area_name = '华南区' andyear(c.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(c.business_date) = weekofyear(date_sub(curdate(), interval 1 week))) t2"
本周与上周相比，深圳XXX路店客单数有何变化？,"select t1.this_week_customer_count  as '本周客单数'  ,t2.last_week_customer_count  as '上周客单数'  ,t1.this_week_customer_count-t2.last_week_customer_count  as '环比差额' ,(t1.this_week_customer_count-t2.last_week_customer_count)/t2.last_week_customer_count*100   as '环比变化率'from (select count(distinct c.order_id) as this_week_customer_countfrom     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id=c.store_idwhere a.store_name = '深圳XXX路店' andyear(c.business_date)=year(curdate()) and weekofyear(c.business_date) = weekofyear(curdate())) t1,(select count(distinct c.order_id) as last_week_customer_countfrom     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id=c.store_idwhere a.store_name = '深圳XXX路店' andyear(c.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(c.business_date) = weekofyear(date_sub(curdate(), interval 1 week))) t2"
本月的客单数是多少？,SELECT count(distinct order_id)   as '客单数' FROM vw_dwd_fact_store_order_detailWHERE year(business_date) = year(curdate()) and month(business_date) = month(curdate())
本月华南区的客单数是多少？,SELECT count(distinct a.order_id)   as '客单数' FROM vw_dwd_fact_store_order_detail AS aJOIN vw_dwd_dim_store AS b ON a.store_id = b.store_idWHERE b.area_name = '华南区'AND year(a.business_date) = year(curdate()) and month(a.business_date) = month(curdate())
本月深圳XXX路店的客单数是多少？,SELECT count(distinct order_id)   as '客单数' FROM vw_dwd_fact_store_order_detail AS aJOIN vw_dwd_dim_store AS b ON a.store_id = b.store_idWHERE b.store_name = '深圳XXX路店'AND year(a.business_date) = year(curdate()) and month(a.business_date) = month(curdate())
上个月，哪些区域的客单数同比增长最快？,"SELECT area_name  as '区域名称' ,this_year_member_orders  as '上个月客单数'  ,last_year_member_orders  as '环比客单数' ,this_year_member_orders - last_year_member_orders  as '环比差额'  ,ifnull((this_year_member_orders - last_year_member_orders) / last_year_member_orders,0)*100   as '环比变化率' FROM(SELECT     b.area_name,    count(distinct case when (year(a.business_date)=year(date_sub(curdate(), interval 1 month))-1 and month(a.business_date) = month(date_sub(curdate(), interval 1 month))) then a.order_id else null end) as last_year_member_orders,    count(distinct case when (year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))) then a.order_id else null end) as this_year_member_ordersFROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idGROUP BY b.area_name) tORDER BY '同比变化率' descLIMIT 1"
昨天深圳XXX路店的客单数是多少？,"select     count(distinct c.order_id)   as '客单数' from     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idwhere     a.store_name = '深圳XXX路店' and c.business_date = date_sub(curdate(), interval 1 day)"
上个月，线上和线下渠道的客单数分别是多少？,"SELECT c.channel_name  as '渠道名称'  , count(distinct a.order_id)  as '客单数' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))GROUP BY c.channel_name"
上个月，华南区线上和线下渠道的客单数分别是多少？,"SELECT c.channel_name  as '渠道名称'  , count(distinct a.order_id)   as '客单数'FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idJOIN vw_dwd_dim_store as e on a.store_id = e.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))    and e.area_name = '华南区'GROUP BY c.channel_name"
上个月，深圳XXX路店线上和线下渠道的客单数分别是多少？,"SELECT c.channel_name  as '渠道名称'  , count(distinct a.order_id)   as '客单数' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idJOIN vw_dwd_dim_store as e on a.store_id = e.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))    and e.store_name = '深圳XXX路店'GROUP BY c.channel_name"
去年全年，客单数的月增长趋势如何？,"select     date_format(c.business_date, '%Y-%m')   as '月份' ,    ifnull(count(distinct c.order_id) - lag(count(distinct c.order_id)) over (order by date_format(c.business_date, '%Y-%m')),0)   as '客单增长数量' from     vw_dwd_fact_store_order_detail cwhere     year(c.business_date) = year(curdate()) - 1group by     date_format(c.business_date, '%Y-%m')order by     date_format(c.business_date, '%Y-%m')"
去年全年，华南区客单数的月增长趋势如何？,"select     date_format(c.business_date, '%Y-%m')   as '月份' ,    ifnull(count(distinct c.order_id) - lag(count(distinct c.order_id)) over (order by date_format(c.business_date, '%Y-%m')),0)   as '客单增长数量' from     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idwhere     a.area_name = '华南区' and year(c.business_date) = year(curdate()) - 1group by     date_format(c.business_date, '%Y-%m')order by     date_format(c.business_date, '%Y-%m')"
去年全年，深圳XXX路店客单数的月增长趋势如何？,"select     date_format(c.business_date, '%Y-%m')   as '月份' ,    ifnull(count(distinct c.order_id) - lag(count(distinct c.order_id)) over (order by date_format(c.business_date, '%Y-%m')),0)   as '客单增长数量' from     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idwhere     a.store_name = '深圳XXX路店' and year(c.business_date) = year(curdate()) - 1group by     date_format(c.business_date, '%Y-%m')order by     date_format(c.business_date, '%Y-%m')"
昨天的客单价是多少？,"select     sum(c.sales_amt) / count(distinct c.order_id)   as '客单价' from     vw_dwd_fact_store_order_detail cwhere     c.business_date = date_sub(curdate(), interval 1 day);"
华南区昨天的客单价是多少？,"select     sum(c.sales_amt) / count(distinct c.order_id)   as '客单价' from     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idwhere     a.area_name = '华南区' and c.business_date = date_sub(curdate(), interval 1 day);"
深圳XXX路店昨天的客单价是多少？,"select     sum(c.sales_amt) / count(distinct c.order_id)   as '客单价' from     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idwhere     a.store_name = '深圳XXX路店' and c.business_date = date_sub(curdate(), interval 1 day);"
本周与上周相比，客单价有何变化？,"select t1.this_week_order_price  as '本周客单价'  ,t2.last_week_order_price  as '上周客单价'  ,t1.this_week_order_price-t2.last_week_order_price  as '环比差额'  ,(t1.this_week_order_price-t2.last_week_order_price)/t2.last_week_order_price*100   as '环比变化率' from (select sum(c.sales_amt) / count(distinct c.order_id) as this_week_order_pricefrom     vw_dwd_fact_store_order_detail cwhere year(c.business_date)=year(curdate()) and weekofyear(c.business_date) = weekofyear(curdate())) t1,(select sum(c.sales_amt) / count(distinct c.order_id) as last_week_order_pricefrom     vw_dwd_fact_store_order_detail cwhere year(c.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(c.business_date) = weekofyear(date_sub(curdate(), interval 1 week))) t2"
华南区，本周与上周相比，客单价有何变化？,"select t1.this_week_order_price  as '本周客单价'  ,t2.last_week_order_price  as '上周客单价'  ,t1.this_week_order_price-t2.last_week_order_price  as '环比差额'  ,(t1.this_week_order_price-t2.last_week_order_price)/t2.last_week_order_price*100   as '环比变化率' from (select sum(c.sales_amt) / count(distinct c.order_id) as this_week_order_pricefrom     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id=c.store_idwhere a.area_name = '华南区' andyear(c.business_date)=year(curdate()) and weekofyear(c.business_date) = weekofyear(curdate())) t1,(select sum(c.sales_amt) / count(distinct c.order_id) as last_week_order_pricefrom     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id=c.store_idwhere a.area_name = '华南区' andyear(c.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(c.business_date) = weekofyear(date_sub(curdate(), interval 1 week))) t2"
深圳XXX路店，本周与上周相比，客单价有何变化？,"select t1.this_week_order_price  as '本周客单价'  ,t2.last_week_order_price  as '上周客单价'  ,t1.this_week_order_price-t2.last_week_order_price  as '环比差额'  ,(t1.this_week_order_price-t2.last_week_order_price)/t2.last_week_order_price*100   as '环比变化率' from (select sum(c.sales_amt) / count(distinct c.order_id) as this_week_order_pricefrom     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id=c.store_idwhere a.store_name = '深圳XXX路店' andyear(c.business_date)=year(curdate()) and weekofyear(c.business_date) = weekofyear(curdate())) t1,(select sum(c.sales_amt) / count(distinct c.order_id) as last_week_order_pricefrom     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id=c.store_idwhere a.store_name = '深圳XXX路店' andyear(c.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(c.business_date) = weekofyear(date_sub(curdate(), interval 1 week))) t2"
本月的客单价是多少？,SELECT sum(sales_amt) / count(distinct order_id)   as '客单价' FROM vw_dwd_fact_store_order_detailWHERE month(business_date) = month(curdate())    and year(business_date) = year(curdate())
华南区本月的客单价是多少？,SELECT sum(a.sales_amt) / count(distinct a.order_id)   as '客单价' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE month(a.business_date) = month(curdate())    and year(a.business_date) = year(curdate())    and b.area_name = '华南区'
深圳XXX路店本月的客单价是多少？,SELECT sum(a.sales_amt) / count(distinct a.order_id)   as '客单价' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE month(a.business_date) = month(curdate())    and year(a.business_date) = year(curdate())    and b.store_name = '深圳XXX路店'
上个月，哪些区域的客单价增长最快？,"select t1.area_name as '区域名称',t1.last_month_order_price  as '上个月客单价' ,t2.pre_last_month_order_price  as '环比客单价' ,t1.last_month_order_price-t2.pre_last_month_order_price  as '环比差额',(t1.last_month_order_price-t2.pre_last_month_order_price)/t2.pre_last_month_order_price*100 as '环比变化率' from (select a.area_name,sum(c.sales_amt) / count(distinct c.order_id) as last_month_order_pricefrom     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id=c.store_idwhere year(c.business_date)=year(date_sub(curdate(), interval 1 month)) and month(c.business_date) = month(date_sub(curdate(), interval 1 month))group by 1)t1join (select a.area_name,sum(c.sales_amt) / count(distinct c.order_id) as pre_last_month_order_pricefrom     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id=c.store_idwhere year(c.business_date)=year(date_sub(curdate(), interval 2 month)) and month(c.business_date) = month(date_sub(curdate(), interval 2 month))group by 1)t2 on t1.area_name=t2.area_nameorder by '环比变化率'  desc"
昨天深圳XXX路店的客单价是多少？,SELECT sum(a.sales_amt) / count(distinct a.order_id)   as '客单价' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE date(a.business_date) = date(curdate() - interval 1 day)    and b.store_name = '深圳XXX路店'
上个月，线上和线下渠道的客单价分别是多少？,"SELECT c.channel_name  as '渠道名称'  , sum(a.sales_amt) / count(distinct a.order_id)   as '客单价' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))GROUP BY c.channel_name"
华南区上个月，线上和线下渠道的客单价分别是多少？,"SELECT c.channel_name  as '渠道名称'  , sum(a.sales_amt) / count(distinct a.order_id)   as '客单价' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idJOIN vw_dwd_dim_store as e on a.store_id = e.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))    and e.area_name = '华南区'GROUP BY c.channel_name"
深圳XXX路店上个月，线上和线下渠道的客单价分别是多少？,"SELECT c.channel_name  as '渠道名称'  , sum(a.sales_amt) / count(distinct a.order_id)   as '客单价' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idJOIN vw_dwd_dim_store as e on a.store_id = e.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))    and e.store_name = '深圳XXX路店'GROUP BY c.channel_name"
去年全年，客单价的月增长趋势如何？,"select month  as '月份' ,case when pre_order_price=0 then 0 else  (order_price-pre_order_price)/pre_order_price*100 end   as '客单价增长率' from (select date_format(c.business_date, '%Y-%m') as month,sum(c.sales_amt) / count(distinct c.order_id) as order_price,ifnull(lag(sum(c.sales_amt) / count(distinct c.order_id)) over (order by  date_format(c.business_date, '%Y-%m')),0) as pre_order_pricefrom  vw_dwd_fact_store_order_detail c whereyear(c.business_date)=year(curdate())-1group by 1) t1"
去年全年，华南区客单价的月增长趋势如何？,"select month  as '月份' ,case when pre_order_price=0 then 0 else  (order_price-pre_order_price)/pre_order_price*100 end   as '客单价增长率' from (select date_format(c.business_date, '%Y-%m') as month,sum(c.sales_amt) / count(distinct c.order_id) as order_price,ifnull(lag(sum(c.sales_amt) / count(distinct c.order_id)) over (order by  date_format(c.business_date, '%Y-%m')),0) as pre_order_pricefrom     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id=c.store_idwhere a.area_name = '华南区' andyear(c.business_date)=year(curdate())-1group by 1) t1"
去年全年，深圳XXX路店客单价的月增长趋势如何？,"select month  as '月份' ,case when pre_order_price=0 then 0 else  (order_price-pre_order_price)/pre_order_price*100 end   as '客单价增长率' from (select date_format(c.business_date, '%Y-%m') as month,sum(c.sales_amt) / count(distinct c.order_id) as order_price,ifnull(lag(sum(c.sales_amt) / count(distinct c.order_id)) over (order by  date_format(c.business_date, '%Y-%m')),0) as pre_order_pricefrom     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id=c.store_idwhere a.store_name='深圳XXX路店' andyear(c.business_date)=year(curdate())-1group by 1) t1"
本月的客单数、客单价是多少？,"SELECT count(distinct order_id)   as '客单数' , sum(sales_amt) / count(distinct order_id)   as '客单价' FROM vw_dwd_fact_store_order_detailWHERE month(business_date) = month(curdate())    and year(business_date) = year(curdate())"
本月各大区的客单数、客单价是多少？,"SELECT b.area_name  as '区域名称' , count(distinct a.order_id)   as '客单数' , sum(a.sales_amt) / count(distinct a.order_id)   as '客单价' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE month(a.business_date) = month(curdate())    and year(a.business_date) = year(curdate())GROUP BY b.area_name"
深圳XXX路店本月的客单数 、客单价是多少？,"SELECT count(distinct a.order_id)   as '客单数' , sum(a.sales_amt) / count(distinct a.order_id)   as '客单价' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE month(a.business_date) = month(curdate())    and year(a.business_date) = year(curdate())    and b.store_name = '深圳XXX路店'"
昨天的销售成本额是多少？,"select sum(sales_cost_amt)   as '销售成本额'  from vw_dwd_fact_store_item_cost_daily where business_date=date_sub(curdate(), interval 1 day)"
华南区昨天的销售成本额是多少？,"select sum(a.sales_cost_amt)   as '销售成本额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_idwhere a.business_date=date_sub(curdate(), interval 1 day) and b.area_name='华南区'"
深圳XXX路店昨天的销售成本额是多少？,"select sum(a.sales_cost_amt)   as '销售成本额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_idwhere a.business_date=date_sub(curdate(), interval 1 day) and b.store_name='深圳XXX路店'"
上个月每个区域的销售成本额分别是多少？,"select b.area_name  as '区域名称' , sum(a.sales_cost_amt)   as '销售成本额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_idwhere year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))group by b.area_nameorder by '销售成本额' "
3月份每天的销售成本额如何？,"select business_date  as '销售日期' , sum(sales_cost_amt)   as '销售成本额' from vw_dwd_fact_store_item_cost_dailywhere year(business_date)=year(curdate())  and month(business_date) = 3group by business_dateorder by business_date"
华南区3月份每天的销售成本额如何？,"select a.business_date  as '销售日期' , sum(a.sales_cost_amt)   as '销售成本额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_idwhere year(a.business_date)=year(curdate())  and month(a.business_date) = 3 and b.area_name='华南区'group by a.business_dateorder by a.business_date"
深圳XXX路店3月份每天的销售成本额如何？,"select a.business_date  as '销售日期' , sum(a.sales_cost_amt)   as '销售成本额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_idwhere year(a.business_date)=year(curdate())  and month(a.business_date) = 3 and b.store_name = '深圳XXX路店'group by a.business_dateorder by a.business_date"
本季度到目前为止，深圳XXX路店和广州XXX路店各自的销售成本额是多少？,"select b.store_name  as '门店名称' , sum(a.sales_cost_amt)    as '销售成本额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_idwhere year(a.business_date)=year(curdate()) and quarter(a.business_date) = quarter(curdate()) and a.business_date<=curdate() and b.store_name in ('深圳XXX路店', '广州XXX路店')group by b.store_nameorder by  '销售成本额' desc"
去年，婴儿用品品类的销售成本额是多少？,select sum(a.sales_cost_amt)   as '销售成本额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item b on a.item_id = b.item_idwhere year(a.business_date) = year(curdate())-1 and b.category_name_level1='婴儿用品'
去年，华南区婴儿用品品类的销售成本额是多少？,select sum(a.sales_cost_amt) as '销售成本额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item b on a.item_id = b.item_idjoin vw_dwd_dim_store c on a.store_id = c.store_idwhere year(a.business_date) = year(curdate())-1 and b.category_name_level1='婴儿用品' and c.area_name='华南区'
去年，深圳XXX路店婴儿用品品类的销售成本额是多少？,select sum(a.sales_cost_amt)   as '销售成本额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item b on a.item_id = b.item_idjoin vw_dwd_dim_store c on a.store_id = c.store_idwhere year(a.business_date) = year(curdate())-1 and b.category_name_level1='婴儿用品' and c.store_name = '深圳XXX路店'
本月的毛利额是多少？,select sum(profit_amt)   as '毛利额' from vw_dwd_fact_store_item_cost_dailywhere month(business_date) = month(curdate()) and year(business_date) = year(curdate())
华南区本月的毛利额是多少？,select sum(a.profit_amt)   as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_idwhere month(a.business_date) = month(curdate()) and year(a.business_date) = year(curdate()) and b.area_name='华南区'
深圳XXX路店本月的毛利额是多少？,select sum(a.profit_amt)   as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_idwhere month(a.business_date) = month(curdate()) and year(a.business_date) = year(curdate()) and b.store_name = '深圳XXX路店'
深圳XXX路店婴儿用品品类本月的毛利额是多少？,select sum(a.profit_amt)   as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item b on a.item_id = b.item_idjoin vw_dwd_dim_store c on a.store_id = c.store_idwhere month(a.business_date) = month(curdate()) and year(a.business_date) = year(curdate()) and b.category_name_level1='婴儿用品' and c.store_name='深圳XXX路店'
5月的毛利额是多少？,select sum(profit_amt)   as '毛利额' from vw_dwd_fact_store_item_cost_dailywhere month(business_date) = 5 and year(business_date) = year(curdate())
华南区5月的毛利额是多少？,select sum(a.profit_amt)   as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_idwhere month(a.business_date) = 5 and year(a.business_date) = year(curdate()) and b.area_name='华南区'
深圳XXX路店5月的毛利额是多少？,select sum(a.profit_amt)   as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_idwhere month(a.business_date) = 5 and year(a.business_date) = year(curdate()) and b.store_name = '深圳XXX路店'
深圳XXX路店婴儿用品品类5月的毛利额是多少？,select sum(a.profit_amt)   as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item b on a.item_id = b.item_idjoin vw_dwd_dim_store c on a.store_id = c.store_idwhere month(a.business_date) = 5 and year(a.business_date) = year(curdate()) and b.category_name_level1='婴儿用品' and c.store_name='深圳XXX路店'
上个月各区域的毛利额分别是多少？,"select b.area_name  as '区域名称' , sum(a.profit_amt)   as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_idwhere month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and year(a.business_date) = year(date_sub(curdate(), interval 1 month))group by b.area_name order by '毛利额' desc"
昨天各门店的毛利额排名情况如何？,"select c.store_name  as '门店名称' , sum(a.profit_amt)   as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store c on a.store_id = c.store_idwhere a.business_date = date_sub(curdate(), interval 1 day)group by c.store_nameorder by '毛利额' desc"
昨天华南区各门店的毛利额排名情况如何？,"select c.store_name  as '门店名称' , sum(a.profit_amt)    as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store c on a.store_id = c.store_idwhere a.business_date = date_sub(curdate(), interval 1 day) and c.area_name='华南区'group by c.store_nameorder by '毛利额' desc"
5月9号各门店的毛利额排名情况如何？,"select c.store_name  as '门店名称' , sum(a.profit_amt)   as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store c on a.store_id = c.store_idwhere a.business_date = '2024-05-09'group by c.store_nameorder by '毛利额' desc"
华南区5月9号各门店的毛利额排名情况如何？,"select c.store_name  as '门店名称' , sum(a.profit_amt)   as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store c on a.store_id = c.store_idwhere a.business_date = '2024-05-09' and c.area_name='华南区'group by c.store_nameorder by '毛利额' desc"
上个月毛利额最高的前五个品类是什么？,"select d.category_name_level1  as '大类名称' , sum(a.profit_amt)   as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item d on a.item_id = d.item_idwhere month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and year(a.business_date) = year(date_sub(curdate(), interval 1 month))group by d.category_name_level1order by '毛利额' desclimit 5"
华南区上个月毛利额最高的前五个品类是什么？,"select d.category_name_level1  as '大类名称' , sum(a.profit_amt)   as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item d on a.item_id = d.item_idjoin vw_dwd_dim_store c on a.store_id = c.store_idwhere month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and year(a.business_date) = year(date_sub(curdate(), interval 1 month)) and c.area_name='华南区'group by d.category_name_level1order by '毛利额' desclimit 5"
深圳XXX路店上个月毛利额最高的前五个品类是什么？,"select d.category_name_level1  as '大类名称' , sum(a.profit_amt)   as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item d on a.item_id = d.item_idjoin vw_dwd_dim_store c on a.store_id = c.store_idwhere month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and year(a.business_date) = year(date_sub(curdate(), interval 1 month)) and c.store_name='深圳XXX路店'group by d.category_name_level1order by '毛利额' desclimit 5"
上周鲜鸡蛋的毛利额是多少？,"select sum(a.profit_amt)   as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item d on a.item_id = d.item_idwhere year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week))and d.item_name='鲜鸡蛋'"
华南区上周鲜鸡蛋的毛利额是多少？,"select sum(a.profit_amt)   as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item d on a.item_id = d.item_idjoin vw_dwd_dim_store c on a.store_id = c.store_idwhere year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week))and d.item_name='鲜鸡蛋' and c.area_name='华南区'"
深圳XXX路店上周鲜鸡蛋的毛利额是多少？,"select sum(a.profit_amt)   as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item d on a.item_id = d.item_idjoin vw_dwd_dim_store c on a.store_id = c.store_idwhere year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week))and d.item_name='鲜鸡蛋' and c.store_name = '深圳XXX路店'"
上月婴儿用品毛利额占总毛利额的百分比是多少？,"select     (sum(case when d.category_name_level1 = '婴儿用品' then a.profit_amt else 0 end) / sum(a.profit_amt)) * 100   as '毛利额占比' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item d on a.item_id = d.item_idwhere month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and year(a.business_date) = year(date_sub(curdate(), interval 1 month))"
华南区上月婴儿用品毛利额占总毛利额的百分比是多少？,"select     (sum(case when d.category_name_level1 = '婴儿用品' then a.profit_amt else 0 end) / sum(a.profit_amt)) * 100   as '毛利额占比' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item d on a.item_id = d.item_idjoin vw_dwd_dim_store c on a.store_id = c.store_idwhere month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and year(a.business_date) = year(date_sub(curdate(), interval 1 month)) and c.area_name='华南区'"
深圳XXX路店上月婴儿用品毛利额占总毛利额的百分比是多少？,"select     (sum(case when d.category_name_level1 = '婴儿用品' then a.profit_amt else 0 end) / sum(a.profit_amt)) * 100   as '毛利额占比' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item d on a.item_id = d.item_idjoin vw_dwd_dim_store c on a.store_id = c.store_idwhere month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and year(a.business_date) = year(date_sub(curdate(), interval 1 month)) and c.store_name = '深圳XXX路店'"
今年的累计毛利额是多少？,select sum(profit_amt)   as '毛利额'  from vw_dwd_fact_store_item_cost_daily where year(business_date) = year(curdate())
华南区今年的累计毛利额是多少？,select sum(a.profit_amt)   as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store c on a.store_id = c.store_idwhere year(a.business_date) = year(curdate()) and c.area_name='华南区'
深圳XXX路店今年的累计毛利额是多少？,select sum(a.profit_amt)   as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store c on a.store_id = c.store_idwhere year(a.business_date) = year(curdate()) and c.store_name = '深圳XXX路店'
深圳XXX路店婴儿用品品类今年的累计毛利额是多少？,select sum(a.profit_amt)   as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item d on a.item_id = d.item_idjoin vw_dwd_dim_store c on a.store_id = c.store_idwhere year(a.business_date) = year(curdate()) and c.store_name='深圳XXX路店' and d.category_name_level1='婴儿用品'
上个月毛利额在所有品类中的分布情况是怎样的？,"select d.category_name_level1  as '大类名称' , sum(a.profit_amt)   as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item d on a.item_id = d.item_idwhere month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and year(a.business_date) = year(date_sub(curdate(), interval 1 month))group by d.category_name_level1order by  '毛利额' desc"
华南区上个月毛利额在所有品类中的分布情况是怎样的？,"select d.category_name_level1  as '大类名称' , sum(a.profit_amt)   as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item d on a.item_id = d.item_idjoin vw_dwd_dim_store c on a.store_id = c.store_idwhere month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and year(a.business_date) = year(date_sub(curdate(), interval 1 month)) and c.area_name='华南区'group by d.category_name_level1order by '毛利额' desc"
深圳XXX路店上个月毛利额在所有品类中的分布情况是怎样的？,"select d.category_name_level1  as '大类名称' , sum(a.profit_amt)   as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item d on a.item_id = d.item_idjoin vw_dwd_dim_store c on a.store_id = c.store_idwhere month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and year(a.business_date) = year(date_sub(curdate(), interval 1 month)) and c.store_name = '深圳XXX路店'group by d.category_name_level1order by '毛利额' desc"
四月毛利额在所有品类中的分布情况是怎样的？,"select d.category_name_level1  as '大类名称' , sum(a.profit_amt)   as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item d on a.item_id = d.item_idwhere month(a.business_date) = 4 and year(a.business_date) = year(curdate())group by d.category_name_level1order by '毛利额' desc"
华南区四月毛利额在所有品类中的分布情况是怎样的？,"select d.category_name_level1  as '大类名称' , sum(a.profit_amt)   as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item d on a.item_id = d.item_idjoin vw_dwd_dim_store c on a.store_id = c.store_idwhere month(a.business_date) = 4 and year(a.business_date) = year(curdate()) and c.area_name='华南区'group by d.category_name_level1order by '毛利额' desc"
深圳XXX路店四月毛利额在所有品类中的分布情况是怎样的？,"select d.category_name_level1  as '大类名称' , sum(a.profit_amt)   as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item d on a.item_id = d.item_idjoin vw_dwd_dim_store c on a.store_id = c.store_idwhere month(a.business_date) = 4 and year(a.business_date) = year(curdate()) and c.store_name = '深圳XXX路店'group by d.category_name_level1order by '毛利额' desc"
昨天毛利额最高的前十个商品是什么？,"select b.item_name  as '商品名称' , sum(a.profit_amt) as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item b on a.item_id = b.item_idwhere a.business_date = date_sub(curdate(), interval 1 day)group by b.item_nameorder by '毛利额' desclimit 10"
华南区昨天毛利额最高的前十个商品是什么？,"select b.item_name  as '商品名称' , sum(a.profit_amt) as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item b on a.item_id = b.item_idjoin vw_dwd_dim_store c on a.store_id = c.store_idwhere a.business_date = date_sub(curdate(), interval 1 day) and c.area_name='华南区'group by b.item_nameorder by  '毛利额' desclimit 10"
深圳XXX路店昨天毛利额最高的前十个商品是什么？,"select b.item_name  as '商品名称' , sum(a.profit_amt) as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item b on a.item_id = b.item_idjoin vw_dwd_dim_store c on a.store_id = c.store_idwhere a.business_date = date_sub(curdate(), interval 1 day) and c.store_name = '深圳XXX路店'group by b.item_nameorder by  '毛利额' desclimit 10"
深圳XXX路店婴儿用品品类昨天毛利额最高的前十个商品是什么？,"select b.item_name  as '商品名称' , sum(a.profit_amt) as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item b on a.item_id = b.item_idjoin vw_dwd_dim_store c on a.store_id = c.store_idwhere a.business_date = date_sub(curdate(), interval 1 day) and c.store_name='深圳XXX路店' and b.category_name_level1='婴儿用品'group by b.item_nameorder by  '毛利额' desclimit 10"
深圳XXX路店花生油小类昨天毛利额最高的前十个商品是什么？,"select b.item_name  as '商品名称' , sum(a.profit_amt) as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item b on a.item_id = b.item_idjoin vw_dwd_dim_store c on a.store_id = c.store_idwhere a.business_date = date_sub(curdate(), interval 1 day) and c.store_name='深圳XXX路店' and b.category_name_level3='花生油'group by b.item_nameorder by  '毛利额' desclimit 10"
5月9号毛利额最高的前十个商品是什么？,"select b.item_name  as '商品名称' , sum(a.profit_amt) as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item b on a.item_id = b.item_idwhere a.business_date = '2024-05-09'group by b.item_nameorder by  '毛利额' desclimit 10"
华南区5月9号毛利额最高的前十个商品是什么？,"select b.item_name  as '商品名称' , sum(a.profit_amt) as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item b on a.item_id = b.item_idjoin vw_dwd_dim_store c on a.store_id = c.store_idwhere a.business_date = '2024-05-09' and c.area_name='华南区'group by b.item_nameorder by  '毛利额' desclimit 10"
深圳XXX路店5月9号毛利额最高的前十个商品是什么？,"select b.item_name  as '商品名称' , sum(a.profit_amt) as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item b on a.item_id = b.item_idjoin vw_dwd_dim_store c on a.store_id = c.store_idwhere a.business_date = '2024-05-09' and c.store_name = '深圳XXX路店'group by b.item_nameorder by  '毛利额' desclimit 10"
华南区婴儿用品品类5月9号毛利额最高的前十个商品是什么？,"select b.item_name  as '商品名称' , sum(a.profit_amt) as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item b on a.item_id = b.item_idjoin vw_dwd_dim_store c on a.store_id = c.store_idwhere a.business_date = '2024-05-09' and c.area_name='华南区' and b.category_name_level1='婴儿用品'group by b.item_nameorder by  '毛利额' desclimit 10"
华南区花生油小类5月9号毛利额最高的前十个商品是什么？,"select b.item_name  as '商品名称' , sum(a.profit_amt) as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item b on a.item_id = b.item_idjoin vw_dwd_dim_store c on a.store_id = c.store_idwhere a.business_date = '2024-05-09' and c.area_name='华南区' and b.category_name_level3='花生油'group by b.item_nameorder by '毛利额' desclimit 10"
今年的总计划毛利额是多少？,SELECT SUM(budget_profit_amt)  as '计划毛利额'  FROM vw_dwd_fact_store_budget WHERE year_id=YEAR(NOW())
这个月的计划毛利额是多少？,"SELECT SUM(budget_profit_amt)  as '计划毛利额'  FROM vw_dwd_fact_store_budget budget WHERE  budget.year_id=year(CURDATE()) AND budget.month_id=date_format(CURDATE(), '%Y%m')"
这个月华南区的计划毛利额是多少？,"SELECT SUM(budget_profit_amt)  as '计划毛利额'  FROM vw_dwd_fact_store_budget budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE  budget.year_id=year(CURDATE()) AND budget.month_id=date_format(CURDATE(), '%Y%m')AND store.area_name = '华南区'"
这个月深圳XXX路店的计划毛利额是多少？,"SELECT SUM(budget_profit_amt)  as '计划毛利额'  FROM vw_dwd_fact_store_budget budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE  budget.year_id=year(CURDATE()) AND budget.month_id=date_format(CURDATE(), '%Y%m')AND store.store_name='深圳XXX路店'"
这个月婴儿用品品类的计划毛利额是多少？,"SELECT SUM(budget_profit_amt)   as '计划毛利额'  FROM vw_dwd_fact_store_budget budget JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_idWHERE  budget.year_id=year(CURDATE()) AND budget.month_id=date_format(CURDATE(), '%Y%m')AND category.category_name='婴儿用品'"
华南区这个月婴儿用品品类的计划毛利额是多少？,"SELECT SUM(budget_profit_amt)   as '计划毛利额'  FROM vw_dwd_fact_store_budget budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_idWHERE  budget.year_id=year(CURDATE()) AND budget.month_id=date_format(CURDATE(), '%Y%m')AND store.area_name = '华南区' AND category.category_name='婴儿用品'"
深圳XXX路店这个月婴儿用品品类的计划毛利额是多少？,"SELECT SUM(budget_profit_amt) as '计划毛利额' FROM vw_dwd_fact_store_budget budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_idWHERE  budget.year_id=year(CURDATE()) AND budget.month_id=date_format(CURDATE(), '%Y%m')AND store.store_name = '深圳XXX路店' AND category.category_name='婴儿用品'"
这个月各个区域的计划毛利额是多少？,"SELECT store.area_name  as '区域名称' ,SUM(budget_profit_amt) as '计划毛利额' FROM vw_dwd_fact_store_budget budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE  budget.year_id=year(CURDATE()) AND budget.month_id=date_format(CURDATE(), '%Y%m')GROUP BY store.area_nameORDER BY '计划毛利额' DESC "
这个月各个品类的计划毛利额是多少？,"SELECT category.category_name  as '大类名称' ,SUM(budget_profit_amt) as '计划毛利额' FROM vw_dwd_fact_store_budget budget JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_idWHERE  budget.year_id=year(CURDATE()) AND budget.month_id=date_format(CURDATE(), '%Y%m')GROUP BY category.category_nameORDER BY '计划毛利额' DESC "
华南区这个月各个品类的计划毛利额是多少？,"SELECT category.category_name  as '大类名称' ,SUM(budget_profit_amt) as '计划毛利额' FROM vw_dwd_fact_store_budget budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_idWHERE  budget.year_id=year(CURDATE()) AND budget.month_id=date_format(CURDATE(), '%Y%m') AND store.area_name = '华南区'GROUP BY category.category_nameORDER BY '计划毛利额' DESC "
深圳XXX路店这个月各个品类的计划毛利额是多少？,"SELECT category.category_name  as '大类名称' ,SUM(budget_profit_amt) as '计划毛利额' FROM vw_dwd_fact_store_budget budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_idWHERE  budget.year_id=year(CURDATE()) AND budget.month_id=date_format(CURDATE(), '%Y%m') AND store.store_name = '深圳XXX路店'GROUP BY category.category_nameORDER BY '计划毛利额' DESC "
上个月的毛利额达成率是多少？,"SELECT SUM(profit_amt)/SUM(budget_profit_amt) *100  as '毛利额达成率' FROM vw_dwd_fact_store_budget WHERE year_id=YEAR(DATE_SUB(NOW(), INTERVAL 1 MONTH)) AND month_id=date_format(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m')"
各个大区上个月的毛利额达成率是多少？,"SELECT store.area_name  as '区域名称' ,SUM(budget.profit_amt)/SUM(budget.budget_profit_amt)*100    as '毛利额达成率'  FROM vw_dwd_fact_store_budget AS budgetJOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(DATE_SUB(NOW(), INTERVAL 1 MONTH)) AND budget.month_id=date_format(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m')GROUP BY store.area_nameORDER BY '毛利额达成率'  DESC"
各个品类上个月的毛利额达成率是多少？,"SELECT category.category_name  as '大类名称' ,SUM(budget.profit_amt)/SUM(budget.budget_profit_amt)*100    as '毛利额达成率'  FROM vw_dwd_fact_store_budget AS budgetJOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_idWHERE budget.year_id=YEAR(DATE_SUB(NOW(), INTERVAL 1 MONTH)) AND budget.month_id=date_format(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m')GROUP BY category.category_nameORDER BY '毛利额达成率' DESC"
华南区各个品类上个月的毛利额达成率是多少？,"SELECT category.category_name  as '大类名称' , SUM(budget.profit_amt)/SUM(budget.budget_profit_amt)*100    as '毛利额达成率'  FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_id WHERE store.area_name='华南区'  AND budget.year_id=YEAR(DATE_SUB(NOW(), INTERVAL 1 MONTH)) AND budget.month_id=DATE_FORMAT(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m')GROUP BY category.category_nameORDER BY '毛利额达成率'  DESC"
深圳XXX路店各个品类上个月的毛利额达成率是多少？,"SELECT category.category_name  as '大类名称' , SUM(budget.profit_amt)/SUM(budget.budget_profit_amt)*100    as '毛利额达成率'  FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_id WHERE store.store_name = '深圳XXX路店' AND budget.year_id=YEAR(DATE_SUB(NOW(), INTERVAL 1 MONTH)) AND budget.month_id=DATE_FORMAT(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m')GROUP BY category.category_nameORDER BY  '毛利额达成率'  DESC"
华南区上个月的毛利额达成率是多少？,"SELECT  SUM(budget.profit_amt)/SUM(budget.budget_profit_amt)*100   as '毛利额达成率'  FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE store.area_name='华南区' AND budget.year_id=YEAR(DATE_SUB(NOW(), INTERVAL 1 MONTH)) AND budget.month_id=DATE_FORMAT(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m')"
深圳XXX路店上个月的毛利额达成率是多少？,"SELECT  SUM(budget.profit_amt)/SUM(budget.budget_profit_amt) *100  as '毛利额达成率'  FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE store.store_name = '深圳XXX路店' AND budget.year_id=YEAR(DATE_SUB(NOW(), INTERVAL 1 MONTH)) AND budget.month_id=DATE_FORMAT(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m')"
深圳XXX路店婴儿用品品类上个月的毛利额达成率是多少？,"SELECT  SUM(budget.profit_amt)/SUM(budget.budget_profit_amt) *100  as '毛利额达成率'  FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_idWHERE store.store_name = '深圳XXX路店' AND budget.year_id=YEAR(DATE_SUB(NOW(), INTERVAL 1 MONTH)) AND budget.month_id=DATE_FORMAT(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m') AND category.category_name='婴儿用品'"
与上个月相比，本月份的毛利额达成率有何变化？,"SELECT t1.profit_achievement_rate*100  as '本月毛利额达成率' ,t2.profit_achievement_rate*100  as '上个月毛利额达成率' ,t1.profit_achievement_rate-t2.profit_achievement_rate  as '环比差额'  ,(t1.profit_achievement_rate-t2.profit_achievement_rate)/t2.profit_achievement_rate*100   as '环比变化率' FROM(SELECT SUM(profit_amt)/SUM(budget_profit_amt)   as profit_achievement_rate FROM vw_dwd_fact_store_budget WHERE year_id=YEAR(CURDATE()) AND month_id=date_format(CURDATE(), '%Y%m')) t1,(SELECT SUM(profit_amt)/SUM(budget_profit_amt)   as profit_achievement_rate FROM vw_dwd_fact_store_budget WHERE year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND month_id=date_format(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m')) t2"
与上个月相比，华南区本月份的毛利额达成率有何变化？,"SELECT t1.profit_achievement_rate*100  as '本月毛利额达成率' ,t2.profit_achievement_rate*100  as '上个月毛利额达成率' ,t1.profit_achievement_rate-t2.profit_achievement_rate  as '环比差额'  ,(t1.profit_achievement_rate-t2.profit_achievement_rate)/t2.profit_achievement_rate*100   as '环比变化率'  FROM(SELECT SUM(budget.profit_amt)/SUM(budget.budget_profit_amt)   as profit_achievement_rateFROM vw_dwd_fact_store_budget  AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(CURDATE()) AND budget.month_id=date_format(CURDATE(), '%Y%m') AND store.area_name='华南区') t1,(SELECT SUM(budget.profit_amt)/SUM(budget.budget_profit_amt)   as profit_achievement_rate FROM vw_dwd_fact_store_budget  AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND budget.month_id=date_format(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m') AND store.area_name='华南区') t2"
与上个月相比，深圳XXX路店本月份的毛利额达成率有何变化？,"SELECT t1.profit_achievement_rate*100  as '本月毛利额达成率' ,t2.profit_achievement_rate*100  as '上个月毛利额达成率' ,t1.profit_achievement_rate-t2.profit_achievement_rate  as '环比差额'  ,(t1.profit_achievement_rate-t2.profit_achievement_rate)/t2.profit_achievement_rate*100   as '环比变化率'  FROM(SELECT SUM(budget.profit_amt)/SUM(budget.budget_profit_amt)   as profit_achievement_rateFROM vw_dwd_fact_store_budget  AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(CURDATE()) AND budget.month_id=date_format(CURDATE(), '%Y%m') AND store.store_name = '深圳XXX路店') t1,(SELECT SUM(budget.profit_amt)/SUM(budget.budget_profit_amt)   as profit_achievement_rateFROM vw_dwd_fact_store_budget  AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND budget.month_id=date_format(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m') AND store.store_name = '深圳XXX路店') t2"
与上个月相比，深圳XXX路店婴儿用品品类本月份的毛利额达成率有何变化？,"SELECT t1.profit_achievement_rate*100  as '本月毛利额达成率' ,t2.profit_achievement_rate*100  as '上个月毛利额达成率' ,t1.profit_achievement_rate-t2.profit_achievement_rate  as '环比差额'  ,(t1.profit_achievement_rate-t2.profit_achievement_rate)/t2.profit_achievement_rate*100   as '环比变化率'  FROM(SELECT SUM(budget.profit_amt)/SUM(budget.budget_profit_amt)   as profit_achievement_rateFROM vw_dwd_fact_store_budget  AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_idWHERE budget.year_id=YEAR(CURDATE()) AND budget.month_id=date_format(CURDATE(), '%Y%m') AND store.store_name = '深圳XXX路店' AND category.category_name='婴儿用品') t1,(SELECT SUM(budget.profit_amt)/SUM(budget.budget_profit_amt)   as profit_achievement_rateFROM vw_dwd_fact_store_budget  AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_idWHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND budget.month_id=date_format(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m') AND store.store_name = '深圳XXX路店' AND category.category_name='婴儿用品') t2"
上个月，哪些区域的毛利额达成率表现最佳？,"SELECT area_name  as '区域名称' , SUM(profit_amt)/SUM(budget_profit_amt)*100    as '毛利额达成率'  FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND budget.month_id=date_format(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m')GROUP BY area_name ORDER BY '毛利额达成率' DESC "
今年至今，哪些门店的毛利额达成率最差？,"SELECT store_name  as '门店名称' , SUM(profit_amt)/SUM(budget_profit_amt) *100   as '毛利额达成率'  FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(CURDATE()) GROUP BY store_name ORDER BY '毛利额达成率' asc "
今年至今，华南区哪些门店的毛利额达成率最差？,"SELECT store.store_name  as '门店名称' , SUM(budget.profit_amt)/SUM(budget.budget_profit_amt) *100   as '毛利额达成率'  FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(CURDATE()) and store.area_name='华南区'GROUP BY store.store_name ORDER BY '毛利额达成率'  asc "
上个月，在所有门店中，北京XXX路店的毛利额达成率排第几名？,"SELECT profit_achievement_rate_rank  as '毛利达成率排名' FROM (SELECT store.store_name, SUM(budget.profit_amt)/SUM(budget.budget_profit_amt)*100   as '毛利额达成率' ,ROW_NUMBER() OVER (ORDER BY SUM(budget.profit_amt)/SUM(budget.budget_profit_amt) DESC)   as profit_achievement_rate_rankFROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND budget.month_id=date_format(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m')GROUP BY store.store_name ) t1 WHERE t1.store_name='北京XXX路店'"
上个月，在华南区所有门店中，广州XXX路店的毛利额达成率排第几名？,"SELECT profit_achievement_rate_rank  as '毛利达成率排名' FROM (SELECT store.store_name, SUM(budget.profit_amt)/SUM(budget.budget_profit_amt)*100   as '毛利额达成率' ,ROW_NUMBER() OVER (ORDER BY SUM(budget.profit_amt)/SUM(budget.budget_profit_amt) DESC)   as profit_achievement_rate_rankFROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND budget.month_id=date_format(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m') AND store.area_name='华南区'GROUP BY store.store_name ) t1 WHERE t1.store_name='广州XXX路店'"
上个月，哪个品类的毛利达成率最高？,"SELECT category.category_name  as '大类名称' , IFNULL(SUM(budget.profit_amt)/SUM(budget.budget_profit_amt),0) *100   as '毛利额达成率' FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_idWHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND budget.month_id=date_format(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m')GROUP BY category.category_nameORDER BY '毛利额达成率' DESCLIMIT 1"
上个月，华南区哪个品类的毛利达成率最高？,"SELECT category.category_name  as '大类名称' , IFNULL(SUM(budget.profit_amt)/SUM(budget.budget_profit_amt),0) *100   as '毛利额达成率' FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_idJOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND budget.month_id=date_format(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m') AND store.area_name='华南区'GROUP BY category.category_nameORDER BY '毛利额达成率' DESCLIMIT 1"
上个月，深圳XXX路店哪个品类的毛利达成率最高？,"SELECT category.category_name  as '大类名称' , IFNULL(SUM(budget.profit_amt)/SUM(budget.budget_profit_amt),0) *100   as '毛利额达成率' FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_idWHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND budget.month_id=date_format(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y%m') AND store.store_name = '深圳XXX路店'GROUP BY category.category_nameORDER BY '毛利额达成率' DESCLIMIT 1"
去年全年，毛利额达成率呈现什么趋势？,"SELECT budget.month_id  as '月份' , IFNULL(SUM(budget.profit_amt)/SUM(budget.budget_profit_amt),0) *100    as '毛利额达成率' FROM vw_dwd_fact_store_budget AS budget WHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 YEAR))GROUP BY budget.month_idORDER BY budget.month_id"
去年全年，华南区的毛利额达成率呈现什么趋势？,"SELECT budget.month_id  as '月份' , IFNULL(SUM(budget.profit_amt)/SUM(budget.budget_profit_amt),0) *100    as '毛利额达成率' FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 YEAR)) AND store.area_name='华南区'GROUP BY budget.month_idORDER BY budget.month_id"
去年全年，深圳XXX路店的毛利额达成率呈现什么趋势？,"SELECT budget.month_id  as '月份' , IFNULL(SUM(budget.profit_amt)/SUM(budget.budget_profit_amt),0) *100    as '毛利额达成率' FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 YEAR)) AND store.store_name = '深圳XXX路店'GROUP BY budget.month_idORDER BY budget.month_id"
去年全年，深圳XXX路店婴儿用品品类毛利额达成率呈现什么趋势？,"SELECT budget.month_id  as '月份' , IFNULL(SUM(budget.profit_amt)/SUM(budget.budget_profit_amt),0) *100    as '毛利额达成率' FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_idWHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 YEAR)) AND store.store_name = '深圳XXX路店' AND category.category_name='婴儿用品'GROUP BY budget.month_idORDER BY budget.month_id"
今年到目前为止，与去年同期相比，毛利额达成率有什么变化？,"SELECT t1.profit_achievement_rate*100  as '今年毛利额达成率' ,t2.profit_achievement_rate*100  as '去年毛利额达成率'  ,t1.profit_achievement_rate-t2.profit_achievement_rate  as '同比差额' ,(t1.profit_achievement_rate-t2.profit_achievement_rate)/t2.profit_achievement_rate*100   as '同比变化率' FROM (SELECT IFNULL(SUM(budget.profit_amt)/SUM(budget.budget_profit_amt),0)    as profit_achievement_rateFROM vw_dwd_fact_store_budget AS budget WHERE budget.year_id=YEAR(CURDATE()) AND budget.month_id<=date_format(CURDATE(), '%Y%m')) t1,(SELECT IFNULL(SUM(budget.profit_amt)/SUM(budget.budget_profit_amt),0)    as profit_achievement_rateFROM vw_dwd_fact_store_budget AS budget WHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 YEAR)) AND budget.month_id<=date_format(DATE_SUB(CURDATE(), INTERVAL 1 YEAR), '%Y%m')) t2"
今年到目前为止，与去年同期相比，华南区毛利额达成率有什么变化？,"SELECT t1.profit_achievement_rate*100  as '今年毛利额达成率' ,t2.profit_achievement_rate*100  as '去年毛利额达成率'  ,t1.profit_achievement_rate-t2.profit_achievement_rate  as '同比差额' ,(t1.profit_achievement_rate-t2.profit_achievement_rate)/t2.profit_achievement_rate*100   as '同比变化率' FROM (SELECT IFNULL(SUM(budget.profit_amt)/SUM(budget.budget_profit_amt),0)    as profit_achievement_rate  FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(CURDATE()) AND budget.month_id<=date_format(CURDATE(), '%Y%m')  AND store.area_name='华南区') t1,(SELECT IFNULL(SUM(budget.profit_amt)/SUM(budget.budget_profit_amt),0)    as profit_achievement_rate  FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 YEAR)) AND budget.month_id<=date_format(DATE_SUB(CURDATE(), INTERVAL 1 YEAR), '%Y%m')  AND store.area_name='华南区') t2"
今年到目前为止，与去年同期相比，深圳XXX路店毛利额达成率有什么变化？,"SELECT t1.profit_achievement_rate*100  as '今年毛利额达成率' ,t2.profit_achievement_rate*100  as '去年毛利额达成率'  ,t1.profit_achievement_rate-t2.profit_achievement_rate  as '同比差额' ,(t1.profit_achievement_rate-t2.profit_achievement_rate)/t2.profit_achievement_rate*100   as '同比变化率' FROM (SELECT IFNULL(SUM(budget.profit_amt)/SUM(budget.budget_profit_amt),0)    as profit_achievement_rate  FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(CURDATE()) AND budget.month_id<=date_format(CURDATE(), '%Y%m')  AND store.store_name = '深圳XXX路店') t1,(SELECT IFNULL(SUM(budget.profit_amt)/SUM(budget.budget_profit_amt),0)    as profit_achievement_rate  FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id WHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 YEAR)) AND budget.month_id<=date_format(DATE_SUB(CURDATE(), INTERVAL 1 YEAR), '%Y%m')  AND store.store_name = '深圳XXX路店') t2"
今年到目前为止，与去年同期相比，深圳XXX路店婴儿用品品类毛利额达成率有什么变化？,"SELECT t1.profit_achievement_rate*100  as '今年毛利额达成率' ,t2.profit_achievement_rate*100  as '去年毛利额达成率'  ,t1.profit_achievement_rate-t2.profit_achievement_rate  as '同比差额' ,(t1.profit_achievement_rate-t2.profit_achievement_rate)/t2.profit_achievement_rate*100   as '同比变化率' FROM (SELECT IFNULL(SUM(budget.profit_amt)/SUM(budget.budget_profit_amt),0)    as profit_achievement_rate  FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_idWHERE budget.year_id=YEAR(CURDATE()) AND budget.month_id<=date_format(CURDATE(), '%Y%m')  AND store.store_name = '深圳XXX路店' AND category.category_name='婴儿用品') t1,(SELECT IFNULL(SUM(budget.profit_amt)/SUM(budget.budget_profit_amt),0)    as profit_achievement_rate  FROM vw_dwd_fact_store_budget AS budget JOIN vw_dwd_dim_store AS store ON budget.store_id = store.store_id JOIN vw_dwd_dim_item_category AS category ON budget.category_id = category.category_idWHERE budget.year_id=YEAR(DATE_SUB(CURDATE(), INTERVAL 1 YEAR)) AND budget.month_id<=date_format(DATE_SUB(CURDATE(), INTERVAL 1 YEAR), '%Y%m')  AND store.store_name = '深圳XXX路店' AND category.category_name='婴儿用品') t2"
昨天的毛利额同比,"select  t1.profit_amt as '昨天毛利额' ,t2.profit_amt as '去年同期毛利额' ,t1.profit_amt - t2.profit_amt  as '同比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '同比变化率' from (select sum(profit_amt) as profit_amt from vw_dwd_fact_store_item_cost_daily where business_date = date_sub(curdate(), interval 1 day)) t1,(select sum(profit_amt) as profit_amt from vw_dwd_fact_store_item_cost_daily where business_date = date_sub(date_sub(curdate(), interval 1 day), interval 1 year)) t2"
华南区昨天的毛利额同比,"select  t1.profit_amt as '昨天毛利额' ,t2.profit_amt as '去年同期毛利额' ,t1.profit_amt - t2.profit_amt  as '同比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '同比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id where a.business_date = date_sub(curdate(), interval 1 day) and b.area_name = '华南区') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id where a.business_date = date_sub(date_sub(curdate(), interval 1 day), interval 1 year) and b.area_name = '华南区') t2"
深圳XXX路店昨天的毛利额同比,"select  t1.profit_amt as '昨天毛利额' ,t2.profit_amt as '去年同期毛利额' ,t1.profit_amt - t2.profit_amt  as '同比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '同比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id where a.business_date = date_sub(curdate(), interval 1 day) and b.store_name='深圳XXX路店' ) t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id where a.business_date = date_sub(date_sub(curdate(), interval 1 day), interval 1 year) and b.store_name='深圳XXX路店' ) t2"
深圳XXX路店婴儿用品品类昨天的毛利额同比,"select  t1.profit_amt as '昨天毛利额' ,t2.profit_amt as '去年同期毛利额' ,t1.profit_amt - t2.profit_amt  as '同比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '同比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where a.business_date = date_sub(curdate(), interval 1 day) and b.store_name='深圳XXX路店' and c.category_name_level1='婴儿用品') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where a.business_date = date_sub(date_sub(curdate(), interval 1 day), interval 1 year) and b.store_name='深圳XXX路店' and c.category_name_level1='婴儿用品') t2"
华南区花生油小类昨天的毛利额同比,"select  t1.profit_amt as '昨天毛利额' ,t2.profit_amt as '去年同期毛利额' ,t1.profit_amt - t2.profit_amt  as '同比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '同比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where a.business_date = date_sub(curdate(), interval 1 day) and b.area_name='华南区' and c.category_name_level3='花生油') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where a.business_date = date_sub(date_sub(curdate(), interval 1 day), interval 1 year) and b.area_name='华南区' and c.category_name_level3='花生油') t2"
上周的毛利额同比,"select  t1.profit_amt as '上周毛利额' ,t2.profit_amt as '去年同期毛利额' ,t1.profit_amt - t2.profit_amt  as '同比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '同比变化率' from (select sum(profit_amt) as profit_amt from vw_dwd_fact_store_item_cost_daily where year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week))) t1,(select sum(profit_amt) as profit_amt from vw_dwd_fact_store_item_cost_daily where year(business_date)=year(date_sub(curdate(), interval 1 week))-1 and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week))) t2"
华南区上周的毛利额同比,"select  t1.profit_amt as '上周毛利额' ,t2.profit_amt as '去年同期毛利额' ,t1.profit_amt - t2.profit_amt  as '同比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '同比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id where year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and b.area_name = '华南区') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id where year(a.business_date)=year(date_sub(curdate(), interval 1 week))-1 and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and b.area_name = '华南区') t2"
深圳XXX路店上周的毛利额同比,"select  t1.profit_amt as '上周毛利额' ,t2.profit_amt as '去年同期毛利额' ,t1.profit_amt - t2.profit_amt  as '同比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '同比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id where year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and b.store_name='深圳XXX路店' ) t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id where year(a.business_date)=year(date_sub(curdate(), interval 1 week))-1 and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and b.store_name='深圳XXX路店' ) t2"
深圳XXX路店婴儿用品品类上周的毛利额同比,"select  t1.profit_amt as '上周毛利额' ,t2.profit_amt as '去年同期毛利额' ,t1.profit_amt - t2.profit_amt  as '同比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '同比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and b.store_name='深圳XXX路店' and c.category_name_level1='婴儿用品') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date)=year(date_sub(curdate(), interval 1 week))-1 and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week))  and b.store_name='深圳XXX路店' and c.category_name_level1='婴儿用品') t2"
华南区花生油小类上周的毛利额同比,"select  t1.profit_amt as '上周毛利额' ,t2.profit_amt as '去年同期毛利额' ,t1.profit_amt - t2.profit_amt  as '同比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '同比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and b.area_name='华南区' and c.category_name_level3='花生油') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date)=year(date_sub(curdate(), interval 1 week))-1 and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and b.area_name='华南区' and c.category_name_level3='花生油') t2"
今年3月份的毛利额同比增长,"select  t1.profit_amt as '毛利额' ,t2.profit_amt as '去年同期毛利额' ,t1.profit_amt - t2.profit_amt  as '同比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '同比变化率' from (select sum(profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily  where year(business_date) = year(curdate()) and month(business_date) = 3) t1,(select sum(profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily  where year(business_date) = year(curdate()) - 1 and month(business_date) = 3) t2"
华南区今年3月份的毛利额同比增长,"select  t1.profit_amt as '毛利额' ,t2.profit_amt as '去年同期毛利额' ,t1.profit_amt - t2.profit_amt  as '同比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '同比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id where year(a.business_date) = year(curdate()) and month(a.business_date) = 3 and b.area_name='华南区') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id where year(a.business_date) = year(curdate()) - 1 and month(a.business_date) = 3 and b.area_name='华南区') t2"
深圳XXX路店今年3月份的毛利额同比增长,"select  t1.profit_amt as '毛利额' ,t2.profit_amt as '去年同期毛利额' ,t1.profit_amt - t2.profit_amt  as '同比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '同比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id where year(a.business_date) = year(curdate()) and month(a.business_date) = 3 and b.store_name = '深圳XXX路店') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id where year(a.business_date) = year(curdate()) - 1 and month(a.business_date) = 3 and b.store_name = '深圳XXX路店') t2"
深圳XXX路店婴儿用品品类今年3月份的毛利额同比增长,"select  t1.profit_amt as '毛利额' ,t2.profit_amt as '去年同期毛利额' ,t1.profit_amt - t2.profit_amt  as '同比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '同比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date) = year(curdate()) and month(a.business_date) = 3 and b.store_name='深圳XXX路店' and c.category_name_level1='婴儿用品') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date) = year(curdate()) - 1 and month(a.business_date) = 3 and b.store_name='深圳XXX路店' and c.category_name_level1='婴儿用品') t2"
华南区花生油小类今年3月份的毛利额同比增长,"select  t1.profit_amt as '毛利额' ,t2.profit_amt as '去年同期毛利额' ,t1.profit_amt - t2.profit_amt  as '同比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '同比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date) = year(curdate()) and month(a.business_date) = 3 and b.area_name='华南区' and c.category_name_level3='花生油') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date) = year(curdate()) - 1 and month(a.business_date) = 3 and b.area_name='华南区' and c.category_name_level3='花生油') t2"
上个月各区域的毛利额同比增长率,"select t1.area_name  as '区域名称' , t1.profit_amt as '毛利额' ,t2.profit_amt as '去年同期毛利额' ,t1.profit_amt - t2.profit_amt  as '同比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '同比变化率' from (select b.area_name, sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id where year(a.business_date) = year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) group by b.area_name) t1join (select b.area_name, sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id where year(a.business_date) = year(date_sub(date_sub(curdate(), interval 1 month), interval 1 year)) and month(a.business_date) = month(date_sub(date_sub(curdate(), interval 1 month), interval 1 year)) group by b.area_name) t2on t1.area_name = t2.area_name"
今年到目前为止，深圳XXX路店的毛利额同比增长了多少？,"select  t1.profit_amt as '毛利额' ,t2.profit_amt as '去年同期毛利额' ,t1.profit_amt - t2.profit_amt  as '同比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '同比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id where year(a.business_date)=year(now()) and b.store_name='深圳XXX路店') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id where year(a.business_date)=year(now())-1 and b.store_name='深圳XXX路店') t2"
上个月婴儿用品品类的毛利额同比增长了多少？,"select  t1.profit_amt as '上个月毛利额' ,t2.profit_amt as '去年同期毛利额' ,t1.profit_amt - t2.profit_amt  as '同比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '同比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date) = year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and c.category_name_level1='婴儿用品') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date) = year(date_sub(date_sub(curdate(), interval 1 month), interval 1 year)) and month(a.business_date) = month(date_sub(date_sub(curdate(), interval 1 month), interval 1 year)) and c.category_name_level1='婴儿用品') t2 "
华南区上个月婴儿用品品类的毛利额同比增长了多少？," select  t1.profit_amt as '上个月毛利额' ,t2.profit_amt as '去年同期毛利额' ,t1.profit_amt - t2.profit_amt  as '同比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '同比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where  year(a.business_date) = year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))  and b.area_name = '华南区' and c.category_name_level1='婴儿用品') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date) = year(date_sub(date_sub(curdate(), interval 1 month), interval 1 year)) and month(a.business_date) = month(date_sub(date_sub(curdate(), interval 1 month), interval 1 year)) and b.area_name = '华南区' and c.category_name_level1='婴儿用品') t2"
深圳XXX路店上个月婴儿用品品类的毛利额同比增长了多少？," select  t1.profit_amt as '上个月毛利额' ,t2.profit_amt as '去年同期毛利额' ,t1.profit_amt - t2.profit_amt  as '同比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '同比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where  year(a.business_date) = year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))  and b.store_name='深圳XXX路店' and c.category_name_level1='婴儿用品') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date) = year(date_sub(date_sub(curdate(), interval 1 month), interval 1 year)) and month(a.business_date) = month(date_sub(date_sub(curdate(), interval 1 month), interval 1 year)) and b.store_name='深圳XXX路店' and c.category_name_level1='婴儿用品') t2 "
上周鲜鸡蛋毛利额同比增长了多少？," select  t1.profit_amt as '上周毛利额' ,t2.profit_amt as '去年同期毛利额' ,t1.profit_amt - t2.profit_amt  as '同比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '同比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_item c on a.item_id = c.item_id where  year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week))  and c.item_name='鲜鸡蛋') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date)=year(date_sub(curdate(), interval 1 week))-1 and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week))  and c.item_name='鲜鸡蛋') t2"
上周华南区鲜鸡蛋毛利额同比增长了多少？," select  t1.profit_amt as '上周毛利额' ,t2.profit_amt as '去年同期毛利额' ,t1.profit_amt - t2.profit_amt  as '同比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '同比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where  year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and b.area_name = '华南区' and c.item_name='鲜鸡蛋') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date)=year(date_sub(curdate(), interval 1 week))-1 and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and b.area_name = '华南区' and c.item_name='鲜鸡蛋') t2"
上周深圳XXX路店鲜鸡蛋毛利额同比增长了多少？," select  t1.profit_amt as '上周毛利额' ,t2.profit_amt as '去年同期毛利额' ,t1.profit_amt - t2.profit_amt  as '同比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '同比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where  year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and b.store_name='深圳XXX路店' and c.item_name='鲜鸡蛋') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date)=year(date_sub(curdate(), interval 1 week))-1 and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and b.store_name='深圳XXX路店' and c.item_name='鲜鸡蛋') t2"
上周的毛利额环比,"select  t1.profit_amt as '上周毛利额' ,t2.profit_amt as '环比毛利额' ,t1.profit_amt - t2.profit_amt  as '环比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '环比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a where  year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week))) t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a where  year(a.business_date)=year(date_sub(curdate(), interval 2 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 2 week))) t2"
华南区上周的毛利额环比,"select  t1.profit_amt as '上周毛利额' ,t2.profit_amt as '环比毛利额' ,t1.profit_amt - t2.profit_amt  as '环比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '环比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where  year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and b.area_name = '华南区' ) t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date)=year(date_sub(curdate(), interval 2 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 2 week)) and b.area_name = '华南区' ) t2"
深圳XXX路店上周的毛利额环比,"  select  t1.profit_amt as '上周毛利额' ,t2.profit_amt as '环比毛利额' ,t1.profit_amt - t2.profit_amt  as '环比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '环比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where  year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and b.store_name = '深圳XXX路店' ) t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date)=year(date_sub(curdate(), interval 2 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 2 week)) and b.store_name = '深圳XXX路店' ) t2"
深圳XXX路店婴儿用品品类上周的毛利额环比,"  select  t1.profit_amt as '上周毛利额' ,t2.profit_amt as '环比毛利额' ,t1.profit_amt - t2.profit_amt  as '环比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '环比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where  year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week))  and b.store_name='深圳XXX路店' and c.category_name_level1='婴儿用品') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date)=year(date_sub(curdate(), interval 2 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 2 week)) and b.store_name='深圳XXX路店' and c.category_name_level1='婴儿用品') t2"
华南区花生油小类上周的毛利额环比,"  select  t1.profit_amt as '上周毛利额' ,t2.profit_amt as '环比毛利额' ,t1.profit_amt - t2.profit_amt  as '环比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '环比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where  year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week))  and b.area_name='华南区' and c.category_name_level3='花生油') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date)=year(date_sub(curdate(), interval 2 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 2 week)) and b.area_name='华南区' and c.category_name_level3='花生油') t2"
今年3月份的毛利额环比增长,"select  t1.profit_amt as '毛利额' ,t2.profit_amt as '环比毛利额' ,t1.profit_amt - t2.profit_amt  as '环比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '环比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a where  year(a.business_date)=year(curdate()) and month(a.business_date)=3) t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a where  year(a.business_date)=year(curdate()) and month(a.business_date)=2) t2"
华南区今年3月份的毛利额环比增长,"  select  t1.profit_amt as '毛利额' ,t2.profit_amt as '环比毛利额' ,t1.profit_amt - t2.profit_amt  as '环比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '环比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id where  year(a.business_date)=year(curdate()) and month(a.business_date)=3 and b.area_name = '华南区' ) t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id where year(a.business_date)=year(curdate()) and month(a.business_date)=2 and b.area_name = '华南区' ) t2   "
深圳XXX路店今年3月份的毛利额环比增长,"  select  t1.profit_amt as '毛利额' ,t2.profit_amt as '环比毛利额' ,t1.profit_amt - t2.profit_amt  as '环比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '环比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id where  year(a.business_date)=year(curdate()) and month(a.business_date)=3 and b.store_name = '深圳XXX路店' ) t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id where year(a.business_date)=year(curdate()) and month(a.business_date)=2 and b.store_name = '深圳XXX路店' ) t2"
深圳XXX路店婴儿用品品类今年3月份的毛利额环比增长,"select  t1.profit_amt as '毛利额' ,t2.profit_amt as '环比毛利额' ,t1.profit_amt - t2.profit_amt  as '环比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '环比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where  year(a.business_date)=year(curdate()) and month(a.business_date)=3 and b.store_name = '深圳XXX路店' and c.category_name_level1='婴儿用品') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date)=year(curdate()) and month(a.business_date)=2 and b.store_name = '深圳XXX路店' and c.category_name_level1='婴儿用品' ) t2 "
华南区花生油小类今年3月份的毛利额环比增长,"select  t1.profit_amt as '毛利额' ,t2.profit_amt as '环比毛利额' ,t1.profit_amt - t2.profit_amt  as '环比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '环比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where  year(a.business_date)=year(curdate()) and month(a.business_date)=3 and b.area_name = '华南区' and c.category_name_level3='花生油') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date)=year(curdate()) and month(a.business_date)=2 and b.area_name = '华南区' and c.category_name_level3='花生油' ) t2  "
上个月各区域的毛利额环比增长率," select t1.area_name  as '区域名称' , t1.profit_amt as '上个月毛利额' ,t2.profit_amt as '环比毛利额' ,t1.profit_amt - t2.profit_amt  as '环比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '环比变化率' from (select b.area_name, sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id where year(a.business_date) = year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) group by b.area_name) t1join (select b.area_name, sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id where year(a.business_date) = year(date_sub(curdate(), interval 2 month)) and month(a.business_date) = month(date_sub(curdate(), interval 2 month)) group by b.area_name) t2on t1.area_name = t2.area_nameorder by '环比变化率' desc"
上个月婴儿用品品类的毛利额环比增长了多少？," select  t1.profit_amt as '上个月毛利额' ,t2.profit_amt as '环比毛利额' ,t1.profit_amt - t2.profit_amt  as '环比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '环比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date) = year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and c.category_name_level1='婴儿用品') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date) = year(date_sub(curdate(), interval 2 month)) and month(a.business_date) = month(date_sub(curdate(), interval 2 month)) and c.category_name_level1='婴儿用品') t2 "
华南区上个月婴儿用品品类的毛利额环比增长了多少？," select  t1.profit_amt as '上个月毛利额' ,t2.profit_amt as '环比毛利额' ,t1.profit_amt - t2.profit_amt  as '环比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '环比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date) = year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and b.area_name = '华南区' and c.category_name_level1='婴儿用品') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date) = year(date_sub(curdate(), interval 2 month)) and month(a.business_date) = month(date_sub(curdate(), interval 2 month)) and b.area_name = '华南区' and c.category_name_level1='婴儿用品') t2  "
深圳XXX路店上个月婴儿用品品类的毛利额环比增长了多少？," select  t1.profit_amt as '上个月毛利额' ,t2.profit_amt as '环比毛利额' ,t1.profit_amt - t2.profit_amt  as '环比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '环比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date) = year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and b.store_name='深圳XXX路店' and c.category_name_level1='婴儿用品') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date) = year(date_sub(curdate(), interval 2 month)) and month(a.business_date) = month(date_sub(curdate(), interval 2 month)) and b.store_name='深圳XXX路店' and c.category_name_level1='婴儿用品') t2 "
上周鲜鸡蛋毛利额环比增长了多少？,"select  t1.profit_amt as '上周毛利额' ,t2.profit_amt as '环比毛利额' ,t1.profit_amt - t2.profit_amt  as '环比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '环比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and c.item_name='鲜鸡蛋') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date)=year(date_sub(curdate(), interval 2 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 2 week)) and c.item_name='鲜鸡蛋') t2"
上周华南区鲜鸡蛋毛利额环比增长了多少？,"  select  t1.profit_amt as '上周毛利额' ,t2.profit_amt as '环比毛利额' ,t1.profit_amt - t2.profit_amt  as '环比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '环比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and b.area_name = '华南区' and c.item_name='鲜鸡蛋') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date)=year(date_sub(curdate(), interval 2 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 2 week)) and b.area_name = '华南区' and c.item_name='鲜鸡蛋') t2  "
上周深圳XXX路店鲜鸡蛋毛利额环比增长了多少？,"  select  t1.profit_amt as '上周毛利额' ,t2.profit_amt as '环比毛利额' ,t1.profit_amt - t2.profit_amt  as '环比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '环比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and b.store_name='深圳XXX路店' and c.item_name='鲜鸡蛋') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date)=year(date_sub(curdate(), interval 2 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 2 week)) and b.store_name='深圳XXX路店' and c.item_name='鲜鸡蛋') t2 "
上个月，在所有品类中，哪个品类的毛利额贡献最大？," select c.category_name_level1  as '大类名称' , sum(a.profit_amt)   as '毛利额'from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item c on a.item_id = c.item_idwhere year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))group by c.category_name_level1order by '毛利额' desclimit 1"
华南区上个月，在所有品类中，哪个品类的毛利额贡献最大？," select c.category_name_level1  as '大类名称' , sum(a.profit_amt)   as '毛利额'from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_idjoin vw_dwd_dim_item c on a.item_id = c.item_idwhere year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and b.area_name = '华南区'group by c.category_name_level1order by  '毛利额' desclimit 1"
深圳XXX路店上个月，在所有品类中，哪个品类的毛利额贡献最大？," select c.category_name_level1  as '大类名称' , sum(a.profit_amt)   as '毛利额'from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_idjoin vw_dwd_dim_item c on a.item_id = c.item_idwhere year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and b.store_name='深圳XXX路店'group by c.category_name_level1order by  '毛利额' desclimit 1"
去年，哪些品类对总毛利额的贡献最大？,"select c.category_name_level1  as '大类名称' , sum(a.profit_amt)   as '毛利额'from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item c on a.item_id = c.item_idwhere year(a.business_date)=year(curdate())-1group by c.category_name_level1order by  '毛利额'  desc"
去年，华南区哪些品类对总毛利额的贡献最大？,"select c.category_name_level1  as '大类名称' , sum(a.profit_amt)   as '毛利额'from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_idjoin vw_dwd_dim_item c on a.item_id = c.item_idwhere year(a.business_date)=year(curdate())-1 and b.area_name = '华南区'group by c.category_name_level1order by  '毛利额' desc"
去年，深圳XXX路店哪些品类对总毛利额的贡献最大？,"select c.category_name_level1  as '大类名称' , sum(a.profit_amt)   as '毛利额'from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_idjoin vw_dwd_dim_item c on a.item_id = c.item_idwhere year(a.business_date)=year(curdate())-1 and b.store_name='深圳XXX路店'group by c.category_name_level1order by  '毛利额' desc"
上个月，哪些门店的毛利贡献最高？,"select b.store_name  as '门店名称' , sum(a.profit_amt) as '毛利额'from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_idwhere year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))group by b.store_nameorder by '毛利额' desc"
上个月，华南区哪些门店的毛利贡献最高？,"select b.store_name  as '门店名称' , sum(a.profit_amt) as '毛利额'from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_idwhere year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and b.area_name = '华南区'group by b.store_nameorder by  '毛利额' desc"
上个月，对整体毛利额贡献最高的10个商品是哪些？,"select c.item_name  as '商品名称' , sum(a.profit_amt)  as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item c on a.item_id = c.item_idwhere year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) group by c.item_nameorder by  '毛利额' desclimit 10"
上个月，华南区对整体毛利额贡献最高的10个商品是哪些？,"select c.item_name  as '商品名称' , sum(a.profit_amt)  as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_idjoin vw_dwd_dim_item c on a.item_id = c.item_idwhere year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and b.area_name = '华南区'group by c.item_nameorder by  '毛利额' desclimit 10"
上个月，深圳XXX路店对整体毛利额贡献最高的10个商品是哪些？,"select c.item_name  as '商品名称' , sum(a.profit_amt)  as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_idjoin vw_dwd_dim_item c on a.item_id = c.item_idwhere year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and b.store_name = '深圳XXX路店'group by c.item_nameorder by  '毛利额' desclimit 10"
上个月，深圳XXX路店婴儿用品品类对整体毛利额贡献最高的10个商品是哪些？,"select c.item_name  as '商品名称' , sum(a.profit_amt)  as '毛利额' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_idjoin vw_dwd_dim_item c on a.item_id = c.item_idwhere year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and b.store_name = '深圳XXX路店' and c.category_name_level1 = '婴儿用品'group by c.item_nameorder by  '毛利额' desclimit 10"
上个月，婴儿用品品类的毛利占比有何变化？,"select  t1.profit_amt as '上个月毛利额' ,t2.profit_amt as '去年同期毛利额' ,t1.profit_amt - t2.profit_amt  as '同比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '同比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date) = year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and c.category_name_level1='婴儿用品') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date) = year(date_sub(date_sub(curdate(), interval 1 month), interval 1 year)) and month(a.business_date) = month(date_sub(date_sub(curdate(), interval 1 month), interval 1 year)) and c.category_name_level1='婴儿用品') t2 "
上个月，华南区婴儿用品品类的毛利占比有何变化？,"select  t1.profit_amt as '上个月毛利额' ,t2.profit_amt as '去年同期毛利额' ,t1.profit_amt - t2.profit_amt  as '同比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '同比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date) = year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))  and b.area_name = '华南区' and c.category_name_level1='婴儿用品') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date) = year(date_sub(date_sub(curdate(), interval 1 month), interval 1 year)) and month(a.business_date) = month(date_sub(date_sub(curdate(), interval 1 month), interval 1 year)) and b.area_name = '华南区' and c.category_name_level1='婴儿用品') t2  "
上个月，深圳XXX路店婴儿用品品类的毛利占比有何变化？,"select  t1.profit_amt as '上个月毛利额' ,t2.profit_amt as '去年同期毛利额' ,t1.profit_amt - t2.profit_amt  as '同比差额',(t1.profit_amt - t2.profit_amt)/t2.profit_amt*100 as '同比变化率' from (select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date) = year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))  and b.store_name='深圳XXX路店' and c.category_name_level1='婴儿用品') t1,(select sum(a.profit_amt) as profit_amt  from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_id where year(a.business_date) = year(date_sub(date_sub(curdate(), interval 1 month), interval 1 year)) and month(a.business_date) = month(date_sub(date_sub(curdate(), interval 1 month), interval 1 year)) and b.store_name='深圳XXX路店' and c.category_name_level1='婴儿用品') t2  "
上个月的毛利率是多少？," select sum(a.profit_amt) / sum(a.sales_amt) *100  as '毛利率' from vw_dwd_fact_store_item_cost_daily awhere year(a.business_date) = year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) "
上个月华南区的毛利率是多少？," select sum(a.profit_amt) / sum(a.sales_amt)*100   as '毛利率' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_idwhere year(a.business_date) = year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))  and b.area_name = '华南区'"
本周的毛利率与上周同期相比有何变化？,"select t1.profit_rate  as '本周毛利率' ,t2.profit_rate  as '环比毛利率' ,t1.profit_rate  - t2.profit_rate   as '环比差额',(t1.profit_rate  - t2.profit_rate )/t2.profit_rate*100  as '环比变化率' from (select sum(profit_amt) / sum(sales_amt) as profit_rate from vw_dwd_fact_store_item_cost_daily where year(business_date)=year(curdate()) and weekofyear(business_date) = weekofyear(curdate())) t1,(select sum(profit_amt) / sum(sales_amt) as profit_rate from vw_dwd_fact_store_item_cost_daily where year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week))) t2"
今年3月份的毛利率,select sum(a.profit_amt) / sum(a.sales_amt)*100   as '毛利率' from vw_dwd_fact_store_item_cost_daily awhere year(a.business_date) = year(curdate()) and month(a.business_date) = 3 
今年3月份华南区的毛利率, select sum(a.profit_amt) / sum(a.sales_amt)*100   as '毛利率' from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_idwhere year(a.business_date) = year(curdate()) and month(a.business_date) = 3  and b.area_name = '华南区'
上个月，哪些品类的毛利率最高？," select c.category_name_level1  as '大类名称' , sum(a.profit_amt) / sum(a.sales_amt) *100   as '毛利率' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_item c on a.item_id = c.item_idwhere year(a.business_date) = year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))group by c.category_name_level1order by '毛利率' desclimit 1"
上个月，华南区哪些品类的毛利率最高？," select c.category_name_level1  as '大类名称' , sum(a.profit_amt) / sum(a.sales_amt) *100   as '毛利率' from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_idjoin vw_dwd_dim_item c on a.item_id = c.item_idwhere year(a.business_date) = year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and b.area_name = '华南区'group by c.category_name_level1order by  '毛利率'  desclimit 1"
上个月，深圳XXX路店哪些品类的毛利率最高？," select c.category_name_level1  as '大类名称' , sum(a.profit_amt) / sum(a.sales_amt) *100   as '毛利率' from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_store b on a.store_id = b.store_idjoin vw_dwd_dim_item c on a.item_id = c.item_idwhere year(a.business_date) = year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and b.store_name='深圳XXX路店'group by c.category_name_level1order by  '毛利率' desclimit 1"
上个月各个区域的毛利率,"select b.area_name  as '区域名称' , sum(a.profit_amt) / sum(a.sales_amt) *100   as '毛利率' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_idwhere year(a.business_date) = year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))group by b.area_nameorder by  '毛利率'  desc"
今年深圳XXX路店的毛利率是多少？,select sum(a.profit_amt) / sum(a.sales_amt) *100  as '毛利率' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_idwhere year(a.business_date) = year(curdate())  and b.store_name='深圳XXX路店'
今年哪些门店的毛利率最低,"select b.store_name  as '门店名称' , sum(a.profit_amt) / sum(a.sales_amt) *100   as '毛利率' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_idwhere year(a.business_date) = year(curdate())group by b.store_nameorder by '毛利率'  asc"
今年华南区哪些门店的毛利率最低,"select b.store_name  as '门店名称' , sum(a.profit_amt) / sum(a.sales_amt)*100    as '毛利率' from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_idwhere year(a.business_date) = year(curdate()) and b.area_name = '华南区'group by b.store_nameorder by '毛利率' asc"
上个月婴儿用品品类的毛利率,"select sum(a.profit_amt) / sum(a.sales_amt) *100  as '毛利率' from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_item c on a.item_id = c.item_idwhere year(a.business_date) = year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and c.category_name_level1='婴儿用品'"
上个月华南区婴儿用品品类的毛利率,"select sum(a.profit_amt) / sum(a.sales_amt) *100 as '毛利率'from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_idwhere year(a.business_date) = year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and c.category_name_level1='婴儿用品'  and b.area_name = '华南区'"
上个月深圳XXX路店婴儿用品品类的毛利率,"select sum(a.profit_amt) / sum(a.sales_amt) *100 as '毛利率'from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_idwhere year(a.business_date) = year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and c.category_name_level1='婴儿用品'  and b.store_name='深圳XXX路店'"
上周鲜鸡蛋的毛利率,"select sum(a.profit_amt) / sum(a.sales_amt)*100 as '毛利率'from vw_dwd_fact_store_item_cost_daily a join vw_dwd_dim_item c on a.item_id = c.item_idwhere year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and c.item_name='鲜鸡蛋'"
上周华南区鲜鸡蛋的毛利率,"select sum(a.profit_amt) / sum(a.sales_amt)*100 as '毛利率'from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_idwhere year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and c.item_name='鲜鸡蛋'  and b.area_name = '华南区'"
上周深圳XXX路店鲜鸡蛋的毛利率,"select sum(a.profit_amt) / sum(a.sales_amt)*100 as '毛利率'from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_id join vw_dwd_dim_item c on a.item_id = c.item_idwhere year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week)) and c.item_name='鲜鸡蛋'  and b.store_name='深圳XXX路店'"
华南区本月的毛利额、毛利率是多少？,"select sum(a.profit_amt)   as '毛利额' , sum(a.profit_amt) / sum(a.sales_amt)*100 as '毛利率'from vw_dwd_fact_store_item_cost_daily ajoin vw_dwd_dim_store b on a.store_id = b.store_idwhere year(a.business_date)=year(curdate()) and month(a.business_date) = month(curdate())   and b.area_name = '华南区'"
上个月的动销率是多少？,"SELECT count(distinct a.item_id) / (SELECT count(*) FROM vw_dwd_dim_item)*100    as '动销率' FROM vw_dwd_fact_store_order_detail as aWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))"
上个月华南区的动销率是多少？,"SELECT count(distinct a.item_id) / (SELECT count(*) FROM vw_dwd_dim_item)*100    as '动销率' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))    and b.area_name = '华南区'"
上个月深圳XXX路店的动销率是多少？,"SELECT count(distinct a.item_id) / (SELECT count(*) FROM vw_dwd_dim_item) *100   as '动销率' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))    and b.store_name = '深圳XXX路店'"
上个月不同区域中动销率最高的区域是哪一个？,"SELECT b.area_name  as '区域名称' , count(distinct a.item_id) / (SELECT count(*) FROM vw_dwd_dim_item) *100   as '动销率' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))GROUP BY b.area_nameORDER BY '动销率' DESCLIMIT 1"
上个月各区域的动销率排名,"SELECT b.area_name as '区域名称' , count(distinct a.item_id) / (SELECT count(*) FROM vw_dwd_dim_item) *100   as '动销率' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))GROUP BY b.area_nameORDER BY  '动销率' DESC"
上个月哪些门店的动销率表现最好？,"SELECT b.store_name  as '门店名称' , count(distinct a.item_id) / (SELECT count(*) FROM vw_dwd_dim_item) *100   as '动销率' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))GROUP BY b.store_nameORDER BY '动销率' DESCLIMIT 10"
华南区上个月哪些门店的动销率表现最好？,"SELECT b.store_name  as '门店名称' , count(distinct a.item_id) / (SELECT count(*) FROM vw_dwd_dim_item) *100   as '动销率' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))    and b.area_name = '华南区'GROUP BY b.store_nameORDER BY '动销率' DESCLIMIT 10"
上个月哪些品类的动销率最高？,"SELECT c.category_name_level1  as '大类名称' , count(distinct a.item_id) / (SELECT count(*) FROM vw_dwd_dim_item) *100   as '动销率' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_item as c on a.item_id = c.item_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))GROUP BY c.category_name_level1ORDER BY '动销率' DESCLIMIT 10"
华南区上个月哪些品类的动销率最高？,"SELECT c.category_name_level1  as '大类名称' , count(distinct a.item_id) / (SELECT count(*) FROM vw_dwd_dim_item) *100   as '动销率' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_item as c on a.item_id = c.item_idJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))    and b.area_name = '华南区'GROUP BY c.category_name_level1ORDER BY '动销率' DESCLIMIT 10"
深圳XXX路店上个月哪些品类的动销率最高？,"SELECT c.category_name_level1  as '大类名称' , count(distinct a.item_id) / (SELECT count(*) FROM vw_dwd_dim_item) *100   as '动销率' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_item as c on a.item_id = c.item_idJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))    and b.store_name = '深圳XXX路店'GROUP BY c.category_name_level1ORDER BY '动销率' DESCLIMIT 10"
今年的动销率月趋势怎样？,"SELECT month(a.business_date)  as '月份' , count(distinct a.item_id) / (SELECT count(*) FROM vw_dwd_dim_item) *100  as '动销率' FROM vw_dwd_fact_store_order_detail as aWHERE year(a.business_date) = year(curdate())GROUP BY month(a.business_date)ORDER BY month(a.business_date)  ASC"
华南区今年的动销率月趋势怎样？,"SELECT month(a.business_date)   as '月份' , count(distinct a.item_id) / (SELECT count(*) FROM vw_dwd_dim_item)*100   as '动销率' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date) = year(curdate()) and b.area_name = '华南区'GROUP BY month(a.business_date)ORDER BY month(a.business_date) ASC"
深圳XXX路店今年的动销率月趋势怎样？,"SELECT month(a.business_date)   as '月份' , count(distinct a.item_id) / (SELECT count(*) FROM vw_dwd_dim_item)*100   as '动销率' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date) = year(curdate()) and b.store_name = '深圳XXX路店'GROUP BY month(a.business_date)ORDER BY month(a.business_date) ASC"
上月的销售人效是多少？,"SELECT sum(a.sales_amt) / max(b.workforce)  as '销售人效' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))"
华南区上月的销售人效是多少？,"SELECT sum(a.sales_amt) / max(b.workforce)     as '销售人效' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and b.area_name = '华南区'"
深圳XXX路店上月的销售人效是多少？,"SELECT sum(a.sales_amt) / max(b.workforce)     as '销售人效' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and b.store_name = '深圳XXX路店'"
上个月哪些区域的销售人效环比有提升？,"SELECT t2.area_name  as '区域名称' ,t1.sales_efficiency  as '上个月销售人效' ,t2.sales_efficiency  as '环比销售人效' ,t1.sales_efficiency-t2.sales_efficiency  as '环比差额' ,(t1.sales_efficiency-t2.sales_efficiency)/t2.sales_efficiency*100   as '环比变化率' from(SELECT b.area_name, sum(a.sales_amt) / max(b.workforce)   as sales_efficiencyFROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))GROUP BY b.area_nameORDER BY sales_efficiency DESC)t1join(SELECT b.area_name, sum(a.sales_amt) / max(b.workforce)   as sales_efficiencyFROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 2 month)) and month(a.business_date) = month(date_sub(curdate(), interval 2 month))GROUP BY b.area_nameORDER BY sales_efficiency DESC)t2 on t1.area_name=t2.area_nameWHERE (t1.sales_efficiency-t2.sales_efficiency)/t2.sales_efficiency >0ORDER BY '环比变化率' "
上个月，哪个区域的销售人效表现最为突出？,"SELECT b.area_name  as '区域名称'  , sum(a.sales_amt) / max(b.workforce)     as '销售人效' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))GROUP BY b.area_nameORDER BY '销售人效'  DESCLIMIT 1"
上个月，哪些门店的销售人效最差？,"SELECT b.store_name  as '门店名称' , SELECT b.area_name  as '区域名称'  , sum(a.sales_amt) / max(b.workforce)  as '销售人效' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))GROUP BY b.area_nameORDER BY '销售人效'  DESCLIMIT 1   as '销售人效' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))GROUP BY b.store_nameORDER BY   '销售人效' ASCLIMIT 10"
上个月，华南区哪些门店的销售人效最差？,"SELECT b.store_name  as '门店名称' , sum(a.sales_amt) / max(b.workforce)  as '销售人效'FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))    and b.area_name = '华南区'GROUP BY b.store_nameORDER BY  '销售人效' ASCLIMIT 5"
北京XXX路店在所有门店中销售人效排第几？,"SELECT store_name  as '门店名称' ,sales_efficiency  as '销售人效' ,rn as '排名'FROM (	SELECT 	store_name,sales_efficiency,row_number() over (order by sales_efficiency DESC) as rn	FROM (	SELECT b.store_name, sum(a.sales_amt) / max(b.workforce) as sales_efficiency	FROM vw_dwd_fact_store_order_detail as a	JOIN vw_dwd_dim_store as b on a.store_id = b.store_id	GROUP BY b.store_name	ORDER BY sales_efficiency desc	) t) t2WHERE store_name='北京XXX路店'"
深圳XXX路店在华南区所有门店中销售人效排第几？,"SELECT  store_name  as '门店名称' ,sales_efficiency  as '销售人效' ,rn as '排名'FROM (	SELECT 	store_name,sales_efficiency,row_number() over (order by sales_efficiency DESC) as rn	FROM (	SELECT b.store_name, sum(a.sales_amt) / max(b.workforce) as sales_efficiency	FROM vw_dwd_fact_store_order_detail as a	JOIN vw_dwd_dim_store as b on a.store_id = b.store_id	WHERE b.area_name = '华南区'	GROUP BY b.store_name	ORDER BY sales_efficiency desc	) t) t2WHERE store_name='深圳XXX路店'"
在所有门店中，哪些门店的销售人效最需要改进？,"	SELECT b.store_name  as '门店名称' , sum(a.sales_amt) / max(b.workforce)  as '销售人效'	FROM vw_dwd_fact_store_order_detail as a	JOIN vw_dwd_dim_store as b on a.store_id = b.store_id	GROUP BY b.store_name	ORDER BY '销售人效'asc"
去年全年销售人效的波动情况如何，是否有明显的季节性变化？,"select     date_format(c.business_date, '%Y-%m')   as '月份' ,    sum(c.sales_amt) / max(a.workforce) as '销售人效'from     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idwhere     year(c.business_date) = year(curdate()) - 1group by     date_format(c.business_date, '%Y-%m')order by     date_format(c.business_date, '%Y-%m');"
华南区去年全年销售人效的波动情况如何，是否有明显的季节性变化？,"select     date_format(c.business_date, '%Y-%m')   as '月份' ,    sum(c.sales_amt) / max(a.workforce)  as '销售人效'from     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idwhere a.area_name = '华南区' and    year(c.business_date) = year(curdate()) - 1group by     date_format(c.business_date, '%Y-%m')order by     date_format(c.business_date, '%Y-%m');"
深圳XXX路店去年全年销售人效的波动情况如何，是否有明显的季节性变化？,"select     date_format(c.business_date, '%Y-%m')   as '月份' ,    sum(c.sales_amt) / max(a.workforce)  as '销售人效'from     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idwhere a.store_name = '深圳XXX路店' and    year(c.business_date) = year(curdate()) - 1group by     date_format(c.business_date, '%Y-%m')order by     date_format(c.business_date, '%Y-%m');"
上月的销售坪效是多少？,"SELECT sum(a.sales_amt) / max(b.acreage) as '销售坪效'  FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))"
华南区上月的销售坪效是多少？,"SELECT sum(a.sales_amt) / max(b.acreage) as '销售坪效' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and b.area_name = '华南区'"
深圳XXX路店上月的销售坪效是多少？,"SELECT sum(a.sales_amt) / max(b.acreage) as '销售坪效' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and b.store_name = '深圳XXX路店'"
上个月哪些区域的销售坪效环比有提升？,"SELECT t2.area_name  as '区域名称' ,t1.sales_efficiency  as '上个月销售坪效' ,t2.sales_efficiency  as '环比销售坪效' ,t1.sales_efficiency-t2.sales_efficiency  as '环比差额' ,(t1.sales_efficiency-t2.sales_efficiency)/t2.sales_efficiency*100   as '环比变化率' from(	SELECT b.area_name, sum(a.sales_amt) / max(b.acreage) as sales_efficiency	FROM vw_dwd_fact_store_order_detail as a	JOIN vw_dwd_dim_store as b on a.store_id = b.store_id	WHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))	GROUP BY b.area_name	ORDER BY sales_efficiency DESC)t1join(	SELECT b.area_name, sum(a.sales_amt) / max(b.acreage) as sales_efficiency	FROM vw_dwd_fact_store_order_detail as a	JOIN vw_dwd_dim_store as b on a.store_id = b.store_id	WHERE year(a.business_date)=year(date_sub(curdate(), interval 2 month)) and month(a.business_date) = month(date_sub(curdate(), interval 2 month))	GROUP BY b.area_name	ORDER BY sales_efficiency DESC)t2 on t1.area_name=t2.area_nameWHERE (t1.sales_efficiency-t2.sales_efficiency)/t2.sales_efficiency >0ORDER BY  '环比变化率'   "
上个月，哪个区域的销售坪效表现最为突出？,"SELECT b.area_name  as '区域名称' , sum(a.sales_amt) / max(b.acreage) as '销售坪效'FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))GROUP BY b.area_nameORDER BY '销售坪效' DESCLIMIT 1"
上个月，哪些门店的销售坪效最差？,"SELECT b.store_name  as '门店名称' , sum(a.sales_amt) / max(b.acreage) as '销售坪效'FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))GROUP BY b.store_nameORDER BY '销售坪效' ASCLIMIT 10"
上个月，华南区哪些门店的销售坪效最差？,"SELECT b.store_name  as '门店名称' , sum(a.sales_amt) / max(b.acreage) as '销售坪效'FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))    and b.area_name = '华南区'GROUP BY b.store_nameORDER BY  '销售坪效'  ASCLIMIT 5"
北京XXX路店在所有门店中销售坪效排第几？,"SELECT store_name  as '门店名称' ,sales_efficiency  as '销售坪效' ,rn as '排名'FROM (	SELECT 	store_name,sales_efficiency,row_number() over (order by sales_efficiency DESC) as rn	FROM (	SELECT b.store_name, sum(a.sales_amt) / max(b.acreage) as sales_efficiency	FROM vw_dwd_fact_store_order_detail as a	JOIN vw_dwd_dim_store as b on a.store_id = b.store_id	GROUP BY b.store_name	ORDER BY sales_efficiency desc	) t) t2WHERE store_name='北京XXX路店'"
北京XXX路店在华北区所有门店中销售坪效排第几？,"SELECT  store_name  as '门店名称' ,sales_efficiency  as '销售坪效' ,rn as '排名'FROM (	SELECT 	store_name,sales_efficiency,row_number() over (order by sales_efficiency DESC) as rn	FROM (	SELECT b.store_name, sum(a.sales_amt) / max(b.acreage) as sales_efficiency	FROM vw_dwd_fact_store_order_detail as a	JOIN vw_dwd_dim_store as b on a.store_id = b.store_id	WHERE b.area_name = '华北区'	GROUP BY b.store_name	ORDER BY sales_efficiency desc	) t) t2WHERE store_name='北京XXX路店'"
在所有门店中，哪些门店的销售坪效最需要改进？,"   	SELECT b.store_name  as '门店名称' , sum(a.sales_amt) / max(b.acreage)  as '销售坪效' 	FROM vw_dwd_fact_store_order_detail as a	JOIN vw_dwd_dim_store as b on a.store_id = b.store_id	GROUP BY b.store_name	ORDER BY '销售坪效'  asc"
去年全年销售坪效的波动情况如何，是否有明显的季节性变化？,"select     date_format(c.business_date, '%Y-%m')   as '月份' ,    sum(c.sales_amt) / max(a.acreage)   as '销售坪效'from     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idwhere     year(c.business_date) = year(curdate()) - 1group by     date_format(c.business_date, '%Y-%m')order by     date_format(c.business_date, '%Y-%m');"
华南区去年全年销售坪效的波动情况如何，是否有明显的季节性变化？,"select     date_format(c.business_date, '%Y-%m') as '月份',     sum(c.sales_amt) / max(a.acreage) as '销售坪效' from     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idwhere a.area_name = '华南区' and    year(c.business_date) = year(curdate()) - 1group by     date_format(c.business_date, '%Y-%m')order by     date_format(c.business_date, '%Y-%m');"
深圳XXX路店去年全年销售坪效的波动情况如何，是否有明显的季节性变化？,"select     date_format(c.business_date, '%Y-%m') as '月份',     sum(c.sales_amt) / max(a.acreage) as '销售坪效' from     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idwhere a.store_name = '深圳XXX路店' and    year(c.business_date) = year(curdate()) - 1group by     date_format(c.business_date, '%Y-%m')order by     date_format(c.business_date, '%Y-%m');"
上月的销售人效、坪效是多少？,"SELECT sum(a.sales_amt) / max(b.workforce) as '销售人效' ,  sum(a.sales_amt) / max(b.acreage) as '销售坪效' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))"
上月各区域的销售人效、坪效是多少？,"SELECT  b.area_name  as '区域名称' ,sum(a.sales_amt) / max(b.workforce) as '销售人效' ,  sum(a.sales_amt) / max(b.acreage) as '销售坪效' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) group by 1"
上月华南区各门店的销售人效、坪效是多少？,"SELECT  b.store_name  as '门店名称' ,sum(a.sales_amt) / max(b.workforce) as '销售人效' ,  sum(a.sales_amt) / max(b.acreage) as '销售坪效' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and  b.area_name = '华南区'group by 1"
上个月，会员销售额是多少？,"SELECT sum(a.sales_amt)   as '销售额'  FROM vw_dwd_fact_store_order_detail aWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))    and is_member = '会员'"
华南区上个月，会员销售额是多少？,"SELECT sum(a.sales_amt)   as '销售额'  FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))    and a.is_member = '会员'    and b.area_name = '华南区'"
昨天的会员销售额占总销售额的百分比是多少？,SELECT (sum(case when is_member = '会员' then sales_amt else 0 end) / sum(sales_amt)) * 100  as '销售额占比'  FROM vw_dwd_fact_store_order_detailWHERE business_date = curdate() - interval 1 day
华南区昨天的会员销售额占总销售额的百分比是多少？,SELECT (sum(case when a.is_member = '会员' then a.sales_amt else 0 end) / sum(a.sales_amt)) * 100 as '销售额占比'  FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE a.business_date = curdate() - interval 1 day    and b.area_name = '华南区'
深圳XXX路店昨天的会员销售额占总销售额的百分比是多少？,SELECT (sum(case when a.is_member = '会员' then a.sales_amt else 0 end) / sum(a.sales_amt)) * 100 as '销售额占比' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE a.business_date = curdate() - interval 1 day    and b.store_name = '深圳XXX路店'
本周的会员销售额与上周相比有何变化？,"SELECT t1.sales_amt  as '本周销售额'  ,t2.sales_amt  as '上周销售额' ,t1.sales_amt-t2.sales_amt  as '环比差额' ,(t1.sales_amt-t2.sales_amt)/t2.sales_amt*100  as '环比变化率' FROM (SELECT SUM(sales_amt) AS sales_amtFROM vw_dwd_fact_store_order_detailWHERE (year(business_date) = year(curdate()) and weekofyear(business_date) = weekofyear(curdate()))AND is_member = '会员')t1,(SELECT SUM(sales_amt) AS sales_amtFROM vw_dwd_fact_store_order_detailWHERE (year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week)))AND is_member = '会员')t2"
华南区本周的会员销售额与上周相比有何变化？,"SELECT t1.sales_amt  as '本周销售额'  ,t2.sales_amt  as '上周销售额' ,t1.sales_amt-t2.sales_amt  as '环比差额' ,(t1.sales_amt-t2.sales_amt)/t2.sales_amt*100  as '环比变化率' FROM (SELECT SUM(sales_amt) AS sales_amtFROM vw_dwd_fact_store_order_detail aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE (year(business_date) = year(curdate()) and weekofyear(business_date) = weekofyear(curdate()))AND is_member = '会员' AND b.area_name = '华南区')t1,(SELECT SUM(sales_amt) AS sales_amtFROM vw_dwd_fact_store_order_detail a JOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE (year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week)))AND is_member = '会员' AND b.area_name = '华南区')t2"
深圳XXX路店本周的会员销售额与上周相比有何变化？,"    SELECT t1.sales_amt  as '本周销售额'  ,t2.sales_amt  as '上周销售额' ,t1.sales_amt-t2.sales_amt  as '环比差额' ,(t1.sales_amt-t2.sales_amt)/t2.sales_amt*100  as '环比变化率' FROM (SELECT SUM(sales_amt) AS sales_amtFROM vw_dwd_fact_store_order_detail aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE (year(business_date) = year(curdate()) and weekofyear(business_date) = weekofyear(curdate()))AND is_member = '会员' AND b.store_name = '深圳XXX路店')t1,(SELECT SUM(sales_amt) AS sales_amtFROM vw_dwd_fact_store_order_detail a JOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE (year(business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(business_date) = weekofyear(date_sub(curdate(), interval 1 week)))AND is_member = '会员' AND b.store_name = '深圳XXX路店')t2"
上个月，各个区域的会员销售额怎样？,"SELECT b.area_name  as '区域名称' , sum(a.sales_amt)    as '销售额' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))    and a.is_member = '会员'GROUP BY b.area_name"
上个月，哪个区域的会员销售额最高？,"SELECT b.area_name  as '区域名称' , sum(a.sales_amt)    as '销售额' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))    and a.is_member = '会员'GROUP BY b.area_nameORDER BY '销售额' DESCLIMIT 1"
本月深圳XXX路店的会员销售额是多少？,SELECT sum(a.sales_amt)   as '销售额'  FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE month(a.business_date) = month(curdate())    and year(a.business_date) = year(curdate())    and a.is_member = '会员'    and b.store_name = '深圳XXX路店'
本月婴儿用品品类的会员销售额是多少？,SELECT sum(a.sales_amt)   as '销售额'  FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_item as b on a.item_id = b.item_idWHERE month(a.business_date) = month(curdate())    and year(a.business_date) = year(curdate())    and a.is_member = '会员'    and b.category_name_level1 = '婴儿用品'
本月华南区婴儿用品品类的会员销售额是多少？,SELECT sum(a.sales_amt)   as '销售额'  FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_item as b on a.item_id = b.item_idJOIN vw_dwd_dim_store as c on a.store_id = c.store_idWHERE month(a.business_date) = month(curdate())    and year(a.business_date) = year(curdate())    and a.is_member = '会员'    and b.category_name_level1 = '婴儿用品'    and c.area_name = '华南区'
本月深圳XXX路店婴儿用品品类的会员销售额是多少？,SELECT sum(a.sales_amt)   as '销售额'  FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_item as b on a.item_id = b.item_idJOIN vw_dwd_dim_store as c on a.store_id = c.store_idWHERE month(a.business_date) = month(curdate())    and year(a.business_date) = year(curdate())    and a.is_member = '会员'    and b.category_name_level1 = '婴儿用品'    and c.store_name = '深圳XXX路店'
线上渠道会员销售额是多少？,SELECT sum(a.sales_amt)   as '销售额'  FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as b on a.channel_id = b.channel_idWHERE b.channel_name = '线上'    and a.is_member = '会员'
华南区线上渠道会员销售额是多少？,SELECT sum(a.sales_amt)   as '销售额'  FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idJOIN vw_dwd_dim_store as e on a.store_id = e.store_idWHERE e.area_name = '华南区'    and c.channel_name = '线上'    and a.is_member = '会员'
深圳XXX路店线上渠道会员销售额是多少？,SELECT sum(a.sales_amt)   as '销售额'  FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idJOIN vw_dwd_dim_store as e on a.store_id = e.store_idWHERE e.store_name = '深圳XXX路店'    and c.channel_name = '线上'    and a.is_member = '会员'
去年全年，月会员销售额的增长趋势是怎样的？,"SELECT month(business_date)   as '月份' , sum(sales_amt)   as '销售额'  FROM vw_dwd_fact_store_order_detailWHERE year(business_date) = year(curdate()) - 1    and is_member = '会员'GROUP BY month(business_date)ORDER BY month(business_date)"
去年全年，深圳XXX路店的月会员销售额的增长趋势是怎样的？,"SELECT month(business_date)   as '月份' , sum(sales_amt)   as '销售额'  FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date) = year(curdate()) - 1    and a.is_member = '会员'    and b.store_name = '深圳XXX路店'GROUP BY month(a.business_date)ORDER BY month(a.business_date)"
去年全年，各区域的月会员销售额的增长趋势是怎样的？,"SELECT month(a.business_date)   as '月份', b.area_name  as '区域名称' , sum(a.sales_amt) as '销售额'  FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date) = year(curdate()) - 1    and a.is_member = '会员'GROUP BY month(a.business_date), b.area_nameORDER BY month(a.business_date), b.area_name"
昨天的会员客单数是多少？,SELECT count(distinct order_id)   as '会员客单数' FROM vw_dwd_fact_store_order_detailWHERE date(business_date) = curdate() - interval 1 day    and is_member = '会员'
华南区昨天的会员客单数是多少？,SELECT count(distinct a.order_id)   as '会员客单数' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE date(a.business_date) = curdate() - interval 1 day    and a.is_member = '会员'    and b.area_name = '华南区'
深圳XXX路店昨天的会员客单数是多少？,SELECT count(distinct a.order_id)   as '会员客单数' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE date(a.business_date) = curdate() - interval 1 day    and a.is_member = '会员'    and b.store_name = '深圳XXX路店'
昨天的会员客单数占比是多少？,SELECT     count(distinct case when is_member = '会员' then order_id else null end) / count(distinct order_id)*100   as '会员客单数占比' FROM vw_dwd_fact_store_order_detailWHERE date(business_date) = curdate() - interval 1 day
华南区昨天的会员客单数占比是多少？,SELECT         count(distinct case when is_member = '会员' then order_id else null end) / count(distinct order_id)*100   as '会员客单数占比' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE date(a.business_date) = curdate() - interval 1 day    and b.area_name = '华南区'
深圳XXX路店昨天的会员客单数占比是多少？,SELECT         count(distinct case when is_member = '会员' then order_id else null end) / count(distinct order_id)*100   as '会员客单数占比' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE date(a.business_date) = curdate() - interval 1 day    and b.store_name = '深圳XXX路店'
本周与上周相比，会员客单数有何变化？,"SELECT this_week_member_orders  as '本周会员客单数' ,last_week_member_orders  as '上周会员客单数' ,this_week_member_orders-last_week_member_orders   as '环比差额'  ,ifnull((this_week_member_orders-last_week_member_orders)/last_week_member_orders,0)*100  as '环比变化率' FROM(	SELECT 	    count(distinct case when (year(a.business_date)=year(curdate()) and weekofyear(a.business_date) = weekofyear(curdate())) then a.order_id else null end) as this_week_member_orders,	    count(distinct case when (year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week))) then a.order_id else null end) as last_week_member_orders	FROM vw_dwd_fact_store_order_detail as a	WHERE 	a.is_member = '会员' and (	(year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week)))	OR (	year(a.business_date)=year(curdate()) and weekofyear(a.business_date) = weekofyear(curdate())	)))t"
本周与上周相比，华南区会员客单数有何变化？,"SELECT this_week_member_orders  as '本周会员客单数' ,last_week_member_orders  as '上周会员客单数' ,this_week_member_orders-last_week_member_orders   as '环比差额'  ,ifnull((this_week_member_orders-last_week_member_orders)/last_week_member_orders,0)*100  as '环比变化率' FROM(	SELECT 	    count(distinct case when (year(a.business_date)=year(curdate()) and weekofyear(a.business_date) = weekofyear(curdate())) then a.order_id else null end) as this_week_member_orders,	    count(distinct case when (year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week))) then a.order_id else null end) as last_week_member_orders	FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_id	WHERE 	a.is_member = '会员'     and b.area_name = '华南区'and (	(year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week)))	OR (	year(a.business_date)=year(curdate()) and weekofyear(a.business_date) = weekofyear(curdate())	)))t"
本周与上周相比，深圳XXX路店会员客单数有何变化？,"SELECT this_week_member_orders  as '本周会员客单数' ,last_week_member_orders  as '上周会员客单数' ,this_week_member_orders-last_week_member_orders   as '环比差额'  ,ifnull((this_week_member_orders-last_week_member_orders)/last_week_member_orders,0)*100  as '环比变化率' FROM(	SELECT 	    count(distinct case when (year(a.business_date)=year(curdate()) and weekofyear(a.business_date) = weekofyear(curdate())) then a.order_id else null end) as this_week_member_orders,	    count(distinct case when (year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week))) then a.order_id else null end) as last_week_member_orders	FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_id	WHERE 	a.is_member = '会员'     and b.store_name = '深圳XXX路店'and (	(year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week)))	OR (	year(a.business_date)=year(curdate()) and weekofyear(a.business_date) = weekofyear(curdate())	)))t"
本月的会员客单数占比是多少？,SELECT     count(distinct case when is_member = '会员' then order_id else null end) / count(distinct order_id)*100   as '会员客单数占比' FROM vw_dwd_fact_store_order_detailWHERE year(business_date) = year(curdate()) and month(business_date) = month(curdate())
华南区本月的会员客单数占比是多少？,SELECT     count(distinct case when is_member = '会员' then order_id else null end) / count(distinct order_id)*100   as '会员客单数占比' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date) = year(curdate()) and month(a.business_date) = month(curdate())    and b.area_name = '华南区'
深圳XXX路店本月的会员客单数占比是多少？,SELECT     count(distinct case when is_member = '会员' then order_id else null end) / count(distinct order_id)*100   as '会员客单数占比' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date) = year(curdate()) and month(a.business_date) = month(curdate())    and b.store_name = '深圳XXX路店'
上个月，哪些区域的会员客单数同比增长最快？,"SELECT area_name  as '区域名称'  ,this_year_member_orders  as '上个月会员客单数' ,last_year_member_orders  as '去年同期会员客单数' ,this_year_member_orders  - last_year_member_orders   as '同比差额'  ,ifnull((this_year_member_orders - last_year_member_orders) / last_year_member_orders,0) *100  as '同比变化率'FROM(SELECT     b.area_name,    count(distinct case when (year(a.business_date)=year(date_sub(curdate(), interval 1 month))-1 and month(a.business_date) = month(date_sub(curdate(), interval 1 month))) then a.order_id else null end) as last_year_member_orders,    count(distinct case when (year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))) then a.order_id else null end) as this_year_member_ordersFROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE a.is_member = '会员'GROUP BY b.area_name) tORDER BY '同比变化率' descLIMIT 1"
上个月深圳XXX路店的会员客单数占比是多少？,"SELECT     count(distinct case when is_member = '会员' then order_id else null end) / count(distinct order_id)*100   as '会员客单数占比' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))    and b.store_name = '深圳XXX路店'"
上个月线上和线下渠道的会员客单数分别是多少？,"SELECT c.channel_name  as '渠道名称'  , count(distinct a.order_id)   as '客单数' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))    and a.is_member = '会员'GROUP BY c.channel_name"
上个月华南区线上和线下渠道的会员客单数分别是多少？,"SELECT c.channel_name  as '渠道名称'  , count(distinct a.order_id)   as '客单数' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idJOIN vw_dwd_dim_store as e on a.store_id = e.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))    and a.is_member = '会员'	and e.area_name = '华南区'GROUP BY c.channel_name"
上个月深圳XXX路店线上和线下渠道的会员客单数分别是多少？,"SELECT c.channel_name  as '渠道名称'  , count(distinct a.order_id)   as '客单数' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idJOIN vw_dwd_dim_store as e on a.store_id = e.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))    and a.is_member = '会员'	and e.store_name = '深圳XXX路店'GROUP BY c.channel_name"
去年全年，会员客单数的月增长趋势如何？,"SELECT     month(a.business_date)   as '月份' ,count(distinct case when is_member = '会员' then order_id else null end)   as '会员客单数'  ,    count(distinct case when is_member = '会员' then order_id else null end) / count(distinct order_id)   as '会员客单数占比' FROM vw_dwd_fact_store_order_detail as aWHERE year(a.business_date) = year(curdate())-1GROUP BY month(a.business_date) ORDER BY month(a.business_date) "
去年全年，华南区会员客单数的月增长趋势如何？,"SELECT     month(a.business_date) as '月份' ,count(distinct case when is_member = '会员' then order_id else null end)  as '会员客单数'  ,    count(distinct case when is_member = '会员' then order_id else null end) / count(distinct order_id)   as '会员客单数占比' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date) = year(curdate())-1  and b.area_name = '华南区'GROUP BY month(a.business_date) "
去年全年，深圳XXX路店会员客单数的月增长趋势如何？,"SELECT     month(a.business_date) as '月份' ,count(distinct case when is_member = '会员' then order_id else null end)  as '会员客单数'  ,    count(distinct case when is_member = '会员' then order_id else null end) / count(distinct order_id)  as '会员客单数占比' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date) = year(curdate())-1  and b.store_name = '深圳XXX路店'GROUP BY month(a.business_date) "
昨天的会员客单价是多少？,"SELECT     sum(a.sales_amt) / count(distinct a.order_id)   as '会员客单价' FROM vw_dwd_fact_store_order_detail as aWHERE a.is_member = '会员' and date(a.business_date) = date_sub(curdate(), interval 1 day)"
华南区昨天的会员客单价是多少？,SELECT   sum(a.sales_amt) / count(distinct a.order_id)   as '会员客单价' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE date(a.business_date) = curdate() - interval 1 day    and a.is_member = '会员'    and b.area_name = '华南区'
深圳XXX路店昨天的会员客单价是多少？,SELECT   sum(a.sales_amt) / count(distinct a.order_id)   as '会员客单价' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE date(a.business_date) = curdate() - interval 1 day    and a.is_member = '会员'    and b.store_name = '深圳XXX路店'
本周与上周相比，会员客单价有何变化？,"SELECT this_week_sales_amt/this_week_member_orders   as '本周会员客单价' ,last_week_sales_amt/last_week_member_orders   as '上周会员客单价' ,(this_week_sales_amt/this_week_member_orders )-(last_week_sales_amt/last_week_member_orders )   as '环比差额'  ,ifnull(((this_week_sales_amt/this_week_member_orders)-(last_week_sales_amt/last_week_member_orders))/(last_week_sales_amt/last_week_member_orders),0)*100   as '环比变化率' FROM(	SELECT 		sum(case when (year(a.business_date)=year(curdate()) and weekofyear(a.business_date) = weekofyear(curdate())) then a.sales_amt else 0 end) as this_week_sales_amt,	    sum(case when (year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week))) then a.sales_amt else 0 end) as last_week_sales_amt,	    count(distinct case when (year(a.business_date)=year(curdate()) and weekofyear(a.business_date) = weekofyear(curdate())) then a.order_id else null end) as this_week_member_orders,	    count(distinct case when (year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week))) then a.order_id else null end) as last_week_member_orders	FROM vw_dwd_fact_store_order_detail as a	WHERE 	a.is_member = '会员' and (	(year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week)))	OR (	year(a.business_date)=year(curdate()) and weekofyear(a.business_date) = weekofyear(curdate())	)))t"
本周与上周相比，华南区会员客单价有何变化？,"SELECT this_week_sales_amt/this_week_member_orders   as '本周会员客单价' ,last_week_sales_amt/last_week_member_orders   as '上周会员客单价' ,(this_week_sales_amt/this_week_member_orders )-(last_week_sales_amt/last_week_member_orders )   as '环比差额'  ,ifnull(((this_week_sales_amt/this_week_member_orders)-(last_week_sales_amt/last_week_member_orders))/(last_week_sales_amt/last_week_member_orders),0)*100   as '环比变化率' FROM(	SELECT 		sum(case when (year(a.business_date)=year(curdate()) and weekofyear(a.business_date) = weekofyear(curdate())) then a.sales_amt else 0 end) as this_week_sales_amt,	    sum(case when (year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week))) then a.sales_amt else 0 end) as last_week_sales_amt,	    count(distinct case when (year(a.business_date)=year(curdate()) and weekofyear(a.business_date) = weekofyear(curdate())) then a.order_id else null end) as this_week_member_orders,	    count(distinct case when (year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week))) then a.order_id else null end) as last_week_member_orders	FROM vw_dwd_fact_store_order_detail as a	JOIN vw_dwd_dim_store as b on a.store_id = b.store_id	WHERE 	a.is_member = '会员' and b.area_name = '华南区' and (	(year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week)))	OR (	year(a.business_date)=year(curdate()) and weekofyear(a.business_date) = weekofyear(curdate())	)))t"
本周与上周相比，深圳XXX路店会员客单价有何变化？,"SELECT this_week_sales_amt/this_week_member_orders   as '本周会员客单价' ,last_week_sales_amt/last_week_member_orders   as '上周会员客单价' ,(this_week_sales_amt/this_week_member_orders )-(last_week_sales_amt/last_week_member_orders )   as '环比差额'  ,ifnull(((this_week_sales_amt/this_week_member_orders)-(last_week_sales_amt/last_week_member_orders))/(last_week_sales_amt/last_week_member_orders),0)*100   as '环比变化率' FROM(	SELECT 		sum(case when (year(a.business_date)=year(curdate()) and weekofyear(a.business_date) = weekofyear(curdate())) then a.sales_amt else 0 end) as this_week_sales_amt,	    sum(case when (year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week))) then a.sales_amt else 0 end) as last_week_sales_amt,	    count(distinct case when (year(a.business_date)=year(curdate()) and weekofyear(a.business_date) = weekofyear(curdate())) then a.order_id else null end) as this_week_member_orders,	    count(distinct case when (year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week))) then a.order_id else null end) as last_week_member_orders	FROM vw_dwd_fact_store_order_detail as a	JOIN vw_dwd_dim_store as b on a.store_id = b.store_id	WHERE 	a.is_member = '会员' and b.store_name = '深圳XXX路店' and (	(year(a.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(a.business_date) = weekofyear(date_sub(curdate(), interval 1 week)))	OR (	year(a.business_date)=year(curdate()) and weekofyear(a.business_date) = weekofyear(curdate())	)))t"
本月各区域的会员客单价是多少？,"SELECT     b.area_name  as '区域名称'  ,    sum(a.sales_amt) / count(distinct a.order_id)   as '会员客单价' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE a.is_member = '会员' and year(a.business_date) = year(curdate()) and month(a.business_date) = month(curdate())GROUP BY b.area_name"
上个月，哪些区域的会员客单价增长最快？,"SELECT area_name  as '区域名称'  ,last_month_order_price  as '上个月会员客单价' ,last_last_month_order_price  as '环比会员客单价'  ,last_month_order_price - last_last_month_order_price   as '环比差额',(last_month_order_price - last_last_month_order_price)/ last_last_month_order_price*100  as '同比变化率'FROM (SELECT     b.area_name,   sum(case when year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))	then a.sales_amt else 0 end) /      count(distinct case when year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))	 then a.order_id else 0 end) as last_month_order_price 		    ,sum(case when year(a.business_date)=year(date_sub(curdate(), interval 2 month)) and month(a.business_date) = month(date_sub(curdate(), interval 2 month))	then a.sales_amt else 0 end) /      count(distinct case when year(a.business_date)=year(date_sub(curdate(), interval 2 month)) and month(a.business_date) = month(date_sub(curdate(), interval 2 month))	 then a.order_id else 0 end) as last_last_month_order_price FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE a.is_member = '会员' and ((year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)))or(year(a.business_date)=year(date_sub(curdate(), interval 2 month)) and month(a.business_date) = month(date_sub(curdate(), interval 2 month))))GROUP BY b.area_name) t ORDER BY '同比变化率' DESC"
上个月，深圳XXX路店的会员客单价是多少？,"SELECT     sum(a.sales_amt) / count(distinct a.order_id)   as '会员客单价' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE a.is_member = '会员' and b.store_name = '深圳XXX路店' and year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))"
上个月，线上和线下渠道的会员客单价分别是多少？,"SELECT c.channel_name  as '渠道名称'  , sum(a.sales_amt) / count(distinct a.order_id)     as '会员客单价'  FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))    and a.is_member = '会员'GROUP BY c.channel_name"
上个月，华南区线上和线下渠道的会员客单价分别是多少？,"SELECT c.channel_name  as '渠道名称'  , sum(a.sales_amt) / count(distinct a.order_id)     as '会员客单价' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idJOIN vw_dwd_dim_store as e on a.store_id = e.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))    and a.is_member = '会员'	and e.area_name = '华南区'GROUP BY c.channel_name"
上个月，深圳XXX路店线上和线下渠道的会员客单价分别是多少？,"SELECT c.channel_name  as '渠道名称'  , sum(a.sales_amt) / count(distinct a.order_id)     as '会员客单价' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_channel as c on a.channel_id = c.channel_idJOIN vw_dwd_dim_store as e on a.store_id = e.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))    and a.is_member = '会员'	and e.store_name = '深圳XXX路店'GROUP BY c.channel_name"
去年全年，会员客单价的月增长趋势如何？,"select     date_format(business_date, '%Y-%m')   as '月份' ,     sum(sales_amt) / count(distinct order_id)   as '会员客单价' from     vw_dwd_fact_store_order_detailwhere     is_member = '会员' and     year(business_date) = year(curdate()) - 1group by     date_format(business_date, '%Y-%m')order by     date_format(business_date, '%Y-%m') "
去年全年，华南区会员客单价的月增长趋势如何？,"   select     date_format(a.business_date, '%Y-%m')  as '月份' ,     sum(a.sales_amt) / count(distinct a.order_id) as '会员客单价' from     vw_dwd_fact_store_order_detail ajoin     vw_dwd_dim_store b on a.store_id = b.store_idwhere     a.is_member = '会员' and     b.area_name = '华南区' and     year(a.business_date) = year(curdate()) - 1group by     date_format(a.business_date, '%Y-%m')order by     date_format(business_date, '%Y-%m') "
去年全年，深圳XXX路店会员客单价的月增长趋势如何？,"   select         date_format(a.business_date, '%Y-%m')  as '月份' ,     sum(a.sales_amt) / count(distinct a.order_id) as '会员客单价' from     vw_dwd_fact_store_order_detail ajoin     vw_dwd_dim_store b on a.store_id = b.store_idwhere     a.is_member = '会员' and     b.store_name = '深圳XXX路店' and     year(a.business_date) = year(curdate()) - 1group by     date_format(a.business_date, '%Y-%m')order by     date_format(business_date, '%Y-%m') "
昨天新增了多少会员？,"SELECT COUNT(DISTINCT member_id)   as '新增会员数' FROM vw_dwd_dim_sale_member_label WHERE business_date = DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND member_status = '有效会员' AND member_type = '新会员'"
华南区昨天新增了多少会员？,"SELECT COUNT(DISTINCT b.member_id)   as '新增会员数' FROM vw_dwd_fact_store_order_detail a JOIN vw_dwd_dim_sale_member_label b ON a.member_detail_id = b.member_detail_idJOIN vw_dwd_dim_store c ON a.store_id = c.store_idWHERE a.business_date = DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND c.area_name = '华南区' AND b.member_status = '有效会员' AND b.member_type = '新会员'"
深圳XXX路店昨天新增了多少会员？,"SELECT COUNT(DISTINCT b.member_id)   as '新增会员数' FROM vw_dwd_fact_store_order_detail a JOIN vw_dwd_dim_sale_member_label b ON a.member_detail_id = b.member_detail_idJOIN vw_dwd_dim_store c ON a.store_id = c.store_idWHERE a.business_date = DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND c.store_name = '深圳XXX路店' AND b.member_status = '有效会员' AND b.member_type = '新会员'"
上个月，哪个区域的新增会员环比增长最快？,"select t1.prev_month_new_member  as '上个月新增会员数' ,t2.prev_2_month_new_member  as '环比新增会员数'  ,t1.prev_month_new_member-t2.prev_2_month_new_member  as '环比差额'  ,ifnull((t1.prev_month_new_member-t2.prev_2_month_new_member)/t2.prev_2_month_new_member,0)*100   as '环比变化率' from (select count(distinct member_id) as prev_month_new_memberfrom      vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idjoin     vw_dwd_dim_sale_member_label b on c.member_detail_id = b.member_detail_idwhere     b.member_type = '新会员' and      year(b.business_date)=year(date_sub(curdate(), interval 1 month)) and month(b.business_date) = month(date_sub(curdate(), interval 1 month))) t1,(select count(distinct member_id) as prev_2_month_new_memberfrom      vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idjoin     vw_dwd_dim_sale_member_label b on c.member_detail_id = b.member_detail_idwhere     b.member_type = '新会员' and      year(b.business_date)=year(date_sub(curdate(), interval 2 month)) and month(b.business_date) = month(date_sub(curdate(), interval 2 month))) t2"
最近6个月，新增会员数是否有显著的波动？,"select     date_format(business_date, '%Y-%m')   as '月份' ,     count(distinct member_id)   as '新增会员数' from     vw_dwd_dim_sale_member_labelwhere     member_type = '新会员' and     business_date between date_format(date_sub(curdate(), interval 5 month), '%Y-%m-01') and curdate()group by     date_format(business_date, '%Y-%m')order by     date_format(business_date, '%Y-%m') ;"
最近6个月，华南区新增会员数是否有显著的波动？,"   select     date_format(b.business_date, '%Y-%m') as '月份' ,      count(distinct b.member_id) as '新增会员数' from     vw_dwd_dim_sale_member_label bjoin     vw_dwd_fact_store_order_detail c on b.member_detail_id = c.member_detail_idjoin     vw_dwd_dim_store a on c.store_id = a.store_idwhere     b.member_type = '新会员' and     a.area_name = '华南区' and     b.business_date between date_format(date_sub(curdate(), interval 5 month), '%Y-%m-01') and curdate()group by     date_format(b.business_date, '%Y-%m')order by     date_format(b.business_date, '%Y-%m');"
最近6个月，深圳XXX路店新增会员数是否有显著的波动？,"   select     date_format(b.business_date, '%Y-%m') as '月份' ,      count(distinct b.member_id) as '新增会员数' from     vw_dwd_dim_sale_member_label bjoin     vw_dwd_fact_store_order_detail c on b.member_detail_id = c.member_detail_idjoin     vw_dwd_dim_store a on c.store_id = a.store_idwhere     a.store_name = '深圳XXX路店' and     a.area_name = '华南区' and     b.business_date between date_format(date_sub(curdate(), interval 5 month), '%Y-%m-01') and curdate()group by     date_format(b.business_date, '%Y-%m')order by     date_format(b.business_date, '%Y-%m');"
上个月，哪些门店的新增会员最多？,"select     a.store_name  as '门店名称' ,     count(distinct b.member_id)   as '新增会员数' from     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idjoin     vw_dwd_dim_sale_member_label b on c.member_detail_id = b.member_detail_idwhere     b.member_type = '新会员' and     year(b.business_date)=year(date_sub(curdate(), interval 1 month)) and month(b.business_date) = month(date_sub(curdate(), interval 1 month))group by     a.store_nameorder by     '新增会员数'  desc;"
上个月，华南区哪些门店的新增会员最多？,"select     a.store_name  as '门店名称' ,     count(distinct b.member_id)   as '新增会员数' from     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idjoin     vw_dwd_dim_sale_member_label b on c.member_detail_id = b.member_detail_idwhere     b.member_type = '新会员' and     a.area_name = '华南区' and     year(b.business_date)=year(date_sub(curdate(), interval 1 month)) and month(b.business_date) = month(date_sub(curdate(), interval 1 month))group by     a.store_nameorder by     '新增会员数' desc;   "
上个月，线上渠道的新增会员有多少？,"select     count(distinct b.member_id) as '新增会员数' from     vw_dwd_dim_sale_member_label bjoin     vw_dwd_fact_store_order_detail c on b.member_detail_id = c.member_detail_idjoin     vw_dwd_dim_channel d on c.channel_id = d.channel_idwhere     b.member_type = '新会员' and     d.channel_name = '线上' and     year(b.business_date)=year(date_sub(curdate(), interval 1 month)) and month(b.business_date) = month(date_sub(curdate(), interval 1 month))      "
上个月，华南区线上渠道的新增会员有多少？,"select     count(distinct b.member_id) as '新增会员数' from     vw_dwd_dim_sale_member_label bjoin     vw_dwd_fact_store_order_detail c on b.member_detail_id = c.member_detail_idjoin     vw_dwd_dim_store a on c.store_id = a.store_idjoin     vw_dwd_dim_channel d on c.channel_id = d.channel_idwhere     b.member_type = '新会员' and     a.area_name = '华南区' and     d.channel_name = '线上' and     year(b.business_date)=year(date_sub(curdate(), interval 1 month)) and month(b.business_date) = month(date_sub(curdate(), interval 1 month))"
上个月，深圳XXX路店线上渠道的新增会员有多少？,"select     count(distinct b.member_id) as '新增会员数' from     vw_dwd_dim_sale_member_label bjoin     vw_dwd_fact_store_order_detail c on b.member_detail_id = c.member_detail_idjoin     vw_dwd_dim_store a on c.store_id = a.store_idjoin     vw_dwd_dim_channel d on c.channel_id = d.channel_idwhere     b.member_type = '新会员' and     a.store_name = '深圳XXX路店' and     d.channel_name = '线上' and     year(b.business_date)=year(date_sub(curdate(), interval 1 month)) and month(b.business_date) = month(date_sub(curdate(), interval 1 month))      "
今年一共新增了多少会员？,select     count(distinct member_id) as '新增会员数' from     vw_dwd_dim_sale_member_labelwhere     member_type = '新会员' and     year(business_date) = year(curdate())
华南区今年一共新增了多少会员？,select     count(distinct b.member_id) as '新增会员数' from     vw_dwd_dim_sale_member_label bjoin     vw_dwd_fact_store_order_detail c on b.member_detail_id = c.member_detail_idjoin     vw_dwd_dim_store a on c.store_id = a.store_idwhere     b.member_type = '新会员' and     a.area_name = '华南区' and     year(b.business_date) = year(curdate())
深圳XXX路店今年一共新增了多少会员？,select     count(distinct b.member_id) as '新增会员数' from     vw_dwd_dim_sale_member_label bjoin     vw_dwd_fact_store_order_detail c on b.member_detail_id = c.member_detail_idjoin     vw_dwd_dim_store a on c.store_id = a.store_idwhere     b.member_type = '新会员' and     a.store_name = '深圳XXX路店' and     year(b.business_date) = year(curdate())
上个月，各大区的新增会员数分布如何？,"select     a.area_name,     count(distinct b.member_id) as '新增会员数' from     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idjoin     vw_dwd_dim_sale_member_label b on c.member_detail_id = b.member_detail_idwhere     b.member_type = '新会员' and     year(b.business_date)=year(date_sub(curdate(), interval 1 month)) and month(b.business_date) = month(date_sub(curdate(), interval 1 month))group by     a.area_name"
上个月有多少活跃会员？,"select     count(distinct member_id)   as '活跃会员数' from     vw_dwd_dim_sale_member_labelwhere     member_type = '活跃会员' and     year(business_date)=year(date_sub(curdate(), interval 1 month)) and month(business_date) = month(date_sub(curdate(), interval 1 month))"
华南区上个月有多少活跃会员？,"select     count(distinct b.member_id)   as '活跃会员数' from     vw_dwd_dim_sale_member_label bjoin     vw_dwd_fact_store_order_detail c on b.member_detail_id = c.member_detail_idjoin     vw_dwd_dim_store a on c.store_id = a.store_idwhere     b.member_type = '活跃会员' and     a.area_name = '华南区' and     year(b.business_date)=year(date_sub(curdate(), interval 1 month)) and month(b.business_date) = month(date_sub(curdate(), interval 1 month))    "
深圳XXX路店上个月有多少活跃会员？,"select     count(distinct b.member_id)   as '活跃会员数' from     vw_dwd_dim_sale_member_label bjoin     vw_dwd_fact_store_order_detail c on b.member_detail_id = c.member_detail_idjoin     vw_dwd_dim_store a on c.store_id = a.store_idwhere     a.store_name = '深圳XXX路店' and     a.area_name = '华南区' and     year(b.business_date)=year(date_sub(curdate(), interval 1 month)) and month(b.business_date) = month(date_sub(curdate(), interval 1 month))    "
上个月，哪个区域的活跃会员最多？,"select     a.area_name   as '区域名称'  ,     count(distinct b.member_id)   as '活跃会员数' from     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idjoin     vw_dwd_dim_sale_member_label b on c.member_detail_id = b.member_detail_idwhere     b.member_type = '活跃会员' and     year(b.business_date)=year(date_sub(curdate(), interval 1 month)) and month(b.business_date) = month(date_sub(curdate(), interval 1 month))group by     a.area_nameorder by     '活跃会员数'  desclimit 1;"
最近6个月，活跃会员是否有显著的波动？,"select     date_format(business_date, '%Y-%m')   as '月份' ,     count(distinct member_id)  as '活跃会员数' from     vw_dwd_dim_sale_member_labelwhere     member_type = '活跃会员' and     business_date between date_format(date_sub(curdate(), interval 5 month), '%Y-%m-01') and curdate()group by     date_format(business_date, '%Y-%m')order by     date_format(business_date, '%Y-%m');"
最近6个月，华南区活跃会员是否有显著的波动？,"   select     date_format(b.business_date, '%Y-%m')   as '月份' ,     count(distinct b.member_id)  as '活跃会员数' from     vw_dwd_dim_sale_member_label bjoin     vw_dwd_fact_store_order_detail c on b.member_detail_id = c.member_detail_idjoin     vw_dwd_dim_store a on c.store_id = a.store_idwhere     b.member_type = '活跃会员' and     a.area_name = '华南区' and     b.business_date between date_format(date_sub(curdate(), interval 5 month), '%Y-%m-01') and curdate()group by     date_format(b.business_date, '%Y-%m')order by     date_format(b.business_date, '%Y-%m');"
最近6个月，深圳XXX路店活跃会员是否有显著的波动？,"   select     date_format(b.business_date, '%Y-%m')   as '月份' ,     count(distinct b.member_id)  as '活跃会员数' from     vw_dwd_dim_sale_member_label bjoin     vw_dwd_fact_store_order_detail c on b.member_detail_id = c.member_detail_idjoin     vw_dwd_dim_store a on c.store_id = a.store_idwhere     b.member_type = '活跃会员' and     a.store_name = '深圳XXX路店' and     b.business_date between date_format(date_sub(curdate(), interval 5 month), '%Y-%m-01') and curdate()group by     date_format(b.business_date, '%Y-%m')order by     date_format(b.business_date, '%Y-%m');"
上个月，哪些门店的活跃会员最多？,"select     a.store_name  as '门店名称' ,     count(distinct b.member_id)   as '活跃会员数' from     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idjoin     vw_dwd_dim_sale_member_label b on c.member_detail_id = b.member_detail_idwhere     b.member_type = '活跃会员' and     year(b.business_date)=year(date_sub(curdate(), interval 1 month)) and month(b.business_date) = month(date_sub(curdate(), interval 1 month))group by     a.store_nameorder by      '活跃会员数'  desc"
上个月，线上渠道的活跃会员有多少？,"select     count(distinct b.member_id)  as '活跃会员数' from     vw_dwd_dim_sale_member_label bjoin     vw_dwd_fact_store_order_detail c on b.member_detail_id = c.member_detail_idjoin     vw_dwd_dim_channel d on c.channel_id = d.channel_idwhere     b.member_type = '活跃会员' and     d.channel_name = '线上' and     year(b.business_date)=year(date_sub(curdate(), interval 1 month)) and month(b.business_date) = month(date_sub(curdate(), interval 1 month))"
上个月，华南区线上渠道的活跃会员有多少？,"select     count(distinct b.member_id)  as '活跃会员数' from     vw_dwd_dim_sale_member_label bjoin     vw_dwd_fact_store_order_detail c on b.member_detail_id = c.member_detail_idjoin     vw_dwd_dim_store a on c.store_id = a.store_idjoin     vw_dwd_dim_channel d on c.channel_id = d.channel_idwhere     b.member_type = '活跃会员' and     a.area_name = '华南区' and     d.channel_name = '线上' and     year(b.business_date)=year(date_sub(curdate(), interval 1 month)) and month(b.business_date) = month(date_sub(curdate(), interval 1 month))"
上个月，深圳XXX路店线上渠道的活跃会员有多少？,"select     count(distinct b.member_id)  as '活跃会员数' from     vw_dwd_dim_sale_member_label bjoin     vw_dwd_fact_store_order_detail c on b.member_detail_id = c.member_detail_idjoin     vw_dwd_dim_store a on c.store_id = a.store_idjoin     vw_dwd_dim_channel d on c.channel_id = d.channel_idwhere     b.member_type = '活跃会员' and     a.store_name = '深圳XXX路店' and     d.channel_name = '线上' and     year(b.business_date)=year(date_sub(curdate(), interval 1 month)) and month(b.business_date) = month(date_sub(curdate(), interval 1 month))"
上个月，各大区的活跃会员数分布如何？,"select     a.area_name,     count(distinct b.member_id)  as '活跃会员数' from     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idjoin     vw_dwd_dim_sale_member_label b on c.member_detail_id = b.member_detail_idwhere     b.member_type = '活跃会员' and     year(b.business_date)=year(date_sub(curdate(), interval 1 month)) and month(b.business_date) = month(date_sub(curdate(), interval 1 month))group by     a.area_name"
昨天的库存额是多少？,"SELECT SUM(close_amt)  as '库存额'  FROM vw_dwd_fact_store_stock_daily WHERE business_date = DATE_SUB(CURDATE(), INTERVAL 1 DAY);"
华南区昨天的库存额是多少？,"SELECT SUM(a.close_amt)   as '库存额' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_store AS b ON a.store_id = b.store_idWHERE a.business_date = DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND b.area_name = '华南区';"
深圳XXX路店昨天的库存额是多少？,"SELECT SUM(a.close_amt)   as '库存额' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_store AS b ON a.store_id = b.store_idWHERE a.business_date = DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND b.store_name = '深圳XXX路店'"
上个月每个区域的库存分别是多少？,"SELECT b.area_name  as '区域名称'  , SUM(a.close_amt)    as '库存额' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_store AS b ON a.store_id = b.store_idWHERE YEAR(a.business_date) = YEAR(CURDATE()) AND MONTH(a.business_date) = MONTH(DATE_SUB(CURDATE(), INTERVAL 1 MONTH))GROUP BY b.area_nameORDER BY  '库存额' "
3月份每天的库存额如何？,"SELECT business_date  as '库存日期' , SUM(close_amt)   as '库存额' FROM vw_dwd_fact_store_stock_daily WHERE MONTH(business_date) = 3 AND YEAR(business_date) = YEAR(CURDATE())GROUP BY business_dateORDER BY business_date ASC"
华南区3月份每天的库存额如何？,"SELECT a.business_date  as '库存日期' , SUM(a.close_amt)   as '库存额' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_store AS b ON a.store_id = b.store_idWHERE b.area_name = '华南区' AND MONTH(a.business_date) = 3 AND YEAR(a.business_date) = YEAR(CURDATE())GROUP BY a.business_dateORDER BY a.business_date ASC"
深圳XXX路店3月份每天的库存额如何？,"SELECT a.business_date  as '库存日期' , SUM(a.close_amt)   as '库存额' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_store AS b ON a.store_id = b.store_idWHERE b.store_name = '深圳XXX路店' AND MONTH(a.business_date) = 3 AND YEAR(a.business_date) = YEAR(CURDATE())GROUP BY a.business_dateORDER BY a.business_date ASC"
上个月，深圳XXX路店的库存额是多少？,"SELECT SUM(a.close_amt)/day(date_sub(date_format(CURDATE(), '%Y-%m-01'),1))   as '库存额' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_store AS b ON a.store_id = b.store_idWHERE b.store_name = '深圳XXX路店' AND YEAR(a.business_date) = YEAR(CURDATE()) AND MONTH(a.business_date) = MONTH(DATE_SUB(CURDATE(), INTERVAL 1 MONTH))"
去年，婴儿用品品类库存额是多少？,"SELECT SUM(a.close_amt) /datediff(date_sub(date_format(CURDATE(), '%Y-01-01'),1),date_format( date_sub(CURDATE(), INTERVAL 1 YEAR), '%Y-01-01'))   as '库存额' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idWHERE b.category_name_level1 = '婴儿用品' AND YEAR(a.business_date) = YEAR(DATE_SUB(CURDATE(), INTERVAL 1 YEAR))"
去年，华南区婴儿用品品类库存额是多少？,"SELECT SUM(a.close_amt) /datediff(date_sub(date_format(CURDATE(), '%Y-01-01'),1),date_format( date_sub(CURDATE(), INTERVAL 1 YEAR), '%Y-01-01'))   as '库存额' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idJOIN vw_dwd_dim_store AS c ON a.store_id = c.store_idWHERE b.category_name_level1 = '婴儿用品' AND c.area_name = '华南区' AND YEAR(a.business_date) = YEAR(DATE_SUB(CURDATE(), INTERVAL 1 YEAR));"
去年，深圳XXX路店婴儿用品品类库存额是多少？,"SELECT SUM(a.close_amt) /datediff(date_sub(date_format(CURDATE(), '%Y-01-01'),1),date_format( date_sub(CURDATE(), INTERVAL 1 YEAR), '%Y-01-01'))   as '库存额' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idJOIN vw_dwd_dim_store AS c ON a.store_id = c.store_idWHERE b.category_name_level1 = '婴儿用品' AND c.store_name = '深圳XXX路店' AND YEAR(a.business_date) = YEAR(DATE_SUB(CURDATE(), INTERVAL 1 YEAR));"
昨天库存额最高的5个商品是什么，它们各自的销售额和库存额是多少？,"SELECT b.item_name  as '商品名称' , sum(a.sales_amt)*-1 AS sales_amt, sum(a.close_amt)   as '库存额' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idWHERE a.business_date = DATE_SUB(CURDATE(), INTERVAL 1 DAY)GROUP BY b.item_nameORDER BY sum(a.close_amt)    DESC LIMIT 5"
华南区昨天库存额最高的5个商品是什么，它们各自的库存额是多少？,"SELECT b.item_name  as '商品名称',sum(a.close_amt)   as '库存额' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idJOIN vw_dwd_dim_store AS c ON a.store_id = c.store_idWHERE c.area_name = '华南区'and a.business_date = DATE_SUB(CURDATE(), INTERVAL 1 DAY)GROUP BY b.item_name ORDER BY sum(a.close_amt)  DESC LIMIT 5"
深圳XXX路店昨天库存额最高的5个商品是什么，它们各自的库存额是多少？,"SELECT b.item_name  as '商品名称',sum(a.close_amt)   as '库存额'FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idJOIN vw_dwd_dim_store AS c ON a.store_id = c.store_idWHERE c.store_name = '深圳XXX路店' and a.business_date = DATE_SUB(CURDATE(), INTERVAL 1 DAY)GROUP BY b.item_nameORDER BY sum(a.close_amt)  DESC LIMIT 5"
上个月，库存额最高的品类是哪些？,"SELECT b.category_name_level1  as '大类名称' , SUM(a.close_amt) /day(date_sub(date_format(CURDATE(), '%Y-%m-01'),1))   as '库存额' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idWHERE  YEAR(a.business_date) = YEAR(CURDATE()) AND MONTH(a.business_date) = MONTH(DATE_SUB(CURDATE(), INTERVAL 1 MONTH))GROUP BY b.category_name_level1ORDER BY SUM(a.close_amt) DESCLIMIT 10"
上个月，华南区库存额最高的品类是哪些？,"SELECT b.category_name_level1  as '大类名称' , SUM(a.close_amt) /day(date_sub(date_format(CURDATE(), '%Y-%m-01'),1))   as '库存额' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idJOIN vw_dwd_dim_store AS c ON a.store_id = c.store_idWHERE c.area_name = '华南区' AND YEAR(a.business_date) = YEAR(CURDATE()) AND MONTH(a.business_date) = MONTH(DATE_SUB(CURDATE(), INTERVAL 1 MONTH))GROUP BY b.category_name_level1ORDER BY SUM(a.close_amt) DESC"
上个月，深圳XXX路店库存额最高的品类是哪些？,"SELECT b.category_name_level1  as '大类名称' , SUM(a.close_amt) /day(date_sub(date_format(CURDATE(), '%Y-%m-01'),1))   as '库存额' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idJOIN vw_dwd_dim_store AS c ON a.store_id = c.store_idWHERE c.store_name = '深圳XXX路店' AND YEAR(a.business_date) = YEAR(CURDATE()) AND MONTH(a.business_date) = MONTH(DATE_SUB(CURDATE(), INTERVAL 1 MONTH))GROUP BY b.category_name_level1ORDER BY SUM(a.close_amt) DESC"
深圳XXX路店昨天巴马香米的库存量是多少？,"SELECT sum(a.close_qty)   as '库存量' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idJOIN vw_dwd_dim_store AS c ON a.store_id = c.store_idWHERE b.item_name = '巴马香米' AND c.store_name = '深圳XXX路店' AND a.business_date = DATE_SUB(CURDATE(), INTERVAL 1 DAY);"
现在片糖还有多少斤库存？,SELECT sum(a.close_qty)   as '库存量' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idWHERE b.item_name = '片糖' AND a.business_date = CURDATE();
本月巴马香米的库存量趋势如何？,"SELECT a.business_date  as '库存日期' , SUM(a.close_qty)   as '库存量' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idWHERE b.item_name = '巴马香米' AND YEAR(a.business_date) = YEAR(CURDATE()) AND MONTH(a.business_date) = MONTH(CURDATE())GROUP BY a.business_dateORDER BY a.business_date;"
本月华南区巴马香米的库存量趋势如何？,"SELECT a.business_date  as '库存日期' , SUM(a.close_qty)   as '库存量' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idJOIN vw_dwd_dim_store AS c ON a.store_id = c.store_idWHERE b.item_name = '巴马香米' AND c.area_name = '华南区' AND YEAR(a.business_date) = YEAR(CURDATE()) AND MONTH(a.business_date) = MONTH(CURDATE())GROUP BY a.business_dateORDER BY a.business_date;"
本月深圳XXX路店巴马香米的库存量趋势如何？,"SELECT a.business_date  as '库存日期' , SUM(a.close_qty)   as '库存量' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idJOIN vw_dwd_dim_store AS c ON a.store_id = c.store_idWHERE b.item_name = '巴马香米' AND c.store_name = '深圳XXX路店' AND YEAR(a.business_date) = YEAR(CURDATE()) AND MONTH(a.business_date) = MONTH(CURDATE())GROUP BY a.business_dateORDER BY a.business_date;"
深圳XXX路店近7天巴马香米的库存量趋势怎样？,"SELECT a.business_date  as '库存日期' , SUM(a.close_qty)   as '库存量' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idJOIN vw_dwd_dim_store AS c ON a.store_id = c.store_idWHERE b.item_name = '巴马香米' AND c.store_name = '深圳XXX路店' AND a.business_date BETWEEN DATE_SUB(CURDATE(), INTERVAL 7 DAY) AND CURDATE()GROUP BY a.business_dateORDER BY a.business_date;"
深圳XXX路店上个月粮油副食类库存量最高的商品是哪些？,"SELECT b.item_name  as '商品名称' , sum(a.close_qty)/day(date_sub(date_format(CURDATE(), '%Y-%m-01'),1))   as '库存量' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idJOIN vw_dwd_dim_store AS c ON a.store_id = c.store_idWHERE b.category_name_level1 = '粮油副食' AND c.store_name = '深圳XXX路店' AND YEAR(a.business_date) = YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND MONTH(a.business_date) = MONTH(DATE_SUB(CURDATE(), INTERVAL 1 MONTH))GROUP BY b.item_nameORDER BY MAX(a.close_qty) DESCLIMIT 10"
昨天各大区巴马香米的库存量情况怎样？,"SELECT c.area_name  as '区域名称'  , SUM(a.close_qty)   as '库存量' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idJOIN vw_dwd_dim_store AS c ON a.store_id = c.store_idWHERE b.item_name = '巴马香米' AND a.business_date = DATE_SUB(CURDATE(), INTERVAL 1 DAY)GROUP BY c.area_name;"
昨天巴马香米的库存量最高的门店有哪些？,"SELECT c.store_name  as '门店名称' , SUM(a.close_qty)   as '库存量' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idJOIN vw_dwd_dim_store AS c ON a.store_id = c.store_idWHERE b.item_name = '巴马香米' AND a.business_date = DATE_SUB(CURDATE(), INTERVAL 1 DAY)GROUP BY c.store_nameORDER BY SUM(a.close_qty) DESC"
华南区昨天巴马香米的库存量最高的门店有哪些？,"SELECT c.store_name  as '门店名称', SUM(a.close_qty)   as '库存量' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_item AS b ON a.item_id = b.item_idJOIN vw_dwd_dim_store AS c ON a.store_id = c.store_idWHERE b.item_name = '巴马香米' AND c.area_name = '华南区' AND a.business_date = DATE_SUB(CURDATE(), INTERVAL 1 DAY)GROUP BY c.store_nameORDER BY SUM(a.close_qty) DESC"
上个月的库存周转天数是多少？,"SELECT ABS(ROUND(SUM(a.close_amt)/SUM(a.sales_cost_amt),0)) AS '库存周转天数' FROM vw_dwd_fact_store_stock_daily AS aWHERE YEAR(a.business_date) = YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND MONTH(a.business_date) = MONTH(DATE_SUB(CURDATE(), INTERVAL 1 MONTH))"
华南区上个月的库存周转天数是多少？,"SELECT ABS(ROUND(SUM(a.close_amt)/SUM(a.sales_cost_amt),0)) AS '库存周转天数' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_store AS b ON a.store_id = b.store_idWHERE b.area_name = '华南区'AND YEAR(a.business_date) = YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND MONTH(a.business_date) = MONTH(DATE_SUB(CURDATE(), INTERVAL 1 MONTH))"
深圳XXX路店上个月的库存周转天数是多少？,"SELECT ABS(ROUND(SUM(a.close_amt)/SUM(a.sales_cost_amt),0)) AS '库存周转天数' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_store AS b ON a.store_id = b.store_idWHERE b.store_name = '深圳XXX路店'AND YEAR(a.business_date) = YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND MONTH(a.business_date) = MONTH(DATE_SUB(CURDATE(), INTERVAL 1 MONTH))"
上个月的库存周转天数同比,"SELECT round(t1.stock_turnover_days,0)   as '上个月库存周转天数' ,round(t2.stock_turnover_days,0)   as '同比库存周转天数' ,round(t1.stock_turnover_days-t2.stock_turnover_days,0)  as '同比差额'  ,(t1.stock_turnover_days-t2.stock_turnover_days)/t2.stock_turnover_days*100   as '同比变化率'FROM(SELECT ABS(ROUND(SUM(a.close_amt)/SUM(a.sales_cost_amt),0)) as stock_turnover_daysFROM vw_dwd_fact_store_stock_daily AS aWHERE YEAR(a.business_date) = YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND MONTH(a.business_date) = MONTH(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)))t1,(SELECT ABS(ROUND(SUM(a.close_amt)/SUM(a.sales_cost_amt),0)) as stock_turnover_daysFROM vw_dwd_fact_store_stock_daily AS aWHERE YEAR(a.business_date) = YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH))-1 AND MONTH(a.business_date) = MONTH(DATE_SUB(CURDATE(), INTERVAL 1 MONTH))) t2"
华南区上个月的库存周转天数同比,"SELECT   round(t1.stock_turnover_days,0)   as '上个月库存周转天数' ,round(t2.stock_turnover_days,0)   as '同比库存周转天数' ,round(t1.stock_turnover_days-t2.stock_turnover_days,0)  as '同比差额'  ,(t1.stock_turnover_days-t2.stock_turnover_days)/t2.stock_turnover_days*100   as '同比变化率'FROM(SELECT ABS(ROUND(SUM(a.close_amt)/SUM(a.sales_cost_amt),0)) as stock_turnover_daysFROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_store AS b ON a.store_id = b.store_idWHERE b.area_name = '华南区' AND YEAR(a.business_date) = YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND MONTH(a.business_date) = MONTH(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)))t1,(SELECT ABS(ROUND(SUM(a.close_amt)/SUM(a.sales_cost_amt),0)) as stock_turnover_daysFROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_store AS b ON a.store_id = b.store_idWHERE b.area_name = '华南区' AND YEAR(a.business_date) = YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH))-1 AND MONTH(a.business_date) = MONTH(DATE_SUB(CURDATE(), INTERVAL 1 MONTH))) t2"
深圳XXX路店上个月的库存周转天数同比,"SELECT   round(t1.stock_turnover_days,0)   as '上个月库存周转天数' ,round(t2.stock_turnover_days,0)   as '同比库存周转天数' ,round(t1.stock_turnover_days-t2.stock_turnover_days,0)  as '同比差额'  ,(t1.stock_turnover_days-t2.stock_turnover_days)/t2.stock_turnover_days*100   as '同比变化率'FROM(SELECT ABS(ROUND(SUM(a.close_amt)/SUM(a.sales_cost_amt),0)) as stock_turnover_daysFROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_store AS b ON a.store_id = b.store_idWHERE b.store_name = '深圳XXX路店'AND YEAR(a.business_date) = YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND MONTH(a.business_date) = MONTH(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)))t1,(SELECT ABS(ROUND(SUM(a.close_amt)/SUM(a.sales_cost_amt),0)) as stock_turnover_daysFROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_store AS b ON a.store_id = b.store_idWHERE b.store_name = '深圳XXX路店'AND YEAR(a.business_date) = YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH))-1 AND MONTH(a.business_date) = MONTH(DATE_SUB(CURDATE(), INTERVAL 1 MONTH))) t2"
今年至今的库存周转天数,"SELECT ABS(ROUND(SUM(a.close_amt)/SUM(a.sales_cost_amt),0))  as '库存周转天数' FROM vw_dwd_fact_store_stock_daily AS aWHERE  YEAR(a.business_date) = YEAR(CURDATE())"
华南区今年至今的库存周转天数,"SELECT ABS(ROUND(SUM(a.close_amt)/SUM(a.sales_cost_amt),0))  as '库存周转天数' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_store AS b ON a.store_id = b.store_idWHERE b.area_name = '华南区'AND YEAR(a.business_date) = YEAR(CURDATE())"
深圳XXX路店今年至今的库存周转天数,"SELECT ABS(ROUND(SUM(a.close_amt)/SUM(a.sales_cost_amt),0))  as '库存周转天数' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_store AS b ON a.store_id = b.store_idWHERE b.store_name = '深圳XXX路店'AND YEAR(a.business_date) = YEAR(CURDATE())"
上个月，各区域的库存周转天数？,"SELECT b.area_name  as '区域名称'  , ABS(ROUND(SUM(a.close_amt)/SUM(a.sales_cost_amt),0))   as '库存周转天数' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_store AS b ON a.store_id = b.store_idWHERE  YEAR(a.business_date) = YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND MONTH(a.business_date) = MONTH(DATE_SUB(CURDATE(), INTERVAL 1 MONTH))GROUP BY b.area_nameORDER BY '库存周转天数' "
上个月深圳XXX路店的库存周转天数是多少？,"SELECT  ABS(ROUND(SUM(a.close_amt)/SUM(a.sales_cost_amt),0))   as '库存周转天数' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_store AS b ON a.store_id = b.store_idWHERE  store_name = '深圳XXX路店'AND YEAR(a.business_date) = YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND MONTH(a.business_date) = MONTH(DATE_SUB(CURDATE(), INTERVAL 1 MONTH))"
上个月粮油副食品类的库存周转天数是多少？,"SELECT  ABS(ROUND(SUM(a.close_amt)/SUM(a.sales_cost_amt),0))   as '库存周转天数' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_item as d on a.item_id = d.item_idWHERE d.category_name_level1 = '粮油副食'AND YEAR(a.business_date) = YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND MONTH(a.business_date) = MONTH(DATE_SUB(CURDATE(), INTERVAL 1 MONTH))"
上个月华南区粮油副食品类的库存周转天数是多少？,"SELECT  ABS(ROUND(SUM(a.close_amt)/SUM(a.sales_cost_amt),0))   as '库存周转天数' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_store AS b ON a.store_id = b.store_idJOIN vw_dwd_dim_item as d on a.item_id = d.item_idWHERE  b.area_name = '华南区'  AND d.category_name_level1 = '粮油副食'AND YEAR(a.business_date) = YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND MONTH(a.business_date) = MONTH(DATE_SUB(CURDATE(), INTERVAL 1 MONTH))"
上个月深圳XXX路店粮油副食品类的库存周转天数是多少？,"SELECT  ABS(ROUND(SUM(a.close_amt)/SUM(a.sales_cost_amt),0))  as '库存周转天数' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_store AS b ON a.store_id = b.store_idJOIN vw_dwd_dim_item as d on a.item_id = d.item_idWHERE  b.store_name = '深圳XXX路店'  AND d.category_name_level1 = '粮油副食'AND YEAR(a.business_date) = YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND MONTH(a.business_date) = MONTH(DATE_SUB(CURDATE(), INTERVAL 1 MONTH))"
深圳XXX路店海天陈醋上个月的库存周转天数是多少？,"SELECT  ABS(ROUND(SUM(a.close_amt)/SUM(a.sales_cost_amt),0))   as '库存周转天数' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_store AS b ON a.store_id = b.store_idJOIN vw_dwd_dim_item as d on a.item_id = d.item_idWHERE  b.store_name = '深圳XXX路店'  AND d.item_name= '海天陈醋'AND YEAR(a.business_date) = YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AND MONTH(a.business_date) = MONTH(DATE_SUB(CURDATE(), INTERVAL 1 MONTH))"
去年全年，月库存周转天数呈现何种趋势？,"SELECT       date_format(a.business_date, '%Y-%m')   as '月份' ,     ABS(ROUND(SUM(a.close_amt)/SUM(a.sales_cost_amt),0))   as '库存周转天数' FROM vw_dwd_fact_store_stock_daily AS aWHERE YEAR(a.business_date) = YEAR(DATE_SUB(CURDATE(), INTERVAL 1 YEAR))GROUP BY date_format(a.business_date, '%Y-%m')ORDER BY date_format(a.business_date, '%Y-%m')"
去年全年，华南区月库存周转天数呈现何种趋势？,"SELECT       date_format(a.business_date, '%Y-%m')  as '月份',     ABS(ROUND(SUM(a.close_amt)/SUM(a.sales_cost_amt),0))   as '库存周转天数' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_store AS b ON a.store_id = b.store_idWHERE b.area_name = '华南区'AND YEAR(a.business_date) = YEAR(DATE_SUB(CURDATE(), INTERVAL 1 YEAR))GROUP BY date_format(a.business_date, '%Y-%m')ORDER BY date_format(a.business_date, '%Y-%m')"
去年全年，深圳XXX路店月库存周转天数呈现何种趋势？,"SELECT       date_format(a.business_date, '%Y-%m')   as '月份',     ABS(ROUND(SUM(a.close_amt)/SUM(a.sales_cost_amt),0))   as '库存周转天数' FROM vw_dwd_fact_store_stock_daily AS aJOIN vw_dwd_dim_store AS b ON a.store_id = b.store_idWHERE b.store_name = '深圳XXX路店'AND YEAR(a.business_date) = YEAR(DATE_SUB(CURDATE(), INTERVAL 1 YEAR))GROUP BY date_format(a.business_date, '%Y-%m')ORDER BY date_format(a.business_date, '%Y-%m')"
上个月的提篮量是多少？,"select     count(item_id)/count(distinct order_id)   as '提篮量' from     vw_dwd_fact_store_order_detailwhere     year(business_date)=year(date_sub(curdate(), interval 1 month)) and month(business_date) = month(date_sub(curdate(), interval 1 month))"
华南区上个月的提篮量是多少？,"select     count(item_id)/count(distinct c.order_id)   as '提篮量' from     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idwhere     a.area_name = '华南区' and     year(c.business_date)=year(date_sub(curdate(), interval 1 month)) and month(c.business_date) = month(date_sub(curdate(), interval 1 month))"
深圳XXX路店上个月的提篮量是多少？,"select     count(item_id)/count(distinct c.order_id)   as '提篮量' from     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idwhere     a.store_name = '深圳XXX路店' and     year(c.business_date)=year(date_sub(curdate(), interval 1 month)) and month(c.business_date) = month(date_sub(curdate(), interval 1 month))"
上个月各区域的提篮量是多少？,"   select     a.area_name  as '区域名称'  ,     count(c.item_id)/count(distinct c.order_id)   as '提篮量' from     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idwhere     year(c.business_date)=year(date_sub(curdate(), interval 1 month)) and month(c.business_date) = month(date_sub(curdate(), interval 1 month))group by     a.area_name;"
上个月提篮量最高的门店是哪些？,"   select     a.store_name  as '门店名称' ,     count(c.item_id)/count(distinct c.order_id)   as '提篮量' from     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idwhere     year(c.business_date)=year(date_sub(curdate(), interval 1 month)) and month(c.business_date) = month(date_sub(curdate(), interval 1 month))group by     a.store_nameorder by      '提篮量' desc"
上个月华南区提篮量最高的门店是哪些？,"   select     a.store_name  as '门店名称' ,     count(c.item_id)/count(distinct c.order_id)   as '提篮量' from     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idwhere a.area_name = '华南区' and    year(c.business_date)=year(date_sub(curdate(), interval 1 month)) and month(c.business_date) = month(date_sub(curdate(), interval 1 month))group by     a.store_nameorder by      '提篮量' desc"
近6个月的提篮量趋势如何？,"	select     date_format(c.business_date, '%Y-%m')   as '月份' ,    count(c.item_id)/count(distinct c.order_id)   as '提篮量' from vw_dwd_fact_store_order_detail cwhere     c.business_date between date_format(date_sub(curdate(), interval 5 month), '%Y-%m-01') and curdate()group by     date_format(c.business_date, '%Y-%m')order by     date_format(c.business_date, '%Y-%m')"
华南区近6个月的提篮量趋势如何？,"	select     date_format(c.business_date, '%Y-%m')   as '月份' ,    count(c.item_id)/count(distinct c.order_id)   as '提篮量' from     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idwhere     a.area_name = '华南区' and     c.business_date between date_format(date_sub(curdate(), interval 5 month), '%Y-%m-01') and curdate()group by      date_format(c.business_date, '%Y-%m') order by      date_format(c.business_date, '%Y-%m') "
深圳XXX路店近6个月的提篮量趋势如何？,"	select     date_format(c.business_date, '%Y-%m')   as '月份' ,    count(c.item_id)/count(distinct c.order_id)   as '提篮量' from     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idwhere     a.store_name = '深圳XXX路店' and     c.business_date between date_format(date_sub(curdate(), interval 5 month), '%Y-%m-01') and curdate()group by      date_format(c.business_date, '%Y-%m') order by      date_format(c.business_date, '%Y-%m') "
上个月哪些门店的提篮量最差？,"    select     a.store_name  as '门店名称' ,     count(c.item_id)/count(distinct c.order_id)   as '提篮量' from     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idwhere      c.business_date between date_format(date_sub(curdate(), interval 5 month), '%Y-%m-01') and curdate()group by     a.store_nameorder by     '提篮量' "
上个月华南区哪些门店的提篮量最差？,"    select     a.store_name  as '门店名称' ,     count(c.item_id)/count(distinct c.order_id) as '提篮量' from     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idwhere a.area_name='华南区' and     c.business_date between date_format(date_sub(curdate(), interval 5 month), '%Y-%m-01') and curdate()group by     a.store_nameorder by     '提篮量' "
3月份每天的提篮量是多少？,"select     date(c.business_date)   as '销售日期' ,     count(c.item_id)/count(distinct c.order_id)   as '提篮量' from     vw_dwd_fact_store_order_detail cwhere     month(c.business_date) = 3 and year(c.business_date) = year(curdate())group by     date(c.business_date) order by     date(c.business_date) ;"
上周哪些区域的提篮量环比增长最快？," select t1.area_name  as '区域名称'  ,t1.last_week_basket_count  as '上周提篮量'  ,t2.pre_last_week_basket_count  as '环比提篮量'  ,t1.last_week_basket_count-t2.pre_last_week_basket_count  as '环比差额'  ,(t1.last_week_basket_count-t2.pre_last_week_basket_count)/t2.pre_last_week_basket_count*100   as '环比变化率' from (select a.area_name,count(c.item_id)/count(distinct c.order_id) as last_week_basket_countfrom     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idwhere year(c.business_date)=year(date_sub(curdate(), interval 1 week)) and weekofyear(c.business_date) = weekofyear(date_sub(curdate(), interval 1 week))group by a.area_name) t1 join (select a.area_name,count(c.item_id)/count(distinct c.order_id) as pre_last_week_basket_countfrom     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idwhere year(c.business_date)=year(date_sub(curdate(), interval 2 week)) and weekofyear(c.business_date) = weekofyear(date_sub(curdate(), interval 2 week))group by a.area_name) t2 on t1.area_name=t2.area_nameorder by '环比变化率' desc"
上个月哪些区域的提篮量同比增长最多？," select t1.area_name  as '区域名称'  ,t1.last_month_basket_count   as '上个月提篮量'  ,t2.pre_last_month_basket_count   as '去年同期提篮量'  ,t1.last_month_basket_count-t2.pre_last_month_basket_count  as '同比差额'  ,(t1.last_month_basket_count-t2.pre_last_month_basket_count)/t2.pre_last_month_basket_count*100   as '同比变化率' from (select a.area_name,count(c.item_id)/count(distinct c.order_id) as last_month_basket_countfrom     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idwhere year(c.business_date)=year(date_sub(curdate(), interval 1 month)) and month(c.business_date) = month(date_sub(curdate(), interval 1 month))group by a.area_name) t1 join (select a.area_name,count(c.item_id)/count(distinct c.order_id) as pre_last_month_basket_countfrom     vw_dwd_dim_store ajoin     vw_dwd_fact_store_order_detail c on a.store_id = c.store_idwhere year(c.business_date)=year(date_sub(curdate(), interval 2 month)) and month(c.business_date) = month(date_sub(curdate(), interval 2 month))group by a.area_name) t2 on t1.area_name=t2.area_nameorder by '同比变化率'  desc"
上个月蔬菜品类的入篮率是多少？,"SELECT     sum(case when c.category_name_level1 = '蔬菜' then 1 else 0 end) / count(distinct a.order_id) *100   as '入篮率' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_item as c on a.item_id = c.item_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))"
上个月华南区蔬菜品类的入篮率是多少？,"SELECT     sum(case when c.category_name_level1 = '蔬菜' then 1 else 0 end) / count(distinct a.order_id) *100   as '入篮率' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_item as c on a.item_id = c.item_idJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and b.area_name = '华南区'"
上个月深圳XXX路店蔬菜品类的入篮率是多少？,"SELECT     sum(case when c.category_name_level1 = '蔬菜' then 1 else 0 end) / count(distinct a.order_id) *100   as '入篮率' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_item as c on a.item_id = c.item_idJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and b.store_name = '深圳XXX路店'"
上个月厨邦酱油的入篮率是多少？,"SELECT     sum(case when c.item_name = '厨邦酱油' then 1 else 0 end) / count(distinct a.order_id)*100    as '入篮率' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_item as c on a.item_id = c.item_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))"
上个月华南区厨邦酱油的入篮率是多少？,"SELECT     sum(case when c.item_name = '厨邦酱油' then 1 else 0 end) / count(distinct a.order_id)*100    as '入篮率' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_item as c on a.item_id = c.item_idJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and b.area_name = '华南区'"
上个月深圳XXX路店厨邦酱油的入篮率是多少？,"SELECT     sum(case when c.item_name = '厨邦酱油' then 1 else 0 end) / count(distinct a.order_id)*100   as '入篮率' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_item as c on a.item_id = c.item_idJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and b.store_name = '深圳XXX路店'"
昨天可口可乐的入篮率是多少？,"SELECT     sum(case when c.item_name = '可口可乐' then 1 else 0 end) / count(distinct a.order_id) *100  as '入篮率' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_item as c on a.item_id = c.item_idWHERE a.business_date = date_sub(curdate(), interval 1 day)"
华南区昨天可口可乐的入篮率是多少？,"SELECT     sum(case when c.item_name = '可口可乐' then 1 else 0 end) / count(distinct a.order_id) *100  as '入篮率' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_item as c on a.item_id = c.item_idJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE a.business_date = date_sub(curdate(), interval 1 day) and b.area_name = '华南区'"
深圳XXX路店昨天可口可乐的入篮率是多少？,"SELECT     sum(case when c.item_name = '可口可乐' then 1 else 0 end) / count(distinct a.order_id) *100  as '入篮率' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_item as c on a.item_id = c.item_idJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE a.business_date = date_sub(curdate(), interval 1 day) and b.store_name = '深圳XXX路店'"
上个月入篮率最高的商品有哪些？,"SELECT     c.item_name  as '商品名称' ,    sum(1) / count(distinct a.order_id)*100   as '入篮率' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_item as c on a.item_id = c.item_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month))GROUP BY c.item_nameORDER BY '入篮率' DESCLIMIT 10"
上个月华南区入篮率最高的商品有哪些？,"SELECT     c.item_name  as '商品名称' ,    sum(1) / count(distinct a.order_id) *100  as '入篮率' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_item as c on a.item_id = c.item_idJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and b.area_name = '华南区'GROUP BY c.item_nameORDER BY '入篮率' DESCLIMIT 10"
上个月深圳XXX路店入篮率最高的商品有哪些？,"SELECT     c.item_name  as '商品名称' ,    sum(1) / count(distinct a.order_id)*100  as '入篮率' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_item as c on a.item_id = c.item_idJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE year(a.business_date)=year(date_sub(curdate(), interval 1 month)) and month(a.business_date) = month(date_sub(curdate(), interval 1 month)) and b.store_name = '深圳XXX路店'GROUP BY c.item_nameORDER BY '入篮率' DESCLIMIT 10"
厨邦酱油近6个月的入篮率有什么变化？,"SELECT     date_format(a.business_date, '%Y-%m')  as '月份' ,    sum(case when c.item_name = '厨邦酱油' then 1 else 0 end) / count(distinct a.order_id) *100  as '入篮率' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_item as c on a.item_id = c.item_idWHERE a.business_date >= to_date(date_trunc('month',date_sub(curdate(), interval 6 month)))GROUP BY date_format(a.business_date, '%Y-%m') ORDER BY date_format(a.business_date, '%Y-%m') LIMIT 6"
华南区厨邦酱油近6个月的入篮率有什么变化？,"SELECT     date_format(a.business_date, '%Y-%m')   as '月份' ,    sum(case when c.item_name = '厨邦酱油' then 1 else 0 end) / count(distinct a.order_id) *100  as '入篮率' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_item as c on a.item_id = c.item_idJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE a.business_date >= to_date(date_trunc('month',date_sub(curdate(), interval 6 month))) and b.area_name = '华南区'GROUP BY date_format(a.business_date, '%Y-%m')ORDER BY date_format(a.business_date, '%Y-%m')LIMIT 6"
深圳XXX路店厨邦酱油近6个月的入篮率有什么变化？,"SELECT     date_format(a.business_date, '%Y-%m')   as '月份' ,    sum(case when c.item_name = '厨邦酱油' then 1 else 0 end) / count(distinct a.order_id) *100  as '入篮率' FROM vw_dwd_fact_store_order_detail as aJOIN vw_dwd_dim_item as c on a.item_id = c.item_idJOIN vw_dwd_dim_store as b on a.store_id = b.store_idWHERE a.business_date >= to_date(date_trunc('month',date_sub(curdate(), interval 6 month))) and b.store_name = '深圳XXX路店'GROUP BY date_format(a.business_date, '%Y-%m')ORDER BY date_format(a.business_date, '%Y-%m')LIMIT 6"
